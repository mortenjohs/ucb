<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>class7.html</title>
  <meta name="generator" content="Haroopad 0.13.1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>div.oembedall-githubrepos{border:1px solid #DDD;border-radius:4px;list-style-type:none;margin:0 0 10px;padding:8px 10px 0;font:13.34px/1.4 helvetica,arial,freesans,clean,sans-serif;width:452px;background-color:#fff}div.oembedall-githubrepos .oembedall-body{background:-moz-linear-gradient(center top,#FAFAFA,#EFEFEF);background:-webkit-gradient(linear,left top,left bottom,from(#FAFAFA),to(#EFEFEF));border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-top:1px solid #EEE;margin-left:-10px;margin-top:8px;padding:5px 10px;width:100%}div.oembedall-githubrepos h3{font-size:14px;margin:0;padding-left:18px;white-space:nowrap}div.oembedall-githubrepos p.oembedall-description{color:#444;font-size:12px;margin:0 0 3px}div.oembedall-githubrepos p.oembedall-updated-at{color:#888;font-size:11px;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats{border:none;float:right;font-size:11px;font-weight:700;padding-left:15px;position:relative;z-index:5;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats li{border:none;color:#666;display:inline-block;list-style-type:none;margin:0!important}div.oembedall-githubrepos ul.oembedall-repo-stats li a{background-color:transparent;border:none;color:#666!important;background-position:5px -2px;background-repeat:no-repeat;border-left:1px solid #DDD;display:inline-block;height:21px;line-height:21px;padding:0 5px 0 23px}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a{border-left:medium none;margin-right:-3px}div.oembedall-githubrepos ul.oembedall-repo-stats li a:hover{background:5px -27px no-repeat #4183C4;color:#FFF!important;text-decoration:none}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a:hover{border-bottom-left-radius:3px;border-top-left-radius:3px}ul.oembedall-repo-stats li:last-child a:hover{border-bottom-right-radius:3px;border-top-right-radius:3px}span.oembedall-closehide{background-color:#aaa;border-radius:2px;cursor:pointer;margin-right:3px}div.oembedall-container{margin-top:5px;text-align:left}.oembedall-ljuser{font-weight:700}.oembedall-ljuser img{vertical-align:bottom;border:0;padding-right:1px}.oembedall-stoqembed{border-bottom:1px dotted #999;float:left;overflow:hidden;width:730px;line-height:1;background:#FFF;color:#000;font-family:Arial,Liberation Sans,DejaVu Sans,sans-serif;font-size:80%;text-align:left;margin:0;padding:0}.oembedall-stoqembed a{color:#07C;text-decoration:none;margin:0;padding:0}.oembedall-stoqembed a:hover{text-decoration:underline}.oembedall-stoqembed a:visited{color:#4A6B82}.oembedall-stoqembed h3{font-family:Trebuchet MS,Liberation Sans,DejaVu Sans,sans-serif;font-size:130%;font-weight:700;margin:0;padding:0}.oembedall-stoqembed .oembedall-reputation-score{color:#444;font-size:120%;font-weight:700;margin-right:2px}.oembedall-stoqembed .oembedall-user-info{height:35px;width:185px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-gravatar32{float:left;height:32px;width:32px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-details{float:left;margin-left:5px;overflow:hidden;white-space:nowrap;width:145px}.oembedall-stoqembed .oembedall-question-hyperlink{font-weight:700}.oembedall-stoqembed .oembedall-stats{background:#EEE;margin:0 0 0 7px;padding:4px 7px 6px;width:58px}.oembedall-stoqembed .oembedall-statscontainer{float:left;margin-right:8px;width:86px}.oembedall-stoqembed .oembedall-votes{color:#555;padding:0 0 7px;text-align:center}.oembedall-stoqembed .oembedall-vote-count-post{font-size:240%;color:#808185;display:block;font-weight:700}.oembedall-stoqembed .oembedall-views{color:#999;padding-top:4px;text-align:center}.oembedall-stoqembed .oembedall-status{margin-top:-3px;padding:4px 0;text-align:center;background:#75845C;color:#FFF}.oembedall-stoqembed .oembedall-status strong{color:#FFF;display:block;font-size:140%}.oembedall-stoqembed .oembedall-summary{float:left;width:635px}.oembedall-stoqembed .oembedall-excerpt{line-height:1.2;margin:0;padding:0 0 5px}.oembedall-stoqembed .oembedall-tags{float:left;line-height:18px}.oembedall-stoqembed .oembedall-tags a:hover{text-decoration:none}.oembedall-stoqembed .oembedall-post-tag{background-color:#E0EAF1;border-bottom:1px solid #3E6D8E;border-right:1px solid #7F9FB6;color:#3E6D8E;font-size:90%;line-height:2.4;margin:2px 2px 2px 0;padding:3px 4px;text-decoration:none;white-space:nowrap}.oembedall-stoqembed .oembedall-post-tag:hover{background-color:#3E6D8E;border-bottom:1px solid #37607D;border-right:1px solid #37607D;color:#E0EAF1}.oembedall-stoqembed .oembedall-fr{float:right}.oembedall-stoqembed .oembedall-statsarrow{background-image:url(http://cdn.sstatic.net/stackoverflow/img/sprites.png?v=3);background-repeat:no-repeat;overflow:hidden;background-position:0 -435px;float:right;height:13px;margin-top:12px;width:7px}.oembedall-facebook1{border:1px solid #1A3C6C;padding:0;font:13.34px/1.4 verdana;width:500px}.oembedall-facebook2{background-color:#627add}.oembedall-facebook2 a{color:#e8e8e8;text-decoration:none}.oembedall-facebookBody{background-color:#fff;vertical-align:top;padding:5px}.oembedall-facebookBody .contents{display:inline-block;width:100%}.oembedall-facebookBody div img{float:left;margin-right:5px}div.oembedall-lanyard{-webkit-box-shadow:none;-webkit-transition-delay:0s;-webkit-transition-duration:.4000000059604645s;-webkit-transition-property:width;-webkit-transition-timing-function:cubic-bezier(0.42,0,.58,1);background-attachment:scroll;background-clip:border-box;background-color:transparent;background-image:none;background-origin:padding-box;border-width:0;box-shadow:none;color:#112644;display:block;float:left;font-family:'Trebuchet MS',Trebuchet,sans-serif;font-size:16px;height:253px;line-height:19px;margin:0;max-width:none;min-height:0;outline:#112644 0;overflow-x:visible;overflow-y:visible;padding:0;position:relative;text-align:left;vertical-align:baseline;width:804px}div.oembedall-lanyard .tagline{font-size:1.5em}div.oembedall-lanyard .wrapper{overflow:hidden;clear:both}div.oembedall-lanyard .split{float:left;display:inline}div.oembedall-lanyard .prominent-place .flag:active,div.oembedall-lanyard .prominent-place .flag:focus,div.oembedall-lanyard .prominent-place .flag:hover,div.oembedall-lanyard .prominent-place .flag:link,div.oembedall-lanyard .prominent-place .flag:visited{float:left;display:block;width:48px;height:48px;position:relative;top:-5px;margin-right:10px}div.oembedall-lanyard .place-context{font-size:.889em}div.oembedall-lanyard .prominent-place .sub-place{display:block}div.oembedall-lanyard .prominent-place{font-size:1.125em;line-height:1.1em;font-weight:400}div.oembedall-lanyard .main-date{color:#8CB4E0;font-weight:700;line-height:1.1}div.oembedall-lanyard .first{width:48.57%;margin:0 0 0 2.857%}.mermaid .label{color:#333}.node circle,.node polygon,.node rect{fill:#cde498;stroke:#13540c;stroke-width:1px}.edgePath .path{stroke:green;stroke-width:1.5px}.cluster rect{fill:#cdffb2;rx:40;stroke:#6eaa49;stroke-width:1px}.cluster text{fill:#333}.actor{stroke:#13540c;fill:#cde498}text.actor{fill:#000;stroke:none}.actor-line{stroke:grey}.messageLine0{stroke-width:1.5;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#333}.messageLine1{stroke-width:1.5;stroke-dasharray:"2 2";stroke:#333}#arrowhead{fill:#333}#crosshead path{fill:#333!important;stroke:#333!important}.messageText{fill:#333;stroke:none}.labelBox{stroke:#326932;fill:#cde498}.labelText,.loopText{fill:#000;stroke:none}.loopLine{stroke-width:2;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#326932}.note{stroke:#6eaa49;fill:#fff5ad}.noteText{fill:#000;stroke:none;font-family:'trebuchet ms',verdana,arial;font-size:14px}.section{stroke:none;opacity:.2}.section0,.section2{fill:#6eaa49}.section1,.section3{fill:#fff;opacity:.2}.sectionTitle0,.sectionTitle1,.sectionTitle2,.sectionTitle3{fill:#333}.sectionTitle{text-anchor:start;font-size:11px;text-height:14px}.grid .tick{stroke:lightgrey;opacity:.3;shape-rendering:crispEdges}.grid path{stroke-width:0}.today{fill:none;stroke:red;stroke-width:2px}.task{stroke-width:2}.taskText{text-anchor:middle;font-size:11px}.taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px}.taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}.taskText0,.taskText1,.taskText2,.taskText3{fill:#fff}.task0,.task1,.task2,.task3{fill:#487e3a;stroke:#13540c}.taskTextOutside0,.taskTextOutside1,.taskTextOutside2,.taskTextOutside3{fill:#000}.active0,.active1,.active2,.active3{fill:#cde498;stroke:#13540c}.activeText0,.activeText1,.activeText2,.activeText3{fill:#000!important}.done0,.done1,.done2,.done3{stroke:grey;fill:lightgrey;stroke-width:2}.doneText0,.doneText1,.doneText2,.doneText3{fill:#000!important}.crit0,.crit1,.crit2,.crit3{stroke:#f88;fill:red;stroke-width:2}.activeCrit0,.activeCrit1,.activeCrit2,.activeCrit3{stroke:#f88;fill:#cde498;stroke-width:2}.doneCrit0,.doneCrit1,.doneCrit2,.doneCrit3{stroke:#f88;fill:lightgrey;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}.activeCritText0,.activeCritText1,.activeCritText2,.activeCritText3,.doneCritText0,.doneCritText1,.doneCritText2,.doneCritText3{fill:#000!important}.titleText{text-anchor:middle;font-size:18px;fill:#000}text{font-family:'trebuchet ms',verdana,arial;font-size:14px}html{height:100%}body{margin:0!important;padding:5px 20px 26px!important;background-color:#fff;font-family:"Lucida Grande","Segoe UI","Apple SD Gothic Neo","Malgun Gothic","Lucida Sans Unicode",Helvetica,Arial,sans-serif;font-size:.9em;overflow-x:hidden;overflow-y:auto}br,h1,h2,h3,h4,h5,h6{clear:both}hr.page{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x;border:0;height:3px;padding:0}hr.underscore{border-top-style:dashed!important}body >:first-child{margin-top:0!important}img.plugin{box-shadow:0 1px 3px rgba(0,0,0,.1);border-radius:3px}iframe{border:0}figure{-webkit-margin-before:0;-webkit-margin-after:0;-webkit-margin-start:0;-webkit-margin-end:0}kbd{border:1px solid #aaa;-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;-moz-box-shadow:1px 2px 2px #ddd;-webkit-box-shadow:1px 2px 2px #ddd;box-shadow:1px 2px 2px #ddd;background-color:#f9f9f9;background-image:-moz-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-o-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-webkit-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:linear-gradient(top,#eee,#f9f9f9,#eee);padding:1px 3px;font-family:inherit;font-size:.85em}.oembeded .oembed_photo{display:inline-block}img[data-echo]{margin:25px 0;width:100px;height:100px;background:url(../img/ajax.gif) center center no-repeat #fff}.spinner{display:inline-block;width:10px;height:10px;margin-bottom:-.1em;border:2px solid rgba(0,0,0,.5);border-top-color:transparent;border-radius:100%;-webkit-animation:spin 1s infinite linear;animation:spin 1s infinite linear}.spinner:after{content:'';display:block;width:0;height:0;position:absolute;top:-6px;left:0;border:4px solid transparent;border-bottom-color:rgba(0,0,0,.5);-webkit-transform:rotate(45deg);transform:rotate(45deg)}@-webkit-keyframes spin{to{-webkit-transform:rotate(360deg)}}@keyframes spin{to{transform:rotate(360deg)}}p.toc{margin:0!important}p.toc ul{padding-left:10px}p.toc>ul{padding:10px;margin:0 10px;display:inline-block;border:1px solid #ededed;border-radius:5px}p.toc li,p.toc ul{list-style-type:none}p.toc li{width:100%;padding:0;overflow:hidden}p.toc li a::after{content:"."}p.toc li a:before{content:"• "}p.toc h5{text-transform:uppercase}p.toc .title{float:left;padding-right:3px}p.toc .number{margin:0;float:right;padding-left:3px;background:#fff;display:none}input.task-list-item{margin-left:-1.62em}.markdown{font-family:"Hiragino Sans GB","Microsoft YaHei",STHeiti,SimSun,"Lucida Grande","Lucida Sans Unicode","Lucida Sans",'Segoe UI',AppleSDGothicNeo-Medium,'Malgun Gothic',Verdana,Tahoma,sans-serif;padding:20px}.markdown a{text-decoration:none;vertical-align:baseline}.markdown a:hover{text-decoration:underline}.markdown h1{font-size:2.2em;font-weight:700;margin:1.5em 0 1em}.markdown h2{font-size:1.8em;font-weight:700;margin:1.275em 0 .85em}.markdown h3{font-size:1.6em;font-weight:700;margin:1.125em 0 .75em}.markdown h4{font-size:1.4em;font-weight:700;margin:.99em 0 .66em}.markdown h5{font-size:1.2em;font-weight:700;margin:.855em 0 .57em}.markdown h6{font-size:1em;font-weight:700;margin:.75em 0 .5em}.markdown h1+p,.markdown h1:first-child,.markdown h2+p,.markdown h2:first-child,.markdown h3+p,.markdown h3:first-child,.markdown h4+p,.markdown h4:first-child,.markdown h5+p,.markdown h5:first-child,.markdown h6+p,.markdown h6:first-child{margin-top:0}.markdown hr{border:1px solid #ccc}.markdown p{margin:1em 0;word-wrap:break-word}.markdown ol{list-style-type:decimal}.markdown li{display:list-item;line-height:1.4em}.markdown blockquote{margin:1em 20px}.markdown blockquote>:first-child{margin-top:0}.markdown blockquote>:last-child{margin-bottom:0}.markdown blockquote cite:before{content:'\2014 \00A0'}.markdown .code{border-radius:3px;word-wrap:break-word}.markdown pre{border-radius:3px;word-wrap:break-word;border:1px solid #ccc;overflow:auto;padding:.5em}.markdown pre code{border:0;display:block}.markdown pre>code{font-family:Consolas,Inconsolata,Courier,monospace;font-weight:700;white-space:pre;margin:0}.markdown code{border-radius:3px;word-wrap:break-word;border:1px solid #ccc;padding:0 5px;margin:0 2px}.markdown img{max-width:100%}.markdown mark{color:#000;background-color:#fcf8e3}.markdown table{padding:0;border-collapse:collapse;border-spacing:0;margin-bottom:16px}.markdown table tr td,.markdown table tr th{border:1px solid #ccc;margin:0;padding:6px 13px}.markdown table tr th{font-weight:700}.markdown table tr th>:first-child{margin-top:0}.markdown table tr th>:last-child{margin-bottom:0}.markdown table tr td>:first-child{margin-top:0}.markdown table tr td>:last-child{margin-bottom:0}.github{padding:20px;font-family:"Helvetica Neue",Helvetica,"Hiragino Sans GB","Microsoft YaHei",STHeiti,SimSun,"Segoe UI",AppleSDGothicNeo-Medium,'Malgun Gothic',Arial,freesans,sans-serif;font-size:15px;background:#fff;line-height:1.6;-webkit-font-smoothing:antialiased}.github a{color:#3269a0}.github a:hover{color:#4183c4}.github h2{border-bottom:1px solid #e6e6e6;line-height:1.6}.github h6{color:#777}.github hr{border:1px solid #e6e6e6}.github pre>code{font-size:.9em;font-family:Consolas,Inconsolata,Courier,monospace}.github blockquote>code,.github h1>code,.github h2>code,.github h3>code,.github h4>code,.github h5>code,.github h6>code,.github li>code,.github p>code,.github td>code{background-color:rgba(0,0,0,.07);font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;font-size:85%;padding:.2em .5em;border:0}.github blockquote{border-left:4px solid #e6e6e6;padding:0 15px;font-style:italic}.github table{background-color:#fafafa}.github table tr td,.github table tr th{border:1px solid #e6e6e6}.github table tr:nth-child(2n){background-color:#f2f2f2}.hljs{display:block;overflow-x:auto;padding:.5em;color:#333;background:#f8f8f8;-webkit-text-size-adjust:none}.diff .hljs-header,.hljs-comment,.hljs-javadoc{color:#998;font-style:italic}.css .rule .hljs-keyword,.hljs-keyword,.hljs-request,.hljs-status,.hljs-subst,.hljs-winutils,.nginx .hljs-title{color:#333;font-weight:700}.hljs-hexcolor,.hljs-number,.ruby .hljs-constant{color:teal}.hljs-dartdoc,.hljs-phpdoc,.hljs-string,.hljs-tag .hljs-value,.tex .hljs-formula{color:#d14}.hljs-id,.hljs-title,.scss .hljs-preprocessor{color:#900;font-weight:700}.hljs-list .hljs-keyword,.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type,.tex .hljs-command,.vhdl .hljs-literal{color:#458;font-weight:700}.django .hljs-tag .hljs-keyword,.hljs-rules .hljs-property,.hljs-tag,.hljs-tag .hljs-title{color:navy;font-weight:400}.hljs-attribute,.hljs-variable,.lisp .hljs-body{color:teal}.hljs-regexp{color:#009926}.clojure .hljs-keyword,.hljs-prompt,.hljs-symbol,.lisp .hljs-keyword,.ruby .hljs-symbol .hljs-string,.scheme .hljs-keyword,.tex .hljs-special{color:#990073}.hljs-built_in{color:#0086b3}.hljs-cdata,.hljs-doctype,.hljs-pi,.hljs-pragma,.hljs-preprocessor,.hljs-shebang{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.diff .hljs-change{background:#0086b3}.hljs-chunk{color:#aaa}.MathJax_Hover_Frame{border-radius:.25em;-webkit-border-radius:.25em;-moz-border-radius:.25em;-khtml-border-radius:.25em;box-shadow:0 0 15px #83A;-webkit-box-shadow:0 0 15px #83A;-moz-box-shadow:0 0 15px #83A;-khtml-box-shadow:0 0 15px #83A;border:1px solid #A6D!important;display:inline-block;position:absolute}.MathJax_Hover_Arrow{position:absolute;width:15px;height:11px;cursor:pointer}#MathJax_About{position:fixed;left:50%;width:auto;text-align:center;border:3px outset;padding:1em 2em;background-color:#DDD;color:#000;cursor:default;font-family:message-box;font-size:120%;font-style:normal;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;border-radius:15px;-webkit-border-radius:15px;-moz-border-radius:15px;-khtml-border-radius:15px;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_Menu{position:absolute;background-color:#fff;color:#000;width:auto;padding:5px 0;border:1px solid #CCC;margin:0;cursor:default;font:menu;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;border-radius:5px;-webkit-border-radius:5px;-moz-border-radius:5px;-khtml-border-radius:5px;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_MenuItem{padding:1px 2em;background:0 0}.MathJax_MenuArrow{position:absolute;right:.5em;color:#666}.MathJax_MenuActive .MathJax_MenuArrow{color:#fff}.MathJax_MenuArrow.RTL{left:.5em;right:auto}.MathJax_MenuCheck{position:absolute;left:.7em}.MathJax_MenuCheck.RTL{right:.7em;left:auto}.MathJax_MenuRadioCheck{position:absolute;left:.7em}.MathJax_MenuRadioCheck.RTL{right:.7em;left:auto}.MathJax_MenuLabel{padding:1px 2em 3px 1.33em;font-style:italic}.MathJax_MenuRule{border-top:1px solid #DDD;margin:4px 3px}.MathJax_MenuDisabled{color:GrayText}.MathJax_MenuActive{background-color:#606872;color:#fff}.MathJax_Menu_Close{position:absolute;width:31px;height:31px;top:-15px;left:-15px}#MathJax_Zoom{position:absolute;background-color:#F0F0F0;overflow:auto;display:block;z-index:301;padding:.5em;border:1px solid #000;margin:0;font-weight:400;font-style:normal;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;box-shadow:5px 5px 15px #AAA;-webkit-box-shadow:5px 5px 15px #AAA;-moz-box-shadow:5px 5px 15px #AAA;-khtml-box-shadow:5px 5px 15px #AAA;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}#MathJax_ZoomOverlay{position:absolute;left:0;top:0;z-index:300;display:inline-block;width:100%;height:100%;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}#MathJax_ZoomFrame{position:relative;display:inline-block;height:0;width:0}#MathJax_ZoomEventTrap{position:absolute;left:0;top:0;z-index:302;display:inline-block;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}.MathJax_Preview{color:#888}#MathJax_Message{position:fixed;left:1px;bottom:2px;background-color:#E6E6E6;border:1px solid #959595;margin:0;padding:2px 8px;z-index:102;color:#000;font-size:80%;width:auto;white-space:nowrap}#MathJax_MSIE_Frame{position:absolute;top:0;left:0;width:0;z-index:101;border:0;margin:0;padding:0}.MathJax_Error{color:#C00;font-style:italic}footer{position:fixed;font-size:.8em;text-align:right;bottom:0;margin-left:-25px;height:20px;width:100%}</style>
</head>
<body class="markdown github">
<h1 id="manipulating-data-with-r"><a name="manipulating-data-with-r" href="#manipulating-data-with-r"></a>Manipulating data with R</h1><h3 id="introducing-r-and-rstudio"><a name="introducing-r-and-rstudio" href="#introducing-r-and-rstudio"></a>Introducing R and RStudio</h3><p>In today’s class we will process data using <strong><a href="http://www.r-project.org/">R</a></strong>, which is a very powerful tool, designed by statisticians for data analysis. Described on its website as “free software environment for statistical computing and graphics,” R is a programming language that opens a world of possibilities for making graphics and analyzing and processing data. Indeed, just about anything you may want to do with data can be done with R, from web scraping to making interactive graphics.</p><p>Next week we will make static graphics with R. We will explore’s its potential for making interactive charts and maps in week 13, and use it to make animations in week 14. Our goal for this week’s class is to get used to working with data in R.</p><p><strong><a href="http://www.rstudio.com/">RStudio</a></strong> is an “integrated development environment,” or IDE, for R that provides a user-friendly interface.</p><p>Launch RStudio, and the screen should look like this:</p><p><img src="img/class7_1.jpg" alt=""></p><p>The main panel to the left is the R Console. Type valid R code into here, hit <code>return</code>, and it will be run. See what happens if you run:</p><pre class="r hljs"><code class="R" data-origin="<pre><code class=&quot;R&quot;>print(&quot;Hello World!&quot;)
</code></pre>">print(<span class="hljs-string">"Hello World!"</span>)
</code></pre><h3 id="the-data-we-will-use-today"><a name="the-data-we-will-use-today" href="#the-data-we-will-use-today"></a>The data we will use today</h3><p>Download the data for this session from <a href="data/week7.zip">here</a>, unzip the folder and place it on your desktop. It contains the following files, used in reporting <a href="https://www.newscientist.com/article/dn18806-revealed-pfizers-payments-to-censured-doctors/">this story</a>, which revealed that some of the doctors paid as “experts” by the drug company Pfizer had troubling disciplinary records:</p><ul>
<li><p><code>pfizer.csv</code> Payments made by Pfizer to doctors across the United States in the second half on 2009. Contains the following variables:</p>
<ul>
<li><code>org_indiv</code> Full name of the doctor, or their organization.</li><li><code>first_plus</code> Doctor’s first and middle names.</li><li><code>first_name</code> <code>last_name</code>. First and last names.</li><li><code>city</code> <code>state</code> City and state.</li><li><code>category of payment</code> Type of payment, which include <code>Expert-led Forums</code>, in which doctors lecture their peers on using Pfizer’s drugs, and `Professional Advising.</li><li><code>cash</code> Value of payments made in cash.</li><li><code>other</code> Value of payments made in-kind, for example puschase of meals.</li><li><code>total</code> value of payment, whether cash or in-kind.</li></ul>
</li><li><p><code>fda.csv</code> Data on warning letters sent to doctors by the U.S. Food and Drug Administration, because of problems in the way in which they ran clinical trials testing experimental treatments. Contains the following variables:</p>
<ul>
<li><code>name_last</code> <code>name_first</code> <code>name_middle</code> Doctor’s last, first, and middle names.</li><li><code>issued</code> Date letter was sent.</li><li><code>office</code> Office within the FDA that sent the letter.</li></ul>
</li></ul><h3 id="reproducibility:-save-your-scripts"><a name="reproducibility:-save-your-scripts" href="#reproducibility:-save-your-scripts"></a>Reproducibility: Save your scripts</h3><p>Data journalism should ideally be fully documented and reproducible. R makes this easy, as every operation performed can be saved in a script, and repeated by running that script. Click on the <img src="img/class7_2.jpg" alt=""> icon at top left and select <code>R Script</code>. A new panel should now open:</p><p><img src="img/class7_3.jpg" alt=""></p><p>Any code we type in here can be run in the console. Hitting <code>Run</code> will run the line of code on which the cursor is sitting. To run multiple lines of code, highlight them and click <code>Run</code>.</p><p>Click on the save/disk icon in the script panel and save the blank script to the file on your desktop with the data for this week, calling it <code>week7.R</code>.</p><h3 id="set-your-working-directory"><a name="set-your-working-directory" href="#set-your-working-directory"></a>Set your working directory</h3><p>Now we can set the working directory to this folder by selecting from the top menu <code>Session&gt;Set Working Directory&gt;To Source File Location</code>. (Doing so means we can load the files in this directory without having to refer to the full path for their location, and anything we save will be written to this folder.)</p><p>Notice how this code appears in the console:</p><pre class="r hljs"><code class="R" data-origin="<pre><code class=&quot;R&quot;>setwd(&quot;~/Desktop/week7&quot;)
</code></pre>">setwd(<span class="hljs-string">"~/Desktop/week7"</span>)
</code></pre><h3 id="save-your-data"><a name="save-your-data" href="#save-your-data"></a>Save your data</h3><p>The panel at top right has two tabs, the first showing the <code>Environment</code>, or all of the “objects” loaded into memory for this R session. We can save this as well, so we don’t have to load and process data again if we return to return to a project later.</p><p>(The second tab shows the <code>History</code> of the operations you have performed in RStudio.)</p><p>Click on the save/disk icon in the <code>Environment</code> panel to save and call the file <code>week7.RData</code>. You should see the following code appear in the Console:</p><pre class="r hljs"><code class="r" data-origin="<pre><code class=&quot;r&quot;>save.image(&quot;~/Desktop/week7/week7.RData&quot;)
</code></pre>">save.image(<span class="hljs-string">"~/Desktop/week7/week7.RData"</span>)
</code></pre><p>Copy this code into your script, placing it at the end, with a comment, explaining what it does:</p><pre class="r hljs"><code class="r" data-origin="<pre><code class=&quot;r&quot;># save session data
save.image(&quot;~/Desktop/week7/week7.RData&quot;)
</code></pre>"><span class="hljs-comment"># save session data</span>
save.image(<span class="hljs-string">"~/Desktop/week7/week7.RData"</span>)
</code></pre><h3 id="comment-your-code"><a name="comment-your-code" href="#comment-your-code"></a>Comment your code</h3><p>Anything that appears on a line after <code>#</code> will be treated as a comment, and will be ignored when the code is run. Get into the habit of commenting your code: Don’t trust yourself to remember what it does!</p><h3 id="some-r-code-basics"><a name="some-r-code-basics" href="#some-r-code-basics"></a>Some R code basics</h3><ul>
<li><code>&lt;-</code> is known as an “assignment operator.” It means: “Make the object named to the left equal to the output of the code to the right.”</li><li><code>&amp;</code> means AND, in Boolean logic, which we discussed in week 5 when working with web search forms.</li><li><code>|</code> means OR, in Boolean logic.</li><li><code>!</code> means NOT, in Boolean logic.</li><li>When referring to values entered as text, or to dates, put them in quote marks, like this: <code>"United States"</code>, or <code>"2016-07-26"</code>. Numbers are not quoted.</li><li>When entering two or more values as a list, combine them using the function <code>c</code>, with the values separated by commas, for example: <code>c("2016-07-26","2016-08-04")</code></li><li>As in a spreadsheet, you can specify a range of values with a colon, for example: <code>c(1:10)</code> creates a list of integers (whole numbers) from one to ten.</li><li><p>Some common operators:</p>
<ul>
<li><code>+</code> <code>-</code> add, subtract.</li><li><code>*</code> <code>/</code> multiply, divide.</li><li><code>&gt;</code> <code>&lt;</code> greater than, less than.</li><li><code>&gt;=</code> <code>&lt;=</code> greater than or equal to, less than or equal to.</li><li><code>!=</code> not equal to.</li></ul>
</li><li><p>Equals signs can be a little confusing, but see how they are used in the code we use today:</p>
<ul>
<li><code>==</code> test whether an object is equal to a value. This is often used when filtering data, as we will see.</li><li><code>=</code> make an object equal to a value; works like <code>&lt;-</code>, but used within the brackets of a function.</li></ul>
</li></ul><p>We encountered <strong>functions</strong> in week 1 in the context of spreadsheet formulas. They are followed by brackets, and act on the code in the brackets.</p><p><strong>Important:</strong> Object and variable names in R should not contain spaces.</p><h3 id="install-and-load-r-packages"><a name="install-and-load-r-packages" href="#install-and-load-r-packages"></a>Install and load R packages</h3><p>Much of the power of R comes from the thousands of “packages” written by its community of open source contributors. These are optimized for specific statistical, graphical or data-processing tasks. To see what packages are available in the basic distribution of R, select the <code>Packages</code> tab in the panel at bottom right. To find packages for particular tasks, try searching Google using appropriate keywords and the phrase “R package.”</p><p>In this class, we will work with two incredibly useful packages developed by <a href="http://hadley.nz/">Hadley Wickham</a>, chief scientist at RStudio:</p><ul>
<li><strong><a href="https://cran.r-project.org/web/packages/readr/readr.pdf">readr</a></strong> For reading and writes CSV and other text files.</li><li><strong><a href="https://cran.r-project.org/web/packages/dplyr/dplyr.pdf">dplyr</a></strong> For processing and manipulating data.</li></ul><p>These and several other useful packages have been combined into a super-package called <strong><a href="http://insight.livestories.com/">tidyverse</a></strong>.</p><p>To install a package, click on the <code>Install</code> icon in the <code>Packages</code> tab, type its name into the dialog box, and make sure that <code>Install dependencies</code> is checked, as some packages will only run correctly if other packages are also installed. Click <code>Install</code> and all of the required packages should install:</p><p><img src="img/class7_4.jpg" alt=""></p><p>Notice that the following code appears in the console:</p><pre class="r hljs"><code class="r" data-origin="<pre><code class=&quot;r&quot;>install.packages(&quot;tidyverse&quot;)
</code></pre>">install.packages(<span class="hljs-string">"tidyverse"</span>)
</code></pre><p>So you can also install packages with cod in this format, without using the point-and-click interface.</p><p>Each time you start R, it’s a good idea to click on <code>Update</code> in the <code>Packages</code> panel to update all your installed packages to the latest versions.</p><p>Installing a package makes it available to you, but to use it in any R session you need to load it. You can do this by checking its box in the <code>Packages</code> tab. However, we will enter the following code into our script, then highlight these lines of code and run them:</p><pre class="r hljs"><code class="r" data-origin="<pre><code class=&quot;r&quot;># load packages to read, write and manipulate data
library(readr)
library(dplyr)
</code></pre>"><span class="hljs-comment"># load packages to read, write and manipulate data</span>
<span class="hljs-keyword">library</span>(readr)
<span class="hljs-keyword">library</span>(dplyr)
</code></pre><p>At this point, and at regular intervals, save your script, by clicking the save/disk icon in the script panel, or using the <code>⌘-S</code> keyboard shortcut.</p><h3 id="load-and-view-data"><a name="load-and-view-data" href="#load-and-view-data"></a>Load and view data</h3><h4 id="load-data"><a name="load-data" href="#load-data"></a>Load data</h4><p>You can load data into the current R session by selecting <code>Import Dataset&gt;From Text File...</code> in the <code>Environment</code> tab.</p><p>However, we will use the <code>read_csv</code> function from the <strong>readr</strong> package. Copy the following code into your script and <code>Run</code>:</p><pre class="r hljs"><code class="r" data-origin="<pre><code class=&quot;r&quot;># load data of pfizer payments to doctors and warning letters sent by food and drug adminstration
pfizer &amp;lt;- read_csv(&quot;pfizer.csv&quot;)
fda &amp;lt;- read_csv(&quot;fda.csv&quot;)
</code></pre>"><span class="hljs-comment"># load data of pfizer payments to doctors and warning letters sent by food and drug adminstration</span>
pfizer &lt;- read_csv(<span class="hljs-string">"pfizer.csv"</span>)
fda &lt;- read_csv(<span class="hljs-string">"fda.csv"</span>)
</code></pre><p>Notice that the <code>Environment</code> now contains two objects, of the type <code>tbl_df</code>, a variety of the standard R object for holding tables of data, known as a <strong>data frame</strong>:</p><p><img src="img/class7_5.jpg" alt=""></p><p>The <code>Value</code> for each data frame details the number of columns, and the number of rows, or observations, in the data.</p><p>You can remove any object from your environment by checking it in the <code>Grid</code> view and clicking the broom icon.</p><h4 id="examine-the-data"><a name="examine-the-data" href="#examine-the-data"></a>Examine the data</h4><p>We can <code>View</code> data at any time by clicking on its table icon in the <code>Environment</code> tab in the <code>Grid</code> view.</p><p>Here, for example, I am looking at the <code>pfizer</code> view:</p><p><img src="img/class7_6.jpg" alt=""></p><p>The <code>str</code> function will tell you more about the columns in your data, including their data type. Copy this code into your script and <code>Run</code>:</p><pre class="r hljs"><code class="r" data-origin="<pre><code class=&quot;r&quot;># view structure of data
str(pfizer)
</code></pre>"><span class="hljs-comment"># view structure of data</span>
str(pfizer)
</code></pre><p>This should give the following output in the R Console:</p><pre class="json hljs"><code class="JSON" data-origin="<pre><code class=&quot;JSON&quot;>Classes ‘tbl_df’, ‘tbl’ and 'data.frame':    10087 obs. of  10 variables:
 $ org_indiv : chr  &quot;3-D MEDICAL SERVICES LLC&quot; &quot;AA DOCTORS, INC.&quot; &quot;ABBO, LILIAN MARGARITA&quot; &quot;ABBO, LILIAN MARGARITA&quot; ...
 $ first_plus: chr  &quot;STEVEN BRUCE&quot; &quot;AAKASH MOHAN&quot; &quot;LILIAN MARGARITA&quot; &quot;LILIAN MARGARITA&quot; ...
 $ first_name: chr  &quot;STEVEN&quot; &quot;AAKASH&quot; &quot;LILIAN&quot; &quot;LILIAN&quot; ...
 $ last_name : chr  &quot;DEITELZWEIG&quot; &quot;AHUJA&quot; &quot;ABBO&quot; &quot;ABBO&quot; ...
 $ city      : chr  &quot;NEW ORLEANS&quot; &quot;PASO ROBLES&quot; &quot;MIAMI&quot; &quot;MIAMI&quot; ...
 $ state     : chr  &quot;LA&quot; &quot;CA&quot; &quot;FL&quot; &quot;FL&quot; ...
 $ category  : chr  &quot;Professional Advising&quot; &quot;Expert-Led Forums&quot; &quot;Business Related Travel&quot; &quot;Meals&quot; ...
 $ cash      : int  2625 1000 0 0 1800 750 0 825 3000 0 ...
 $ other     : int  0 0 448 119 0 0 47 0 0 396 ...
 $ total     : int  2625 1000 448 119 1800 750 47 825 3000 396 ...
</code></pre>">Classes ‘tbl_df’, ‘tbl’ and 'data.frame':    10087 obs. of  10 variables:
 $ org_indiv : chr  "3-D MEDICAL SERVICES LLC" "AA DOCTORS, INC." "ABBO, LILIAN MARGARITA" "ABBO, LILIAN MARGARITA" ...
 $ first_plus: chr  "STEVEN BRUCE" "AAKASH MOHAN" "LILIAN MARGARITA" "LILIAN MARGARITA" ...
 $ first_name: chr  "STEVEN" "AAKASH" "LILIAN" "LILIAN" ...
 $ last_name : chr  "DEITELZWEIG" "AHUJA" "ABBO" "ABBO" ...
 $ city      : chr  "NEW ORLEANS" "PASO ROBLES" "MIAMI" "MIAMI" ...
 $ state     : chr  "LA" "CA" "FL" "FL" ...
 $ category  : chr  "Professional Advising" "Expert-Led Forums" "Business Related Travel" "Meals" ...
 $ cash      : int  2625 1000 0 0 1800 750 0 825 3000 0 ...
 $ other     : int  0 0 448 119 0 0 47 0 0 396 ...
 $ total     : int  2625 1000 448 119 1800 750 47 825 3000 396 ...
</code></pre><p><code>chr</code> means “character,” or a string of text (which can be treated as a categorical variable); <code>int</code> means an integer, or whole number.</p><p>Also examine the structure of the <code>fda</code> data frame using the following code:</p><pre class="r hljs"><code class="r" data-origin="<pre><code class=&quot;r&quot;>str(fda)
</code></pre>">str(fda)
</code></pre><p>This should be the console output:</p><pre class="json hljs"><code class="JSON" data-origin="<pre><code class=&quot;JSON&quot;>Classes ‘tbl_df’, ‘tbl’ and 'data.frame':    272 obs. of  5 variables:
 $ name_last  : chr  &quot;ADELGLASS&quot; &quot;ADKINSON&quot; &quot;ALLEN&quot; &quot;AMSTERDAM&quot; ...
 $ name_first : chr  &quot;JEFFREY&quot; &quot;N.&quot; &quot;MARK&quot; &quot;DANIEL&quot; ...
 $ name_middle: chr  &quot;M.&quot; &quot;FRANKLIN&quot; &quot;S.&quot; NA ...
 $ issued     : Date, format: &quot;1999-05-25&quot; ...
 $ office     : chr  &quot;Center for Drug Evaluation and Research&quot; &quot;Center for Biologics Evaluation and Research&quot; &quot;Center for Devices and Radiological Health&quot; &quot;Center for Biologics Evaluation and Research&quot; ...
</code></pre>">Classes ‘tbl_df’, ‘tbl’ and 'data.frame':    272 obs. of  5 variables:
 $ name_last  : chr  "ADELGLASS" "ADKINSON" "ALLEN" "AMSTERDAM" ...
 $ name_first : chr  "JEFFREY" "N." "MARK" "DANIEL" ...
 $ name_middle: chr  "M." "FRANKLIN" "S." NA ...
 $ issued     : Date, format: "1999-05-25" ...
 $ office     : chr  "Center for Drug Evaluation and Research" "Center for Biologics Evaluation and Research" "Center for Devices and Radiological Health" "Center for Biologics Evaluation and Research" ...
</code></pre><p>Notice that <code>issued</code> has been recognized as a <code>Date</code> variable. Other common data types include <code>num</code>, for numbers that may contain decimals and <code>POSIXct</code> for full date and time.</p><p>If you run into any trouble importing data with <strong>readr</strong>, you may need to specify the data types for some columns — in particular for date and time. <a href="https://github.com/hadley/readr/blob/master/vignettes/column-types.Rmd">This link</a> explains how to set data types for individual variables when importing data with <strong>readr</strong>.</p><p>To specify an individual column use the name of the data frame and the column name, separated by <code>$</code>. Type this into your script and run:</p><pre class="r hljs"><code class="r" data-origin="<pre><code class=&quot;r&quot;># print values for total in pfizer data
pfizer$total
</code></pre>"><span class="hljs-comment"># print values for total in pfizer data</span>
pfizer$total
</code></pre><p>The output will be the first 10,000 values for that column.</p><p>If you need to change the data type for any column, use the following functions:</p><ul>
<li><code>as.character</code> converts to a text string.</li><li><code>as.numeric</code> converts to a number.</li><li><code>as.factor</code> converts to a categorical variable.</li><li><code>as.integer</code> converts to an integer</li><li><code>as.Date</code> converts to a date</li><li><code>as.POSIXct</code> convets to a full date and time.</li></ul><p>(Conversions to full dates and times can get complicated, because of timezones. Contact me for advice if you need to work with full dates and times for your project!)</p><p>Now add the following code to your script to convert the convert <code>total</code> in the <code>pfizer</code> data to a numeric variable (which would allow it to hold decimal values, if we had any).</p><pre class="r hljs"><code class="r" data-origin="<pre><code class=&quot;r&quot;># convert total to numeric variable
pfizer$total &amp;lt;- as.numeric(pfizer$total)
str(pfizer)
</code></pre>"><span class="hljs-comment"># convert total to numeric variable</span>
pfizer$total &lt;- as.numeric(pfizer$total)
str(pfizer)
</code></pre><p>Notice that the data type for <code>total</code> has now changed:</p><pre class="json hljs"><code class="JSON" data-origin="<pre><code class=&quot;JSON&quot;>Classes ‘tbl_df’, ‘tbl’ and 'data.frame':    10087 obs. of  10 variables:
 $ org_indiv : chr  &quot;3-D MEDICAL SERVICES LLC&quot; &quot;AA DOCTORS, INC.&quot; &quot;ABBO, LILIAN MARGARITA&quot; &quot;ABBO, LILIAN MARGARITA&quot; ...
 $ first_plus: chr  &quot;STEVEN BRUCE&quot; &quot;AAKASH MOHAN&quot; &quot;LILIAN MARGARITA&quot; &quot;LILIAN MARGARITA&quot; ...
 $ first_name: chr  &quot;STEVEN&quot; &quot;AAKASH&quot; &quot;LILIAN&quot; &quot;LILIAN&quot; ...
 $ last_name : chr  &quot;DEITELZWEIG&quot; &quot;AHUJA&quot; &quot;ABBO&quot; &quot;ABBO&quot; ...
 $ city      : chr  &quot;NEW ORLEANS&quot; &quot;PASO ROBLES&quot; &quot;MIAMI&quot; &quot;MIAMI&quot; ...
 $ state     : chr  &quot;LA&quot; &quot;CA&quot; &quot;FL&quot; &quot;FL&quot; ...
 $ category  : chr  &quot;Professional Advising&quot; &quot;Expert-Led Forums&quot; &quot;Business Related Travel&quot; &quot;Meals&quot; ...
 $ cash      : int  2625 1000 0 0 1800 750 0 825 3000 0 ...
 $ other     : int  0 0 448 119 0 0 47 0 0 396 ...
 $ total     : num  2625 1000 448 119 1800 ...
</code></pre>">Classes ‘tbl_df’, ‘tbl’ and 'data.frame':    10087 obs. of  10 variables:
 $ org_indiv : chr  "3-D MEDICAL SERVICES LLC" "AA DOCTORS, INC." "ABBO, LILIAN MARGARITA" "ABBO, LILIAN MARGARITA" ...
 $ first_plus: chr  "STEVEN BRUCE" "AAKASH MOHAN" "LILIAN MARGARITA" "LILIAN MARGARITA" ...
 $ first_name: chr  "STEVEN" "AAKASH" "LILIAN" "LILIAN" ...
 $ last_name : chr  "DEITELZWEIG" "AHUJA" "ABBO" "ABBO" ...
 $ city      : chr  "NEW ORLEANS" "PASO ROBLES" "MIAMI" "MIAMI" ...
 $ state     : chr  "LA" "CA" "FL" "FL" ...
 $ category  : chr  "Professional Advising" "Expert-Led Forums" "Business Related Travel" "Meals" ...
 $ cash      : int  2625 1000 0 0 1800 750 0 825 3000 0 ...
 $ other     : int  0 0 448 119 0 0 47 0 0 396 ...
 $ total     : num  2625 1000 448 119 1800 ...
</code></pre><p>The <code>summary</code> function will run a quick statistical summary of a data frame, calculating mean, median and quartile values for continuous variables:</p><pre class="r hljs"><code class="r" data-origin="<pre><code class=&quot;r&quot;># summary of pfizer data
summary(pfizer)
</code></pre>"><span class="hljs-comment"># summary of pfizer data</span>
summary(pfizer)
</code></pre><p>Here is the last part of the console output:</p><pre class="json hljs"><code class="JSON" data-origin="<pre><code class=&quot;JSON&quot;>     total        
 Min.   :      0  
 1st Qu.:    191  
 Median :    750  
 Mean   :   3507  
 3rd Qu.:   2000  
 Max.   :1185466
</code></pre>">     total        
 Min.   :      0  
 1st Qu.:    191  
 Median :    750  
 Mean   :   3507  
 3rd Qu.:   2000  
 Max.   :1185466
</code></pre><h3 id="manipulate-and-analyze-data"><a name="manipulate-and-analyze-data" href="#manipulate-and-analyze-data"></a>Manipulate and analyze data</h3><p>Now we will use <strong>dplyr</strong> to manipulate the data, using the basic operations we discussed in week 1:</p><ul>
<li><p><strong>Sort:</strong> Largest to smallest, oldest to newest, alphabetical etc.</p>
</li><li><p><strong>Filter:</strong> Select a defined subset of the data.</p>
</li><li><p><strong>Summarize/Aggregate:</strong> Deriving one value from a series of other values to produce a summary statistic. Examples include: count, sum, mean, median, maximum, minimum etc. Often you’ll <strong>group</strong> data into categories first, and then aggregate by group.</p>
</li><li><p><strong>Join:</strong> Merging entries from two or more datasets based on common field(s), e.g. unique ID number, last name and first name.</p>
</li></ul><p>Here are some of the most useful functions in <strong>dplyr</strong>:</p><ul>
<li><code>select</code> Choose which columns to include.</li><li><code>filter</code> <strong>Filter</strong> the data.</li><li><code>arrange</code> <strong>Sort</strong> the data, by size for continuous variables, by date, or alphabetically.</li><li><code>group_by</code> <strong>Group</strong> the data by a categorical variable.</li><li><code>summarize</code> <strong>Summarize</strong>, or aggregate (for each group if following <code>group_by</code>). Often used in conjunction with functions including:<ul>
<li><code>mean</code> Calculate the mean, or average.</li><li><code>median</code> Calculate the median.</li><li><code>max</code> Find the maximum value.</li><li><code>min</code> Find the minimum value</li><li><code>sum</code> Add all the values together.</li><li><code>n</code> Count the number of records.</li></ul>
</li><li><code>mutate</code> Create new column(s) in the data, or change existing column(s).</li><li><code>rename</code> Rename column(s).</li><li><code>bind_rows</code> Merge two data frames into one, combining data from columns with the same name.</li></ul><p>There are also various functions to <strong>join</strong> data, which we will explore below.</p><p>These functions can be chained together using the operator <code>%&gt;%</code> which makes the output of one line of code the input for the next. This allows you to run through a series of operations in logical order. I find it helpful to think of <code>%&gt;%</code> as “then.”</p><h4 id="filter-and-sort-data"><a name="filter-and-sort-data" href="#filter-and-sort-data"></a>Filter and sort data</h4><p>Now we will <strong>filter</strong> and <strong>sort</strong> the data in specific ways. For each of the following examples, copy the code that follows into your script, and view the results. Notice how we create a new objects to hold the processed data.</p><h5 id="find-doctors-in-california-paid-$10,000-or-more-by-pfizer-to-run-“expert-led-forums.”"><a name="find-doctors-in-california-paid-$10,000-or-more-by-pfizer-to-run-“expert-led-forums.”" href="#find-doctors-in-california-paid-$10,000-or-more-by-pfizer-to-run-“expert-led-forums.”"></a>Find doctors in California paid $10,000 or more by Pfizer to run “Expert-Led Forums.”</h5><pre class="r hljs"><code class="r" data-origin="<pre><code class=&quot;r&quot;># doctors in California who were paid $10,000 or more by Pfizer to run “Expert-Led Forums.”
ca_expert_10000 &amp;lt;- pfizer %&amp;gt;%
  filter(state == &quot;CA&quot; &amp;amp; total &amp;gt;= 10000 &amp;amp; category == &quot;Expert-Led Forums&quot;)
</code></pre>"><span class="hljs-comment"># doctors in California who were paid $10,000 or more by Pfizer to run “Expert-Led Forums.”</span>
ca_expert_10000 &lt;- pfizer %&gt;%
  filter(state == <span class="hljs-string">"CA"</span> &amp; total &gt;= <span class="hljs-number">10000</span> &amp; category == <span class="hljs-string">"Expert-Led Forums"</span>)
</code></pre><p>Notice the use of <code>==</code> to find values that match the specified text, <code>&gt;=</code> for greater than or equal to, and the Boolean operator <code>&amp;</code>.</p><p>Now add a <strong>sort</strong> to the end of the code to list the doctors in descending order by the payments received:</p><pre class="r hljs"><code class="r" data-origin="<pre><code class=&quot;r&quot;># doctors in California who were paid $10,000 or more by Pfizer to run “Expert-Led Forums.”
ca_expert_10000 &amp;lt;- pfizer %&amp;gt;%
  filter(state == &quot;CA&quot; &amp;amp; total &amp;gt;= 10000 &amp;amp; category == &quot;Expert-Led Forums&quot;) %&amp;gt;%
  arrange(desc(total))
</code></pre>"><span class="hljs-comment"># doctors in California who were paid $10,000 or more by Pfizer to run “Expert-Led Forums.”</span>
ca_expert_10000 &lt;- pfizer %&gt;%
  filter(state == <span class="hljs-string">"CA"</span> &amp; total &gt;= <span class="hljs-number">10000</span> &amp; category == <span class="hljs-string">"Expert-Led Forums"</span>) %&gt;%
  arrange(desc(total))
</code></pre><p>If you <code>arrange</code> without the <code>desc</code> function, the <strong>sort</strong> will be from smallest to largest.</p><h5 id="find-doctors-in-california-*or*-new-york-who-were-paid-$10,000-or-more-by-pfizer-to-run-“expert-led-forums.”"><a name="find-doctors-in-california-*or*-new-york-who-were-paid-$10,000-or-more-by-pfizer-to-run-“expert-led-forums.”" href="#find-doctors-in-california-*or*-new-york-who-were-paid-$10,000-or-more-by-pfizer-to-run-“expert-led-forums.”"></a>Find doctors in California <em>or</em> New York who were paid $10,000 or more by Pfizer to run “Expert-Led Forums.”</h5><pre class="r hljs"><code class="r" data-origin="<pre><code class=&quot;r&quot;>ca_ny_expert_10000 &amp;lt;- pfizer %&amp;gt;%
  filter((state == &quot;CA&quot; | state == &quot;NY&quot;) &amp;amp; total &amp;gt;= 10000 &amp;amp; category == &quot;Expert-Led Forums&quot;) %&amp;gt;%
  arrange(desc(total))
</code></pre>">ca_ny_expert_10000 &lt;- pfizer %&gt;%
  filter((state == <span class="hljs-string">"CA"</span> | state == <span class="hljs-string">"NY"</span>) &amp; total &gt;= <span class="hljs-number">10000</span> &amp; category == <span class="hljs-string">"Expert-Led Forums"</span>) %&gt;%
  arrange(desc(total))
</code></pre><p>Notice the use of the <code>|</code> Boolean operator, and the brackets around that part of the query. This ensures that this part of the query is run first. See what happens if you exclude them.</p><h5 id="find-doctors-in-states-*other-than*-california-who-were-paid-$10,000-or-more-by-pfizer-to-run-“expert-led-forums.”"><a name="find-doctors-in-states-*other-than*-california-who-were-paid-$10,000-or-more-by-pfizer-to-run-“expert-led-forums.”" href="#find-doctors-in-states-*other-than*-california-who-were-paid-$10,000-or-more-by-pfizer-to-run-“expert-led-forums.”"></a>Find doctors in states <em>other than</em> California who were paid $10,000 or more by Pfizer to run “Expert-Led Forums.”</h5><pre class="r hljs"><code class="r" data-origin="<pre><code class=&quot;r&quot;>not_ca_expert_10000 &amp;lt;- pfizer %&amp;gt;%
  filter(state != &quot;CA&quot; &amp;amp; total &amp;gt;= 10000 &amp;amp; category==&quot;Expert-Led Forums&quot;)) %&amp;gt;%
  arrange(desc(total))
</code></pre>">not_ca_expert_10000 &lt;- pfizer %&gt;%
  filter(state != <span class="hljs-string">"CA"</span> &amp; total &gt;= <span class="hljs-number">10000</span> &amp; category==<span class="hljs-string">"Expert-Led Forums"</span>)) %&gt;%
  arrange(desc(total))
</code></pre><p>Notice the use of the <code>!=</code> operator to exclude doctors in California.</p><h5 id="find-the-20-doctors-across-the-four-largest-states-(ca,-tx,-fl,-ny)-who-were-paid-the-most-for-professional-advice."><a name="find-the-20-doctors-across-the-four-largest-states-(ca,-tx,-fl,-ny)-who-were-paid-the-most-for-professional-advice." href="#find-the-20-doctors-across-the-four-largest-states-(ca,-tx,-fl,-ny)-who-were-paid-the-most-for-professional-advice."></a>Find the 20 doctors across the four largest states (CA, TX, FL, NY) who were paid the most for professional advice.</h5><pre class="r hljs"><code class="r" data-origin="<pre><code class=&quot;r&quot;>ca_ny_tx_fl_prof_top20 &amp;lt;- pfizer %&amp;gt;%
  filter((state==&quot;CA&quot; | state == &quot;NY&quot; | state == &quot;TX&quot; | state == &quot;FL&quot;) &amp;amp; category == &quot;Professional Advising&quot;) %&amp;gt;%
  arrange(desc(total)) %&amp;gt;%
  head(20)
</code></pre>">ca_ny_tx_fl_prof_top20 &lt;- pfizer %&gt;%
  filter((state==<span class="hljs-string">"CA"</span> | state == <span class="hljs-string">"NY"</span> | state == <span class="hljs-string">"TX"</span> | state == <span class="hljs-string">"FL"</span>) &amp; category == <span class="hljs-string">"Professional Advising"</span>) %&gt;%
  arrange(desc(total)) %&gt;%
  head(<span class="hljs-number">20</span>)
</code></pre><p>Notice the use of <code>head</code>, which grabs a defined number of rows from the start of a data frame. Here, it is crucial to run the sort first! See what happens if you change the order of the last two lines.</p><h5 id="filter-the-data-for-all-payments-for-running-expert-led-forums-or-for-professional-advising,-and-arrange-alphabetically-by-doctor-(last-name,-then-first-name)"><a name="filter-the-data-for-all-payments-for-running-expert-led-forums-or-for-professional-advising,-and-arrange-alphabetically-by-doctor-(last-name,-then-first-name)" href="#filter-the-data-for-all-payments-for-running-expert-led-forums-or-for-professional-advising,-and-arrange-alphabetically-by-doctor-(last-name,-then-first-name)"></a>Filter the data for all payments for running Expert-Led Forums or for Professional Advising, and arrange alphabetically by doctor (last name, then first name)</h5><pre class="r hljs"><code class="r" data-origin="<pre><code class=&quot;r&quot;># Filter the data for all payments for running Expert-Led Forums or for Professional Advising, and arrange alphabetically by doctor (last name, then first name)
expert_advice &amp;lt;- pfizer %&amp;gt;%
  filter(category == &quot;Expert-Led Forums&quot; | category == &quot;Professional Advising&quot;) %&amp;gt;%
  arrange(last_name, first_name)
</code></pre>"><span class="hljs-comment"># Filter the data for all payments for running Expert-Led Forums or for Professional Advising, and arrange alphabetically by doctor (last name, then first name)</span>
expert_advice &lt;- pfizer %&gt;%
  filter(category == <span class="hljs-string">"Expert-Led Forums"</span> | category == <span class="hljs-string">"Professional Advising"</span>) %&gt;%
  arrange(last_name, first_name)
</code></pre><p>Notice that you can <strong>sort</strong> by multiple variables, separated by commas.</p><h5 id="use-pattern-matching-to-filter-text"><a name="use-pattern-matching-to-filter-text" href="#use-pattern-matching-to-filter-text"></a>Use pattern matching to filter text</h5><p>The following code uses the <code>grepl</code> function to find values containing a particular string of text. This can simplify the code used to <strong>filter</strong> based on text.</p><pre class="r hljs"><code class="r" data-origin="<pre><code class=&quot;r&quot;># use pattern matching to filter text
expert_advice &amp;lt;- pfizer %&amp;gt;%
  filter(grepl(&quot;Expert|Professional&quot;, category)) %&amp;gt;%
  arrange(last_name, first_name)

not_expert_advice &amp;lt;- pfizer %&amp;gt;%
  filter(!grepl(&quot;Expert|Professional&quot;, category)) %&amp;gt;%
  arrange(last_name, first_name)
</code></pre>"><span class="hljs-comment"># use pattern matching to filter text</span>
expert_advice &lt;- pfizer %&gt;%
  filter(grepl(<span class="hljs-string">"Expert|Professional"</span>, category)) %&gt;%
  arrange(last_name, first_name)

not_expert_advice &lt;- pfizer %&gt;%
  filter(!grepl(<span class="hljs-string">"Expert|Professional"</span>, category)) %&gt;%
  arrange(last_name, first_name)
</code></pre><p>This code differs only by the <code>!</code> Boolean operator. Notice that it has split the data into two, based on categories of payment.</p><h4 id="append-one-data-frame-to-another"><a name="append-one-data-frame-to-another" href="#append-one-data-frame-to-another"></a>Append one data frame to another</h4><p>The following code uses the <code>bind_rows</code> function to append one data frame to another, here recreating the unfiltered data from the two data frames above.</p><pre class="r hljs"><code class="r" data-origin="<pre><code class=&quot;r&quot;># merge/append data frames
pfizer2 &amp;lt;- bind_rows(expert_advice, not_expert_advice)
</code></pre>"><span class="hljs-comment"># merge/append data frames</span>
pfizer2 &lt;- bind_rows(expert_advice, not_expert_advice)
</code></pre><h4 id="write-data-to-a-csv-file"><a name="write-data-to-a-csv-file" href="#write-data-to-a-csv-file"></a>Write data to a CSV file</h4><p><strong>readr</strong> can write data to CSV and other text files.</p><pre class="r hljs"><code class="r" data-origin="<pre><code class=&quot;r&quot;># write expert_advice data to a csv file
write_csv(expert_advice, &quot;expert_advice.csv&quot;, na=&quot;&quot;)
</code></pre>"><span class="hljs-comment"># write expert_advice data to a csv file</span>
write_csv(expert_advice, <span class="hljs-string">"expert_advice.csv"</span>, na=<span class="hljs-string">""</span>)
</code></pre><p>When you run this code, a CSV file with the data should be saved in your <code>week7</code> folder. <code>na=""</code> ensures that any empty cells in the data frame are saved as blanks — R represents null values as <code>NA</code>, so if you don’t include this, any null values will appear as <code>NA</code> in the saved file.</p><h4 id="group-and-summarize-data"><a name="group-and-summarize-data" href="#group-and-summarize-data"></a>Group and summarize data</h4><h5 id="calculate-the-total-payments,-by-state"><a name="calculate-the-total-payments,-by-state" href="#calculate-the-total-payments,-by-state"></a>Calculate the total payments, by state</h5><pre class="r hljs"><code class="r" data-origin="<pre><code class=&quot;r&quot;># calculate total payments by state
state_sum &amp;lt;- pfizer %&amp;gt;%
  group_by(state) %&amp;gt;%
  summarize(sum = sum(total)) %&amp;gt;%
  arrange(desc(sum))
</code></pre>"><span class="hljs-comment"># calculate total payments by state</span>
state_sum &lt;- pfizer %&gt;%
  group_by(state) %&gt;%
  summarize(sum = sum(total)) %&gt;%
  arrange(desc(sum))
</code></pre><p>Notice the use of <code>group_by</code> followed by <code>summarize</code> to <strong>group</strong> and <strong>summarize</strong> data, here using the function <code>sum</code>.</p><h5 id="calculate-some-additional-summary-statistics,-by-state"><a name="calculate-some-additional-summary-statistics,-by-state" href="#calculate-some-additional-summary-statistics,-by-state"></a>Calculate some additional summary statistics, by state</h5><pre class="r hljs"><code class="r" data-origin="<pre><code class=&quot;r&quot;># As above, but for each state also calculate the median payment, and the number of payments
state_summary &amp;lt;- pfizer %&amp;gt;%
  group_by(state) %&amp;gt;%
  summarize(sum = sum(total), median = median(total), count = n()) %&amp;gt;%
  arrange(desc(sum))
</code></pre>"><span class="hljs-comment"># As above, but for each state also calculate the median payment, and the number of payments</span>
state_summary &lt;- pfizer %&gt;%
  group_by(state) %&gt;%
  summarize(sum = sum(total), median = median(total), count = n()) %&gt;%
  arrange(desc(sum))
</code></pre><p>Notice the use of multiple summary functions, <code>sum</code>, <code>median</code>, and <code>n</code>. (You don’t specify a variable for <code>n</code> because it is simply counting the number of rows in the data.)</p><h5 id="group-and-summarize-for-multiple-categories"><a name="group-and-summarize-for-multiple-categories" href="#group-and-summarize-for-multiple-categories"></a>Group and summarize for multiple categories</h5><pre class="r hljs"><code class="r" data-origin="<pre><code class=&quot;r&quot;># as above, but group by state and category
state_category_summary &amp;lt;- pfizer %&amp;gt;%
  group_by(state, category) %&amp;gt;%
  summarize(sum = sum(total), median = median(total), count = n()) %&amp;gt;%
  arrange(state, category)
</code></pre>"><span class="hljs-comment"># as above, but group by state and category</span>
state_category_summary &lt;- pfizer %&gt;%
  group_by(state, category) %&gt;%
  summarize(sum = sum(total), median = median(total), count = n()) %&gt;%
  arrange(state, category)
</code></pre><p>As for <code>arrange</code>, you can <code>group_by</code> by multiple variables, separated by commas.</p><h4 id="working-with-dates"><a name="working-with-dates" href="#working-with-dates"></a>Working with dates</h4><p>Now let’s run see how to work with dates, using the FDA warning letters data.</p><h5 id="filter-the-data-for-letters-sent-from-the-start-of-2005-onwards"><a name="filter-the-data-for-letters-sent-from-the-start-of-2005-onwards" href="#filter-the-data-for-letters-sent-from-the-start-of-2005-onwards"></a>Filter the data for letters sent from the start of 2005 onwards</h5><pre class="r hljs"><code class="R" data-origin="<pre><code class=&quot;R&quot;># FDA warning letters sent from the start of 2005 onwards
post2005 &amp;lt;- fda %&amp;gt;%
  filter(issued &amp;gt;= &quot;2005-01-01&quot;) %&amp;gt;%
  arrange(issued)
</code></pre>"><span class="hljs-comment"># FDA warning letters sent from the start of 2005 onwards</span>
post2005 &lt;- fda %&gt;%
  filter(issued &gt;= <span class="hljs-string">"2005-01-01"</span>) %&gt;%
  arrange(issued)
</code></pre><p>Notice that operators like <code>&gt;=</code> can be used for dates, as well as for numbers.</p><h5 id="count-the-number-of-letters-issued-by-year"><a name="count-the-number-of-letters-issued-by-year" href="#count-the-number-of-letters-issued-by-year"></a>Count the number of letters issued by year</h5><pre class="r hljs"><code class="r" data-origin="<pre><code class=&quot;r&quot;># count the letters by year
letters_year &amp;lt;- fda %&amp;gt;%
  mutate(year = format(issued, &quot;%Y&quot;)) %&amp;gt;%
  group_by(year) %&amp;gt;%
  summarize(letters=n())
</code></pre>"><span class="hljs-comment"># count the letters by year</span>
letters_year &lt;- fda %&gt;%
  mutate(year = format(issued, <span class="hljs-string">"%Y"</span>)) %&gt;%
  group_by(year) %&gt;%
  summarize(letters=n())
</code></pre><p>This code introduces <strong>dplyr’s</strong> <code>mutate</code> function to create a new column in the data. The new variable <code>year</code> is the four-digit year <code>"%Y</code> (see <a href="https://www.r-bloggers.com/date-formats-in-r/">here</a> for more on time and date formats in R), extracted from the <code>issued</code> dates using the <code>format</code> function. Then the code groups by year and counts the number of letters for each one.</p><h5 id="add-columns-giving-the-number-of-days-and-weeks-that-have-elapsed-since-each-letter-was-sent"><a name="add-columns-giving-the-number-of-days-and-weeks-that-have-elapsed-since-each-letter-was-sent" href="#add-columns-giving-the-number-of-days-and-weeks-that-have-elapsed-since-each-letter-was-sent"></a>Add columns giving the number of days and weeks that have elapsed since each letter was sent</h5><pre class="r hljs"><code class="r" data-origin="<pre><code class=&quot;r&quot;># add new columns showing many days and weeks elapsed since each letter was sent
fda &amp;lt;- fda %&amp;gt;%
  mutate(days_elapsed = Sys.Date() - issued,
          weeks_elapsed = difftime(Sys.Date(), issued, units = &quot;weeks&quot;))
</code></pre>"><span class="hljs-comment"># add new columns showing many days and weeks elapsed since each letter was sent</span>
fda &lt;- fda %&gt;%
  mutate(days_elapsed = Sys.Date() - issued,
          weeks_elapsed = difftime(Sys.Date(), issued, units = <span class="hljs-string">"weeks"</span>))
</code></pre><p>Notice in the first line that this code changes the <code>fda</code> data frame, rather than creating a new object. The function <code>Sys.Date</code> returns the current date, and if you subtract another date, it will calculate the difference in days. To calculate date and time differences using other units, use the <code>difftime</code> function.</p><p>Notice also that you can <code>mutate</code> multiple columns at one go, separated by commas.</p><h4 id="join-data-from-two-data-frames"><a name="join-data-from-two-data-frames" href="#join-data-from-two-data-frames"></a>Join data from two data frames</h4><p>There are also a number of <strong>join</strong> functions in <strong>dplyr</strong> to combine data from two data frames. Here are the most useful:</p><ul>
<li><code>inner_join()</code> returns values from both tables only where there is a match.</li><li><code>left_join()</code> returns all the values from the first-mentioned table, plus those from the second table that match.</li><li><code>semi_join()</code> filters the first-mentioned table to include only values that have matches in the second table.</li><li><code>anti_join()</code> filters the first-mentioned table to include only values that have no matches in the second table.</li></ul><p>To illustrate, these <strong>joins</strong> will find doctors paid by Pfizer to run expert led forums who had also received a warning letter from the FDA:</p><pre class="r hljs"><code class="r" data-origin="<pre><code class=&quot;r&quot;># join to identify doctors paid to run Expert-led forums who also received a warning letter
expert_warned_inner &amp;lt;- inner_join(pfizer, fda, by=c(&quot;first_name&quot; = &quot;name_first&quot;, &quot;last_name&quot; = &quot;name_last&quot;)) %&amp;gt;%
  filter(category==&quot;Expert-Led Forums&quot;)

expert_warned_semi &amp;lt;- semi_join(pfizer, fda, by=c(&quot;first_name&quot; = &quot;name_first&quot;, &quot;last_name&quot; = &quot;name_last&quot;)) %&amp;gt;%
  filter(category==&quot;Expert-Led Forums&quot;)
</code></pre>"><span class="hljs-comment"># join to identify doctors paid to run Expert-led forums who also received a warning letter</span>
expert_warned_inner &lt;- inner_join(pfizer, fda, by=c(<span class="hljs-string">"first_name"</span> = <span class="hljs-string">"name_first"</span>, <span class="hljs-string">"last_name"</span> = <span class="hljs-string">"name_last"</span>)) %&gt;%
  filter(category==<span class="hljs-string">"Expert-Led Forums"</span>)

expert_warned_semi &lt;- semi_join(pfizer, fda, by=c(<span class="hljs-string">"first_name"</span> = <span class="hljs-string">"name_first"</span>, <span class="hljs-string">"last_name"</span> = <span class="hljs-string">"name_last"</span>)) %&gt;%
  filter(category==<span class="hljs-string">"Expert-Led Forums"</span>)
</code></pre><p>The code in <code>by=c()</code> defines how the <strong>join</strong> should be made. If instructions on how to join the tables are not supplied, <strong>dplyr</strong> will look for columns with matching names, and perform the <strong>join</strong> based on those.</p><p>The difference between the two <strong>joins</strong>  above is that the first contains all of the columns from both data frames, while the second gives only columns from the <code>pfizer</code> data frame.</p><p>In practice, you may wish to <code>inner_join</code> and then use <strong>dplyr’s</strong> <code>select</code> function to select the columns that you want to retain, for example:</p><pre class="r hljs"><code class="r" data-origin="<pre><code class=&quot;r&quot;># as above, but select desired columns from data
expert_warned &amp;lt;- inner_join(pfizer, fda, by=c(&quot;first_name&quot; = &quot;name_first&quot;, &quot;last_name&quot; = &quot;name_last&quot;)) %&amp;gt;%
  filter(category==&quot;Expert-Led Forums&quot;) %&amp;gt;%
  select(first_plus, last_name, city, state, total, issued)

expert_warned &amp;lt;- inner_join(pfizer, fda, by=c(&quot;first_name&quot; = &quot;name_first&quot;, &quot;last_name&quot; = &quot;name_last&quot;)) %&amp;gt;%
  filter(category==&quot;Expert-Led Forums&quot;) %&amp;gt;%
  select(2:5,10,12)
</code></pre>"><span class="hljs-comment"># as above, but select desired columns from data</span>
expert_warned &lt;- inner_join(pfizer, fda, by=c(<span class="hljs-string">"first_name"</span> = <span class="hljs-string">"name_first"</span>, <span class="hljs-string">"last_name"</span> = <span class="hljs-string">"name_last"</span>)) %&gt;%
  filter(category==<span class="hljs-string">"Expert-Led Forums"</span>) %&gt;%
  select(first_plus, last_name, city, state, total, issued)

expert_warned &lt;- inner_join(pfizer, fda, by=c(<span class="hljs-string">"first_name"</span> = <span class="hljs-string">"name_first"</span>, <span class="hljs-string">"last_name"</span> = <span class="hljs-string">"name_last"</span>)) %&gt;%
  filter(category==<span class="hljs-string">"Expert-Led Forums"</span>) %&gt;%
  select(<span class="hljs-number">2</span>:<span class="hljs-number">5</span>,<span class="hljs-number">10</span>,<span class="hljs-number">12</span>)
</code></pre><p>Notice that you can select by columns’ names, or by their positions, where     <code>1</code>    is the first column, <code>3</code> is the third, and so on.</p><p><a href="http://stat545-ubc.github.io/bit001_dplyr-cheatsheet.html">Here is a useful reference</a> for managing joins with <strong>dplyr</strong>.</p><h3 id="further-reading"><a name="further-reading" href="#further-reading"></a>Further reading</h3><p><strong><a href="https://cran.rstudio.com/web/packages/dplyr/vignettes/introduction.html">Introduction to dplyr</a></strong></p><p><strong><a href="https://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf">RStudio Data Wrangling Cheet Sheet</a></strong><br>Also introduces the <a href="https://blog.rstudio.org/2014/07/22/introducing-tidyr/">tidyr</a> package, which can manage wide-to-long transformations, among other data manipulations.</p><p><strong><a href="http://stackoverflow.com/">Stack Overflow</a></strong><br>For any work involving code, this question-and-answer site is a great resource for when you get stuck, to see how others have solved similar problems. Search the site, or <a href="http://stackoverflow.com/questions/tagged/r">browse R questions</a></p>

<footer style="position:fixed; font-size:.8em; text-align:right; bottom:0px; margin-left:-25px; height:20px; width:100%;">generated by <a href="http://pad.haroopress.com" target="_blank">haroopad</a></footer>
</body>
</html>
