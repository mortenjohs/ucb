library(dplyr)
library(readr)
library(rvest)
library(rgdal)
install.packages("rgdal")
library(rgdal)
detach("package:rgdal", unload=TRUE)
library(rgdal)
detach("package:rgdal", unload=TRUE)
library(rgdal)
load("/Volumes/MyBook2/data2016/planes_filtering_invest.RData")
library(dplyr)
library(readr)
library(rvest)
library(rgdal)
library(rgeos)
plot(nyc_buffer)
plot(nyc_depart, add=TRUE)
plot(nyc_depart)
plot(nyc_buffer, add=TRUE)
plot(nyc_buffer, add=TRUE, color=red)
plot(nyc_buffer, add=TRUE, color="red")
plot(nyc_buffer, add=TRUE, col="red")
plot(nyc_buffer, col="red", add=TRUE)
plot(nyc_depart, col="red")
plot(nyc_buffer, col="red")
plot(nyc_buffer, col="blue", add=TRUE)
plot(nyc_depart, col="red")
plot(nyc_buffer, col="blue", add=TRUE)
writeOGR(nyc_depart, "day", "day", driver="ESRI Shapefile" )
nyc_depart@data$flight_id <- as.character(nyc_depart@data$flight_id)
writeOGR(nyc_depart, "day", "day", driver="ESRI Shapefile" )
writeOGR(nyc_depart, "day", "day", driver="ESRI Shapefile" )
writeOGR(nyc_buffer, "nyc", "nyc", driver="ESRI Shapefile" )
plot(nyc_depart, col="red", axes=TRUE)
str(nyc_depart)
airports <- readOGR("ne_50m_airports", "ne_50m_airports")
airports@proj4string
day <- SpatialPointsDataFrame(coords = xy, data = day, proj4string = CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
plot(nyc_buffer, col="blue", axes=TRUE)
airports <- spTransform(airports, CRS( "+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs" ) )
airports@proj4string
nas_buffer <- spTransform(nas_buffer, CRS( "+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0" ) )
a
nas_buffer@proj4string
nyc_buffer <- spTransform(nyc_buffer, CRS( "+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0" ) )
nyc_buffer@proj4string
nyc_planes <- raster::intersect(nyc_buffer,day)
day <- as.data.frame(day)
day <- SpatialPointsDataFrame(coords = xy, data = day, proj4string = CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
nyc_depart <- day [which(grepl("JFK|EWR|LGA|ISP|SWF|TTN|HPN|TEB|HWV|FOK", day@data$schd_from)),]
nyc_arrive <- day [which(grepl("JFK|EWR|LGA|ISP|SWF|TTN|HPN|TEB|HWV|FOK", day@data$schd_to)|grepl("JFK|EWR|LGA|ISP|SWF|TTN|HPN|TEB|HWV|FOK", day@data$real_to)),]
nas_depart <- day [which(grepl("NAS", day@data$schd_from)),]
nas_arrive <- day [which(grepl("NAS", day@data$schd_to)|grepl("NAS", day@data$real_to)),]
save.image("/Volumes/MyBook2/data2016/planes_filtering_invest.RData")
nyc_planes <- raster::intersect(day,nyc_buffer)
plot(nyc_buffer, axes=TRUE)
plot(nyc_planes, col="red", add=TRUE)
plot(nyc_planes, axes=TRUE)
nyc_planes <- gIntersection(day, nyc_buffer, byid = TRUE, drop_lower_td = TRUE)
nyc_planes <- day[nyc_buffer, ]
nyc_planes <- day[nyc_buffer, ]
plot(nyc_planes, col="red", add=TRUE)
nyc_buffer@proj4string
nas_buffer@proj4string
n <- 0
n <- 0
for (file in file_list) {
day <- read_csv(paste0("csv_days/",file)) %>%
mutate(flight_id=as.hexmode(flight_id),
timestamp=as.character(as.POSIXct(snapshot_id, origin="1970-01-01", tz="UTC")),
vspeed="",
onground="")
print(paste0("processing file ",n," of ",length(file_list)))
day <- as.data.frame(day)
xy <- day[,c(16,15)]
day <- SpatialPointsDataFrame(coords = xy, data = day, proj4string = CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
nyc_depart <- day [which(grepl("JFK|EWR|LGA|ISP|SWF|TTN|HPN|TEB|HWV|FOK", day@data$schd_from)),]
nyc_arrive <- day [which(grepl("JFK|EWR|LGA|ISP|SWF|TTN|HPN|TEB|HWV|FOK", day@data$schd_to)|grepl("JFK|EWR|LGA|ISP|SWF|TTN|HPN|TEB|HWV|FOK", day@data$real_to)),]
nas_depart <- day [which(grepl("NAS", day@data$schd_from)),]
nas_arrive <- day [which(grepl("NAS", day@data$schd_to)|grepl("NAS", day@data$real_to)),]
nyc_planes <- day[nyc_buffer, ]
nas_planes <- day[nas_buffer, ]
nyc_depart <- as.data.frame(nyc_depart)
nyc_arrive <- as.data.frame(nyc_arrive)
nas_depart <- as.data.frame(nas_depart)
nas_arrive <- as.data.frame(nas_arrive)
nyc_planes <- as.data.frame(nyc_planes)
nas_planes <- as.data.frame(nas_planes)
write_csv(nyc_depart, paste0("output/",nyc_depart,".csv"), na="", append = TRUE)
write_csv(nyc_arrive, paste0("output/",nyc_arrive,".csv"), na="", append = TRUE)
write_csv(nas_depart, paste0("output/",nas_depart,".csv"), na="", append = TRUE)
write_csv(nas_arrive, paste0("output/",nas_arrive,".csv"), na="", append = TRUE)
write_csv(nyc_planes, paste0("output/",nyc_planes,".csv"), na="", append = TRUE)
write_csv(nas_planes, paste0("output/",nas_planes,".csv"), na="", append = TRUE)
}
write_csv(nyc_depart, paste0("output/",nyc_depart,".csv"), na="", append = TRUE)
write_csv(nyc_depart, "output/nyc_depart.csv", na="", append = TRUE)
nyc_onground <- bind_rows(nyc_depart,nyc_arrive)
nyc_onground <- nyc_onground[nyc_buffer, ]
nyc_onground <- nyc_onground[nyc_buffer, ]
nyc_depart <- day [which(grepl("JFK|EWR|LGA|ISP|SWF|TTN|HPN|TEB|HWV|FOK", day@data$schd_from)),]
nyc_arrive <- day [which(grepl("JFK|EWR|LGA|ISP|SWF|TTN|HPN|TEB|HWV|FOK", day@data$schd_to)|grepl("JFK|EWR|LGA|ISP|SWF|TTN|HPN|TEB|HWV|FOK", day@data$real_to)),]
nas_depart <- day [which(grepl("NAS", day@data$schd_from)),]
nas_arrive <- day [which(grepl("NAS", day@data$schd_to)|grepl("NAS", day@data$real_to)),]
nyc_planes <- nyc_depart[nyc_buffer, ]
nyc_arrive <- nyc_arrive[nyc_buffer, ]
nyc_depart <- day [which(grepl("JFK|EWR|LGA|ISP|SWF|TTN|HPN|TEB|HWV|FOK", day@data$schd_from)),]
nyc_depart2 <- nyc_depart[nyc_buffer, ]
nyc_arrive <- day [which(grepl("JFK|EWR|LGA|ISP|SWF|TTN|HPN|TEB|HWV|FOK", day@data$schd_to)|grepl("JFK|EWR|LGA|ISP|SWF|TTN|HPN|TEB|HWV|FOK", day@data$real_to)),]
nyc_arrive2 <- nyc_arrive[nyc_buffer, ]
nas_depart <- day [which(grepl("NAS", day@data$schd_from)),]
nas_arrive <- day [which(grepl("NAS", day@data$schd_to)|grepl("NAS", day@data$real_to)),]
nyc_planes <- day[nyc_buffer, ]
nas_planes <- day[nas_buffer, ]
nyc_depart <- as.data.frame(nyc_depart)
nyc_arrive <- as.data.frame(nyc_arrive)
nas_depart <- as.data.frame(nas_depart)
nas_arrive <- as.data.frame(nas_arrive)
nyc_planes <- as.data.frame(nyc_planes)
nas_planes <- as.data.frame(nas_planes)
nyc_depart2 <- as.data.frame(nyc_depart2)
nyc_arrive2 <- as.data.frame(nyc_arrive2)
nyc_onground <- bind_rows(nyc_depart2,nyc_arrive2)
nyc_planes <- anti_join(nyc_planes,nyc_onground)
n <- 0
for (file in file_list) {
day <- read_csv(paste0("csv_days/",file)) %>%
mutate(flight_id=as.hexmode(flight_id),
timestamp=as.character(as.POSIXct(snapshot_id, origin="1970-01-01", tz="UTC")),
vspeed="",
onground="")
print(paste0("processing file ",n," of ",length(file_list)))
day <- as.data.frame(day)
xy <- day[,c(16,15)]
day <- SpatialPointsDataFrame(coords = xy, data = day, proj4string = CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
nyc_depart <- day [which(grepl("JFK|EWR|LGA|ISP|SWF|TTN|HPN|TEB|HWV|FOK", day@data$schd_from)),]
nyc_depart2 <- nyc_depart[nyc_buffer, ]
nyc_arrive <- day [which(grepl("JFK|EWR|LGA|ISP|SWF|TTN|HPN|TEB|HWV|FOK", day@data$schd_to)|grepl("JFK|EWR|LGA|ISP|SWF|TTN|HPN|TEB|HWV|FOK", day@data$real_to)),]
nyc_arrive2 <- nyc_arrive[nyc_buffer, ]
nas_depart <- day [which(grepl("NAS", day@data$schd_from)),]
nas_arrive <- day [which(grepl("NAS", day@data$schd_to)|grepl("NAS", day@data$real_to)),]
nyc_planes <- day[nyc_buffer, ]
nas_planes <- day[nas_buffer, ]
nyc_depart <- as.data.frame(nyc_depart)
nyc_arrive <- as.data.frame(nyc_arrive)
nas_depart <- as.data.frame(nas_depart)
nas_arrive <- as.data.frame(nas_arrive)
nyc_planes <- as.data.frame(nyc_planes)
nas_planes <- as.data.frame(nas_planes)
nyc_depart2 <- as.data.frame(nyc_depart2)
nyc_arrive2 <- as.data.frame(nyc_arrive2)
nyc_onground <- bind_rows(nyc_depart2,nyc_arrive2)
nyc_planes <- anti_join(nyc_planes,nyc_onground)
write_csv(nyc_depart, "output/nyc_depart.csv", na="", append = TRUE)
write_csv(nyc_arrive, "output/nyc_arrive.csv", na="", append = TRUE)
write_csv(nas_depart, "output/nas_depart.csv", na="", append = TRUE)
write_csv(nas_arrive, "output/nas_arrive.csv", na="", append = TRUE)
write_csv(nyc_planes, "output/nyc_planes.csv", na="", append = TRUE)
write_csv(nas_planes, "output/nas_planes.csv", na="", append = TRUE)
}
n <- 1
for (file in file_list) {
day <- read_csv(paste0("csv_days/",file)) %>%
mutate(flight_id=as.hexmode(flight_id),
timestamp=as.character(as.POSIXct(snapshot_id, origin="1970-01-01", tz="UTC")),
vspeed="",
onground="")
print(paste0("processing file ",n," of ",length(file_list)))
day <- as.data.frame(day)
xy <- day[,c(16,15)]
day <- SpatialPointsDataFrame(coords = xy, data = day, proj4string = CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
nyc_depart <- day [which(grepl("JFK|EWR|LGA|ISP|SWF|TTN|HPN|TEB|HWV|FOK", day@data$schd_from)),]
nyc_arrive <- day [which(grepl("JFK|EWR|LGA|ISP|SWF|TTN|HPN|TEB|HWV|FOK", day@data$schd_to)|grepl("JFK|EWR|LGA|ISP|SWF|TTN|HPN|TEB|HWV|FOK", day@data$real_to)),]
nas_depart <- day [which(grepl("NAS", day@data$schd_from)),]
nas_arrive <- day [which(grepl("NAS", day@data$schd_to)|grepl("NAS", day@data$real_to)),]
nyc_planes <- day[nyc_buffer, ]
nas_planes <- day[nas_buffer, ]
nyc_depart <- as.data.frame(nyc_depart)
nyc_arrive <- as.data.frame(nyc_arrive)
nas_depart <- as.data.frame(nas_depart)
nas_arrive <- as.data.frame(nas_arrive)
nyc_planes <- as.data.frame(nyc_planes)
nas_planes <- as.data.frame(nas_planes)
write_csv(nyc_depart, "output/nyc_depart.csv", na="", append = TRUE)
write_csv(nyc_arrive, "output/nyc_arrive.csv", na="", append = TRUE)
write_csv(nas_depart, "output/nas_depart.csv", na="", append = TRUE)
write_csv(nas_arrive, "output/nas_arrive.csv", na="", append = TRUE)
write_csv(nyc_planes, "output/nyc_planes.csv", na="", append = TRUE)
write_csv(nas_planes, "output/nas_planes.csv", na="", append = TRUE)
}
save.image("/Volumes/MyBook2/data2016/planes_filtering_invest.RData")
save.image("/Volumes/MyBook2/data2016/planes_filtering_invest.RData")
setwd("/Volumes/MyBook2/data2016")
library(readr)
library(dplyr)
library(tidyr)
library(lubridate)
library(kwgeo)
library(dbplyr)
library(RPostgreSQL)
library(rpostgis)
library(rgeos)
library(googledrive)
myRedshift <- DBI::dbConnect(RPostgreSQL::PostgreSQL(),
"adsbx",
host = "redshift.adsbexchange.com",
port = 5439,
user = "paldhous",
password = "Pa913756")
# create table references
aircraft <- tbl(myRedshift, "aircraft")
position <- tbl(myRedshift, "position")
load("/Users/peteraldhous/SpiderOak Hive/migrant/migrant.RData")
uk_adsb <- aircraft %>%
filter(country == "United Kingdom") %>%
collect()
uk_adsb <- aircraft %>%
filter(country == "United Kingdom") %>%
collect()
myRedshift <- DBI::dbConnect(RPostgreSQL::PostgreSQL(),
"adsbx",
host = "redshift.adsbexchange.com",
port = 5439,
user = "paldhous",
password = "Pa913756")
# create table references
aircraft <- tbl(myRedshift, "aircraft")
position <- tbl(myRedshift, "position")
uk_adsb <- aircraft %>%
filter(country == "United Kingdom") %>%
collect()
View(us_adsb)
uk_owners <- uk_adsb %>%
group_by(registeredowners) %>%
summarize(count = n())
View(uk_owners)
uk_cands <- uk_adsb %>%
filter(grepl("Italian Air Force|Royal Air Force|Royal Navy|Bristow Helicopters"))
uk_cands <- uk_adsb %>%
filter(grepl("Italian Air Force|Royal Air Force|Royal Navy|Bristow Helicopters",registeredowners))
View(uk_cands)
uk_cands <- uk_adsb %>%
filter(grepl("Italian Air Force|Royal Air Force|Royal Navy|Bristow Helicopters",registeredowners)) %>%
inner_join(position) %>%
collect(Inf) %>%
filter(lat >= 20 & lat <= 44 & long >= 0 & long <= 38)  %>%
mutate(utc_timestamp=as.POSIXct(postime/1000, origin = "1970-01-01"))
uk_cands <- uk_adsb %>%
filter(grepl("Italian Air Force|Royal Air Force|Royal Navy|Bristow Helicopters",registeredowners)) %>%
inner_join(position, by=c("icao" = "_id")) %>%
collect(Inf) %>%
filter(lat >= 20 & lat <= 44 & long >= 0 & long <= 38)  %>%
mutate(utc_timestamp=as.POSIXct(postime/1000, origin = "1970-01-01"))
uk_cands <- uk_adsb %>%
filter(grepl("Italian Air Force|Royal Air Force|Royal Navy|Bristow Helicopters",registeredowners)) %>%
inner_join(position, by=c("_id" = "icao")) %>%
collect(Inf) %>%
filter(lat >= 20 & lat <= 44 & long >= 0 & long <= 38)  %>%
mutate(utc_timestamp=as.POSIXct(postime/1000, origin = "1970-01-01"))
uk_cands <- uk_adsb %>%
filter(grepl("Italian Air Force|Royal Air Force|Royal Navy|Bristow Helicopters",registeredowners)) %>%
inner_join(position, by=c("_id" = "icao"), copy = TRUE) %>%
collect(Inf) %>%
filter(lat >= 20 & lat <= 44 & long >= 0 & long <= 38)  %>%
mutate(utc_timestamp=as.POSIXct(postime/1000, origin = "1970-01-01"))
uk_adsb <- aircraft %>%
filter(country == "United Kingdom") %>%
collect()
myRedshift <- DBI::dbConnect(RPostgreSQL::PostgreSQL(),
"adsbx",
host = "redshift.adsbexchange.com",
port = 5439,
user = "paldhous",
password = "Pa913756")
# create table references
aircraft <- tbl(myRedshift, "aircraft")
position <- tbl(myRedshift, "position")
uk_cands <- uk_adsb %>%
filter(grepl("Italian Air Force|Royal Air Force|Royal Navy|Bristow Helicopters",registeredowners)) %>%
inner_join(position, by=c("_id" = "icao"), copy = TRUE) %>%
collect(Inf) %>%
filter(lat >= 20 & lat <= 44 & long >= 0 & long <= 38)  %>%
mutate(utc_timestamp=as.POSIXct(postime/1000, origin = "1970-01-01"))
uk_adsb <- aircraft %>%
filter(country == "United Kingdom") %>%
collect()
myRedshift <- DBI::dbConnect(RPostgreSQL::PostgreSQL(),
"adsbx",
host = "redshift.adsbexchange.com",
port = 5439,
user = "paldhous",
password = "Pa913756")
# create table references
aircraft <- tbl(myRedshift, "aircraft")
position <- tbl(myRedshift, "position")
uk_adsb <- aircraft %>%
filter(country == "United Kingdom") %>%
collect()
myRedshift <- DBI::dbConnect(RPostgreSQL::PostgreSQL(),
"adsbx",
host = "redshift.adsbexchange.com",
port = 5439,
user = "paldhous",
password = "Pa913756")
# create table references
aircraft <- tbl(myRedshift, "aircraft")
position <- tbl(myRedshift, "position")
test <- collect(head(aircraft))
test <- collect(head(position))
uk_cands <- uk_adsb %>%
filter(grepl("Italian Air Force|Royal Air Force|Royal Navy|Bristow Helicopters",registeredowners)) %>%
inner_join(position, by=c("_id" = "icao")) %>%
collect(n = Inf) %>%
filter(lat >= 20 & lat <= 44 & long >= 0 & long <= 38)  %>%
mutate(utc_timestamp=as.POSIXct(postime/1000, origin = "1970-01-01"))
uk_cands <- uk_adsb %>%
filter(grepl("Italian Air Force|Royal Air Force|Royal Navy|Bristow Helicopters",registeredowners)) %>%
inner_join(position, by=c("_id" = "icao", copy = T)) %>%
collect(n = Inf) %>%
filter(lat >= 20 & lat <= 44 & long >= 0 & long <= 38)  %>%
mutate(utc_timestamp=as.POSIXct(postime/1000, origin = "1970-01-01"))
View(uk_cands)
uk_cands <- uk_adsb %>%
filter(grepl("Italian Air Force|Royal Air Force|Royal Navy|Bristow Helicopters",registeredowners)) %>%
inner_join(position, by=c("modes" = "icao", copy = T)) %>%
collect(n = Inf) %>%
filter(lat >= 20 & lat <= 44 & long >= 0 & long <= 38)  %>%
mutate(utc_timestamp=as.POSIXct(postime/1000, origin = "1970-01-01"))
View(test)
str(uk_cands)
uk_cands <- uk_adsb %>%
filter(grepl("Italian Air Force|Royal Air Force|Royal Navy|Bristow Helicopters",registeredowners)) %>%
inner_join(position, by=c("modes" = "icao"), copy = T) %>%
collect(n = Inf) %>%
filter(lat >= 20 & lat <= 44 & long >= 0 & long <= 38)  %>%
mutate(utc_timestamp=as.POSIXct(postime/1000, origin = "1970-01-01"))
uk_cands <- uk_adsb %>%
filter(grepl("Italian Air Force|Royal Air Force|Royal Navy|Bristow Helicopters",registeredowners)) %>%
inner_join(position, by=c("modes" = "icao"), copy = T) %>%
collect(n = Inf)
myRedshift <- DBI::dbConnect(RPostgreSQL::PostgreSQL(),
"adsbx",
host = "redshift.adsbexchange.com",
port = 5439,
user = "paldhous",
password = "Pa913756")
aircraft <- tbl(myRedshift, "aircraft")
position <- tbl(myRedshift, "position")
uk_cands <- uk_adsb %>%
filter(grepl("Italian Air Force|Royal Air Force|Royal Navy|Bristow Helicopters",registeredowners)) %>%
inner_join(position, by=c("modes" = "icao"), copy = T) %>%
collect(n = Inf)
uk_cands <- uk_adsb %>%
filter(grepl("Italian Air Force|Royal Air Force|Royal Navy|Bristow Helicopters",registeredowners)) %>%
inner_join(position, by=c("modes" = "icao"), copy = T) %>%
collect()
# new version dbplyr
myRedshift <- DBI::dbConnect(RPostgreSQL::PostgreSQL(),
"adsbx",
host = "redshift.adsbexchange.com",
port = 5439,
user = "paldhous",
password = "Pa913756")
# create table references
aircraft <- tbl(myRedshift, "aircraft")
position <- tbl(myRedshift, "position")
uk_cands <- uk_adsb %>%
filter(grepl("Italian Air Force|Royal Air Force|Royal Navy|Bristow Helicopters",registeredowners)) %>%
inner_join(position, by=c("modes" = "icao"), copy = T) %>%
collect()
italy_owners <- italy_adsb %>%
group_by(registeredowners) %>%
summarize(count = n())
View(italy_owners)
# new version dbplyr
myRedshift <- DBI::dbConnect(RPostgreSQL::PostgreSQL(),
"adsbx",
host = "redshift.adsbexchange.com",
port = 5439,
user = "paldhous",
password = "Pa913756")
# create table references
aircraft <- tbl(myRedshift, "aircraft")
position <- tbl(myRedshift, "position")
italy_cands <- italy_adsb %>%
filter(grepl("Italian",registeredowners)) %>%
inner_join(position, by=c("modes" = "icao"), copy = T) %>%
collect() %>%
filter(lat >= 20 & lat <= 44 & long >= 0 & long <= 38)  %>%
mutate(utc_timestamp=as.POSIXct(postime/1000, origin = "1970-01-01"))
myRedshift <- DBI::dbConnect(RPostgreSQL::PostgreSQL(),
"adsbx",
host = "redshift.adsbexchange.com",
port = 5439,
user = "paldhous",
password = "Pa913756")
# create table references
aircraft <- tbl(myRedshift, "aircraft")
position <- tbl(myRedshift, "position")
italy_adsb <- aircraft %>%
filter(country == "Italy") %>%
collect()
belgium_owners <- belgium_adsb %>%
group_by(registeredowners) %>%
summarize(count = n())
View(belgium_owners)
spain_owners <- spain_adsb %>%
group_by(registeredowners) %>%
summarize(count = n())
View(spain_owners)
france_owners <- france_adsb %>%
group_by(registeredowners) %>%
summarize(count = n())
View(france_owners)
neth_owners <- neth_adsb %>%
group_by(registeredowners) %>%
summarize(count = n())
View(neth_owners)
save.image("~/SpiderOak Hive/migrant/migrant.RData")
myRedshift <- DBI::dbConnect(RPostgreSQL::PostgreSQL(),
"adsbx",
host = "redshift.adsbexchange.com",
port = 5439,
user = "paldhous",
password = "Pa913756")
# create table references
aircraft <- tbl(myRedshift, "aircraft")
position <- tbl(myRedshift, "position")
italy_cands <- italy_adsb %>%
filter(grepl("Italian",registeredowners)) %>%
inner_join(position, by=c("modes" = "icao"), copy = T) %>%
collect() %>%
filter(lat >= 20 & lat <= 44 & long >= 0 & long <= 38)  %>%
mutate(utc_timestamp=as.POSIXct(postime/1000, origin = "1970-01-01"))
# new version dbplyr
myRedshift <- DBI::dbConnect(RPostgreSQL::PostgreSQL(),
"adsbx",
host = "redshift.adsbexchange.com",
port = 5439,
user = "paldhous",
password = "Pa913756")
# create table references
aircraft <- tbl(myRedshift, "aircraft")
position <- tbl(myRedshift, "position")
uk_cands <- uk_adsb %>%
filter(grepl("Italian Air Force|Royal Air Force|Royal Navy|Bristow Helicopters",registeredowners)) %>%
inner_join(position, by=c("modes" = "icao"), copy = T) %>%
collect(n = Inf) %>%
filter(lat >= 20 & lat <= 44 & long >= 0 & long <= 38)  %>%
mutate(utc_timestamp=as.POSIXct(postime/1000, origin = "1970-01-01"))
# new version dbplyr
myRedshift <- DBI::dbConnect(RPostgreSQL::PostgreSQL(),
"adsbx",
host = "redshift.adsbexchange.com",
port = 5439,
user = "paldhous",
password = "Pa913756")
# create table references
aircraft <- tbl(myRedshift, "aircraft")
position <- tbl(myRedshift, "position")
uk_adsb <- aircraft %>%
filter(country == "United Kingdom") %>%
collect()
save.image("~/SpiderOak Hive/migrant/migrant.RData")
install.packages("tidyverse")
# load required packages
library(dplyr)
library(readr)
library(ggplot2)
library(scales)
library(readxl)
library(plotly)
# food stamps
# import food stamps data
food_stamps <- read_excel("SNAPsummary.xls", sheet=1, skip=5)
names(food_stamps) <- c(1:6)
food_stamps <- food_stamps %>%
select(1,2,6)
names(food_stamps) <- c("year","participants","costs")
food_stamps <- food_stamps %>%
filter(!is.na(participants)) %>%
mutate(participants = participants * 1000,
year = as.integer(year))
# charts
ggplot(food_stamps, aes(x=year, y=participants/1000000)) +
geom_bar(stat = "identity", fill = "red", color = "white") +
xlab("") +
ylab("Participants (millions)") +
# scale_x_continuous(breaks = c(1970,1980,1990,2000,2010)) +
scale_y_continuous(limits = c(0,50)) +
theme_minimal(base_size = 14, base_family = "Georgia") +
ggtitle("Column chart")
setwd("~/SpiderOak Hive/raw-data/week2")
plot
food_stamps <- read_excel("SNAPsummary.xls", sheet=1, skip=5)
names(food_stamps) <- c(1:6)
food_stamps <- food_stamps %>%
select(1,2,6)
names(food_stamps) <- c("year","participants","costs")
food_stamps <- food_stamps %>%
filter(!is.na(participants)) %>%
mutate(participants = participants * 1000,
year = as.integer(year))
ggplot(food_stamps, aes(x=year, y=participants/1000000)) +
geom_bar(stat = "identity", fill = "red", color = "white") +
xlab("") +
ylab("Participants (millions)") +
# scale_x_continuous(breaks = c(1970,1980,1990,2000,2010)) +
scale_y_continuous(limits = c(0,50)) +
theme_minimal(base_size = 14, base_family = "Georgia") +
ggtitle("Column chart")
