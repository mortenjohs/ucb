<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>class9.html</title>
  <meta name="generator" content="Haroopad 0.13.1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>div.oembedall-githubrepos{border:1px solid #DDD;border-radius:4px;list-style-type:none;margin:0 0 10px;padding:8px 10px 0;font:13.34px/1.4 helvetica,arial,freesans,clean,sans-serif;width:452px;background-color:#fff}div.oembedall-githubrepos .oembedall-body{background:-moz-linear-gradient(center top,#FAFAFA,#EFEFEF);background:-webkit-gradient(linear,left top,left bottom,from(#FAFAFA),to(#EFEFEF));border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-top:1px solid #EEE;margin-left:-10px;margin-top:8px;padding:5px 10px;width:100%}div.oembedall-githubrepos h3{font-size:14px;margin:0;padding-left:18px;white-space:nowrap}div.oembedall-githubrepos p.oembedall-description{color:#444;font-size:12px;margin:0 0 3px}div.oembedall-githubrepos p.oembedall-updated-at{color:#888;font-size:11px;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats{border:none;float:right;font-size:11px;font-weight:700;padding-left:15px;position:relative;z-index:5;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats li{border:none;color:#666;display:inline-block;list-style-type:none;margin:0!important}div.oembedall-githubrepos ul.oembedall-repo-stats li a{background-color:transparent;border:none;color:#666!important;background-position:5px -2px;background-repeat:no-repeat;border-left:1px solid #DDD;display:inline-block;height:21px;line-height:21px;padding:0 5px 0 23px}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a{border-left:medium none;margin-right:-3px}div.oembedall-githubrepos ul.oembedall-repo-stats li a:hover{background:5px -27px no-repeat #4183C4;color:#FFF!important;text-decoration:none}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a:hover{border-bottom-left-radius:3px;border-top-left-radius:3px}ul.oembedall-repo-stats li:last-child a:hover{border-bottom-right-radius:3px;border-top-right-radius:3px}span.oembedall-closehide{background-color:#aaa;border-radius:2px;cursor:pointer;margin-right:3px}div.oembedall-container{margin-top:5px;text-align:left}.oembedall-ljuser{font-weight:700}.oembedall-ljuser img{vertical-align:bottom;border:0;padding-right:1px}.oembedall-stoqembed{border-bottom:1px dotted #999;float:left;overflow:hidden;width:730px;line-height:1;background:#FFF;color:#000;font-family:Arial,Liberation Sans,DejaVu Sans,sans-serif;font-size:80%;text-align:left;margin:0;padding:0}.oembedall-stoqembed a{color:#07C;text-decoration:none;margin:0;padding:0}.oembedall-stoqembed a:hover{text-decoration:underline}.oembedall-stoqembed a:visited{color:#4A6B82}.oembedall-stoqembed h3{font-family:Trebuchet MS,Liberation Sans,DejaVu Sans,sans-serif;font-size:130%;font-weight:700;margin:0;padding:0}.oembedall-stoqembed .oembedall-reputation-score{color:#444;font-size:120%;font-weight:700;margin-right:2px}.oembedall-stoqembed .oembedall-user-info{height:35px;width:185px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-gravatar32{float:left;height:32px;width:32px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-details{float:left;margin-left:5px;overflow:hidden;white-space:nowrap;width:145px}.oembedall-stoqembed .oembedall-question-hyperlink{font-weight:700}.oembedall-stoqembed .oembedall-stats{background:#EEE;margin:0 0 0 7px;padding:4px 7px 6px;width:58px}.oembedall-stoqembed .oembedall-statscontainer{float:left;margin-right:8px;width:86px}.oembedall-stoqembed .oembedall-votes{color:#555;padding:0 0 7px;text-align:center}.oembedall-stoqembed .oembedall-vote-count-post{font-size:240%;color:#808185;display:block;font-weight:700}.oembedall-stoqembed .oembedall-views{color:#999;padding-top:4px;text-align:center}.oembedall-stoqembed .oembedall-status{margin-top:-3px;padding:4px 0;text-align:center;background:#75845C;color:#FFF}.oembedall-stoqembed .oembedall-status strong{color:#FFF;display:block;font-size:140%}.oembedall-stoqembed .oembedall-summary{float:left;width:635px}.oembedall-stoqembed .oembedall-excerpt{line-height:1.2;margin:0;padding:0 0 5px}.oembedall-stoqembed .oembedall-tags{float:left;line-height:18px}.oembedall-stoqembed .oembedall-tags a:hover{text-decoration:none}.oembedall-stoqembed .oembedall-post-tag{background-color:#E0EAF1;border-bottom:1px solid #3E6D8E;border-right:1px solid #7F9FB6;color:#3E6D8E;font-size:90%;line-height:2.4;margin:2px 2px 2px 0;padding:3px 4px;text-decoration:none;white-space:nowrap}.oembedall-stoqembed .oembedall-post-tag:hover{background-color:#3E6D8E;border-bottom:1px solid #37607D;border-right:1px solid #37607D;color:#E0EAF1}.oembedall-stoqembed .oembedall-fr{float:right}.oembedall-stoqembed .oembedall-statsarrow{background-image:url(http://cdn.sstatic.net/stackoverflow/img/sprites.png?v=3);background-repeat:no-repeat;overflow:hidden;background-position:0 -435px;float:right;height:13px;margin-top:12px;width:7px}.oembedall-facebook1{border:1px solid #1A3C6C;padding:0;font:13.34px/1.4 verdana;width:500px}.oembedall-facebook2{background-color:#627add}.oembedall-facebook2 a{color:#e8e8e8;text-decoration:none}.oembedall-facebookBody{background-color:#fff;vertical-align:top;padding:5px}.oembedall-facebookBody .contents{display:inline-block;width:100%}.oembedall-facebookBody div img{float:left;margin-right:5px}div.oembedall-lanyard{-webkit-box-shadow:none;-webkit-transition-delay:0s;-webkit-transition-duration:.4000000059604645s;-webkit-transition-property:width;-webkit-transition-timing-function:cubic-bezier(0.42,0,.58,1);background-attachment:scroll;background-clip:border-box;background-color:transparent;background-image:none;background-origin:padding-box;border-width:0;box-shadow:none;color:#112644;display:block;float:left;font-family:'Trebuchet MS',Trebuchet,sans-serif;font-size:16px;height:253px;line-height:19px;margin:0;max-width:none;min-height:0;outline:#112644 0;overflow-x:visible;overflow-y:visible;padding:0;position:relative;text-align:left;vertical-align:baseline;width:804px}div.oembedall-lanyard .tagline{font-size:1.5em}div.oembedall-lanyard .wrapper{overflow:hidden;clear:both}div.oembedall-lanyard .split{float:left;display:inline}div.oembedall-lanyard .prominent-place .flag:active,div.oembedall-lanyard .prominent-place .flag:focus,div.oembedall-lanyard .prominent-place .flag:hover,div.oembedall-lanyard .prominent-place .flag:link,div.oembedall-lanyard .prominent-place .flag:visited{float:left;display:block;width:48px;height:48px;position:relative;top:-5px;margin-right:10px}div.oembedall-lanyard .place-context{font-size:.889em}div.oembedall-lanyard .prominent-place .sub-place{display:block}div.oembedall-lanyard .prominent-place{font-size:1.125em;line-height:1.1em;font-weight:400}div.oembedall-lanyard .main-date{color:#8CB4E0;font-weight:700;line-height:1.1}div.oembedall-lanyard .first{width:48.57%;margin:0 0 0 2.857%}.mermaid .label{color:#333}.node circle,.node polygon,.node rect{fill:#cde498;stroke:#13540c;stroke-width:1px}.edgePath .path{stroke:green;stroke-width:1.5px}.cluster rect{fill:#cdffb2;rx:40;stroke:#6eaa49;stroke-width:1px}.cluster text{fill:#333}.actor{stroke:#13540c;fill:#cde498}text.actor{fill:#000;stroke:none}.actor-line{stroke:grey}.messageLine0{stroke-width:1.5;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#333}.messageLine1{stroke-width:1.5;stroke-dasharray:"2 2";stroke:#333}#arrowhead{fill:#333}#crosshead path{fill:#333!important;stroke:#333!important}.messageText{fill:#333;stroke:none}.labelBox{stroke:#326932;fill:#cde498}.labelText,.loopText{fill:#000;stroke:none}.loopLine{stroke-width:2;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#326932}.note{stroke:#6eaa49;fill:#fff5ad}.noteText{fill:#000;stroke:none;font-family:'trebuchet ms',verdana,arial;font-size:14px}.section{stroke:none;opacity:.2}.section0,.section2{fill:#6eaa49}.section1,.section3{fill:#fff;opacity:.2}.sectionTitle0,.sectionTitle1,.sectionTitle2,.sectionTitle3{fill:#333}.sectionTitle{text-anchor:start;font-size:11px;text-height:14px}.grid .tick{stroke:lightgrey;opacity:.3;shape-rendering:crispEdges}.grid path{stroke-width:0}.today{fill:none;stroke:red;stroke-width:2px}.task{stroke-width:2}.taskText{text-anchor:middle;font-size:11px}.taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px}.taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}.taskText0,.taskText1,.taskText2,.taskText3{fill:#fff}.task0,.task1,.task2,.task3{fill:#487e3a;stroke:#13540c}.taskTextOutside0,.taskTextOutside1,.taskTextOutside2,.taskTextOutside3{fill:#000}.active0,.active1,.active2,.active3{fill:#cde498;stroke:#13540c}.activeText0,.activeText1,.activeText2,.activeText3{fill:#000!important}.done0,.done1,.done2,.done3{stroke:grey;fill:lightgrey;stroke-width:2}.doneText0,.doneText1,.doneText2,.doneText3{fill:#000!important}.crit0,.crit1,.crit2,.crit3{stroke:#f88;fill:red;stroke-width:2}.activeCrit0,.activeCrit1,.activeCrit2,.activeCrit3{stroke:#f88;fill:#cde498;stroke-width:2}.doneCrit0,.doneCrit1,.doneCrit2,.doneCrit3{stroke:#f88;fill:lightgrey;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}.activeCritText0,.activeCritText1,.activeCritText2,.activeCritText3,.doneCritText0,.doneCritText1,.doneCritText2,.doneCritText3{fill:#000!important}.titleText{text-anchor:middle;font-size:18px;fill:#000}text{font-family:'trebuchet ms',verdana,arial;font-size:14px}html{height:100%}body{margin:0!important;padding:5px 20px 26px!important;background-color:#fff;font-family:"Lucida Grande","Segoe UI","Apple SD Gothic Neo","Malgun Gothic","Lucida Sans Unicode",Helvetica,Arial,sans-serif;font-size:.9em;overflow-x:hidden;overflow-y:auto}br,h1,h2,h3,h4,h5,h6{clear:both}hr.page{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x;border:0;height:3px;padding:0}hr.underscore{border-top-style:dashed!important}body >:first-child{margin-top:0!important}img.plugin{box-shadow:0 1px 3px rgba(0,0,0,.1);border-radius:3px}iframe{border:0}figure{-webkit-margin-before:0;-webkit-margin-after:0;-webkit-margin-start:0;-webkit-margin-end:0}kbd{border:1px solid #aaa;-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;-moz-box-shadow:1px 2px 2px #ddd;-webkit-box-shadow:1px 2px 2px #ddd;box-shadow:1px 2px 2px #ddd;background-color:#f9f9f9;background-image:-moz-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-o-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-webkit-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:linear-gradient(top,#eee,#f9f9f9,#eee);padding:1px 3px;font-family:inherit;font-size:.85em}.oembeded .oembed_photo{display:inline-block}img[data-echo]{margin:25px 0;width:100px;height:100px;background:url(../img/ajax.gif) center center no-repeat #fff}.spinner{display:inline-block;width:10px;height:10px;margin-bottom:-.1em;border:2px solid rgba(0,0,0,.5);border-top-color:transparent;border-radius:100%;-webkit-animation:spin 1s infinite linear;animation:spin 1s infinite linear}.spinner:after{content:'';display:block;width:0;height:0;position:absolute;top:-6px;left:0;border:4px solid transparent;border-bottom-color:rgba(0,0,0,.5);-webkit-transform:rotate(45deg);transform:rotate(45deg)}@-webkit-keyframes spin{to{-webkit-transform:rotate(360deg)}}@keyframes spin{to{transform:rotate(360deg)}}p.toc{margin:0!important}p.toc ul{padding-left:10px}p.toc>ul{padding:10px;margin:0 10px;display:inline-block;border:1px solid #ededed;border-radius:5px}p.toc li,p.toc ul{list-style-type:none}p.toc li{width:100%;padding:0;overflow:hidden}p.toc li a::after{content:"."}p.toc li a:before{content:"• "}p.toc h5{text-transform:uppercase}p.toc .title{float:left;padding-right:3px}p.toc .number{margin:0;float:right;padding-left:3px;background:#fff;display:none}input.task-list-item{margin-left:-1.62em}.markdown{font-family:"Hiragino Sans GB","Microsoft YaHei",STHeiti,SimSun,"Lucida Grande","Lucida Sans Unicode","Lucida Sans",'Segoe UI',AppleSDGothicNeo-Medium,'Malgun Gothic',Verdana,Tahoma,sans-serif;padding:20px}.markdown a{text-decoration:none;vertical-align:baseline}.markdown a:hover{text-decoration:underline}.markdown h1{font-size:2.2em;font-weight:700;margin:1.5em 0 1em}.markdown h2{font-size:1.8em;font-weight:700;margin:1.275em 0 .85em}.markdown h3{font-size:1.6em;font-weight:700;margin:1.125em 0 .75em}.markdown h4{font-size:1.4em;font-weight:700;margin:.99em 0 .66em}.markdown h5{font-size:1.2em;font-weight:700;margin:.855em 0 .57em}.markdown h6{font-size:1em;font-weight:700;margin:.75em 0 .5em}.markdown h1+p,.markdown h1:first-child,.markdown h2+p,.markdown h2:first-child,.markdown h3+p,.markdown h3:first-child,.markdown h4+p,.markdown h4:first-child,.markdown h5+p,.markdown h5:first-child,.markdown h6+p,.markdown h6:first-child{margin-top:0}.markdown hr{border:1px solid #ccc}.markdown p{margin:1em 0;word-wrap:break-word}.markdown ol{list-style-type:decimal}.markdown li{display:list-item;line-height:1.4em}.markdown blockquote{margin:1em 20px}.markdown blockquote>:first-child{margin-top:0}.markdown blockquote>:last-child{margin-bottom:0}.markdown blockquote cite:before{content:'\2014 \00A0'}.markdown .code{border-radius:3px;word-wrap:break-word}.markdown pre{border-radius:3px;word-wrap:break-word;border:1px solid #ccc;overflow:auto;padding:.5em}.markdown pre code{border:0;display:block}.markdown pre>code{font-family:Consolas,Inconsolata,Courier,monospace;font-weight:700;white-space:pre;margin:0}.markdown code{border-radius:3px;word-wrap:break-word;border:1px solid #ccc;padding:0 5px;margin:0 2px}.markdown img{max-width:100%}.markdown mark{color:#000;background-color:#fcf8e3}.markdown table{padding:0;border-collapse:collapse;border-spacing:0;margin-bottom:16px}.markdown table tr td,.markdown table tr th{border:1px solid #ccc;margin:0;padding:6px 13px}.markdown table tr th{font-weight:700}.markdown table tr th>:first-child{margin-top:0}.markdown table tr th>:last-child{margin-bottom:0}.markdown table tr td>:first-child{margin-top:0}.markdown table tr td>:last-child{margin-bottom:0}.github{padding:20px;font-family:"Helvetica Neue",Helvetica,"Hiragino Sans GB","Microsoft YaHei",STHeiti,SimSun,"Segoe UI",AppleSDGothicNeo-Medium,'Malgun Gothic',Arial,freesans,sans-serif;font-size:15px;background:#fff;line-height:1.6;-webkit-font-smoothing:antialiased}.github a{color:#3269a0}.github a:hover{color:#4183c4}.github h2{border-bottom:1px solid #e6e6e6;line-height:1.6}.github h6{color:#777}.github hr{border:1px solid #e6e6e6}.github pre>code{font-size:.9em;font-family:Consolas,Inconsolata,Courier,monospace}.github blockquote>code,.github h1>code,.github h2>code,.github h3>code,.github h4>code,.github h5>code,.github h6>code,.github li>code,.github p>code,.github td>code{background-color:rgba(0,0,0,.07);font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;font-size:85%;padding:.2em .5em;border:0}.github blockquote{border-left:4px solid #e6e6e6;padding:0 15px;font-style:italic}.github table{background-color:#fafafa}.github table tr td,.github table tr th{border:1px solid #e6e6e6}.github table tr:nth-child(2n){background-color:#f2f2f2}.hljs{display:block;overflow-x:auto;padding:.5em;background:#fdf6e3;color:#657b83;-webkit-text-size-adjust:none}.diff .hljs-header,.hljs-comment,.hljs-doctype,.hljs-javadoc,.hljs-pi,.lisp .hljs-string{color:#93a1a1}.css .hljs-tag,.hljs-addition,.hljs-keyword,.hljs-request,.hljs-status,.hljs-winutils,.method,.nginx .hljs-title{color:#859900}.hljs-command,.hljs-dartdoc,.hljs-hexcolor,.hljs-link_url,.hljs-number,.hljs-phpdoc,.hljs-regexp,.hljs-rules .hljs-value,.hljs-string,.hljs-tag .hljs-value,.tex .hljs-formula{color:#2aa198}.css .hljs-function,.hljs-built_in,.hljs-chunk,.hljs-decorator,.hljs-id,.hljs-identifier,.hljs-localvars,.hljs-title,.vhdl .hljs-literal{color:#268bd2}.hljs-attribute,.hljs-class .hljs-title,.hljs-constant,.hljs-link_reference,.hljs-parent,.hljs-type,.hljs-variable,.lisp .hljs-body,.smalltalk .hljs-number{color:#b58900}.css .hljs-pseudo,.diff .hljs-change,.hljs-attr_selector,.hljs-cdata,.hljs-header,.hljs-pragma,.hljs-preprocessor,.hljs-preprocessor .hljs-keyword,.hljs-shebang,.hljs-special,.hljs-subst,.hljs-symbol,.hljs-symbol .hljs-string{color:#cb4b16}.hljs-deletion,.hljs-important{color:#dc322f}.hljs-link_label{color:#6c71c4}.tex .hljs-formula{background:#eee8d5}.MathJax_Hover_Frame{border-radius:.25em;-webkit-border-radius:.25em;-moz-border-radius:.25em;-khtml-border-radius:.25em;box-shadow:0 0 15px #83A;-webkit-box-shadow:0 0 15px #83A;-moz-box-shadow:0 0 15px #83A;-khtml-box-shadow:0 0 15px #83A;border:1px solid #A6D!important;display:inline-block;position:absolute}.MathJax_Hover_Arrow{position:absolute;width:15px;height:11px;cursor:pointer}#MathJax_About{position:fixed;left:50%;width:auto;text-align:center;border:3px outset;padding:1em 2em;background-color:#DDD;color:#000;cursor:default;font-family:message-box;font-size:120%;font-style:normal;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;border-radius:15px;-webkit-border-radius:15px;-moz-border-radius:15px;-khtml-border-radius:15px;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_Menu{position:absolute;background-color:#fff;color:#000;width:auto;padding:5px 0;border:1px solid #CCC;margin:0;cursor:default;font:menu;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;border-radius:5px;-webkit-border-radius:5px;-moz-border-radius:5px;-khtml-border-radius:5px;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_MenuItem{padding:1px 2em;background:0 0}.MathJax_MenuArrow{position:absolute;right:.5em;color:#666}.MathJax_MenuActive .MathJax_MenuArrow{color:#fff}.MathJax_MenuArrow.RTL{left:.5em;right:auto}.MathJax_MenuCheck{position:absolute;left:.7em}.MathJax_MenuCheck.RTL{right:.7em;left:auto}.MathJax_MenuRadioCheck{position:absolute;left:.7em}.MathJax_MenuRadioCheck.RTL{right:.7em;left:auto}.MathJax_MenuLabel{padding:1px 2em 3px 1.33em;font-style:italic}.MathJax_MenuRule{border-top:1px solid #DDD;margin:4px 3px}.MathJax_MenuDisabled{color:GrayText}.MathJax_MenuActive{background-color:#606872;color:#fff}.MathJax_Menu_Close{position:absolute;width:31px;height:31px;top:-15px;left:-15px}#MathJax_Zoom{position:absolute;background-color:#F0F0F0;overflow:auto;display:block;z-index:301;padding:.5em;border:1px solid #000;margin:0;font-weight:400;font-style:normal;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;box-shadow:5px 5px 15px #AAA;-webkit-box-shadow:5px 5px 15px #AAA;-moz-box-shadow:5px 5px 15px #AAA;-khtml-box-shadow:5px 5px 15px #AAA;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}#MathJax_ZoomOverlay{position:absolute;left:0;top:0;z-index:300;display:inline-block;width:100%;height:100%;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}#MathJax_ZoomFrame{position:relative;display:inline-block;height:0;width:0}#MathJax_ZoomEventTrap{position:absolute;left:0;top:0;z-index:302;display:inline-block;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}.MathJax_Preview{color:#888}#MathJax_Message{position:fixed;left:1px;bottom:2px;background-color:#E6E6E6;border:1px solid #959595;margin:0;padding:2px 8px;z-index:102;color:#000;font-size:80%;width:auto;white-space:nowrap}#MathJax_MSIE_Frame{position:absolute;top:0;left:0;width:0;z-index:101;border:0;margin:0;padding:0}.MathJax_Error{color:#C00;font-style:italic}footer{position:fixed;font-size:.8em;text-align:right;bottom:0;margin-left:-25px;height:20px;width:100%}</style>
</head>
<body class="markdown github">
<h1 id="principles-of-mapping"><a name="principles-of-mapping" href="#principles-of-mapping"></a>Principles of mapping</h1><p>Maps are staples of journalism: The basic need to show the “where” of stories means that they are used frequently. Unlike some chart types, such as bubble charts or network diagrams, which may require some explanation to the uninitiated, maps need no introduction — we are all familiar with using them to navigate. Indeed, thanks to the smartphone revolution, most of us now carry sophisticated interactive mapping apps everywhere we go.</p><p>Maps can also be used to visualize data, which will be our main focus in the coming classes as we process geodata and learn how to display it on both static and online maps. Before we get into the practical details of making maps, we will cover some basic principles of mapping, and good practice in mapmaking.</p><h3 id="the-data-we-will-use-today"><a name="the-data-we-will-use-today" href="#the-data-we-will-use-today"></a>The data we will use today</h3><p>Download the data for this session from <a href="data/week9.zip">here</a>, unzip the folder and place it on your desktop. It contains the following files:</p><ul>
<li><code>sf_test_addresses.tsv</code> Text file with list of 100 addresses in San Francisco, for geocoding exercise.</li><li><code>refine_geocoder.json</code> JSON file to geocode using Open Refine.</li><li><code>sf_test_addresses_short.tsv</code> The first 10 addresses from the previous file.</li></ul><p>The first two files can also be downloaded from <a href="https://github.com/paldhous/refine-geocoder">this Github respository</a>.</p><p>For today’s geocoding exercise, you will need a Bing Maps API key and a MapQuest API key. Obtain your Mapquest key from <a href="https://developer.mapquest.com/">here</a>. If you don’t already have a Microsoft Account, you will first need to <a href="https://signup.live.com/signup.aspx?sf=1&amp;id=38936&amp;ru=https://account.live.com/%3fwa%3dwsignin1.0&amp;tw=0&amp;fs=0&amp;kv=0&amp;cb=&amp;cbcxt=&amp;wp=SAPI&amp;wa=wsignin1.0&amp;wreply=https://account.live.com/%3fwa%3dwsignin1.0&amp;bk=1413566923&amp;uiflavor=web&amp;uaid=3affa9094c4e4ca5aa721863467ee2f0&amp;mkt=EN-US&amp;lc=1033&amp;lic=1">create one</a> before requesting a Bing Maps key. Then <code>Sign in</code> at the <a href="https://www.bingmapsportal.com/">Bing Maps Portal</a> and select <code>My account&gt;My keys</code> from the top menu.</p><h3 id="latitude-and-longitude"><a name="latitude-and-longitude" href="#latitude-and-longitude"></a>Latitude and longitude</h3><p>Consider the following concepts in relation to this image:</p><p><img src="img/class9_1.jpg" alt=""></p><p>(Source: <a href="https://www.google.com/earth/">Google Earth</a>)</p><p>When plotting points on a map, you will usually need to know their latitude and longitude. Latitude and longitude is a geographic coordinate system that enables every location on the Earth’s surface to be defined by two numbers. Latitudes are angular distances, given in degrees from 0 to 90, which define how far North or South a point is from the Equator. Longitudes are angular distances, given in degrees from 0 to 180, which define how far East or West a point is from a line running from the North to the South Pole through the Royal Observatory in Greenwich, London. Lines of equal latitude are known as <strong>parallels</strong>, while lines of equal longitude are called <strong>meridians</strong>.</p><p>Degrees of latitude or longitude can be subdivided into minutes and seconds (sometimes called the DMS system), or can be given as decimals. There are 60 minutes in a degree, and 60 seconds in a minute; the symbols for degrees, minutes and seconds are: <code>°</code>, <code>'</code> and <code>"</code>. In decimal format, points North of the Equator are given as positive values, while those South of the Equator are negative. Similarly, for longitude, points to the East of the Prime Meridian that runs through Greenwich are positive, while those to the West are negative.</p><p>To understand how this works, consider the location of the UC Berkeley Graduate School of Journalism. Its latitude and longitude coordinates are <code>37.8749998</code> and <code>-122.2596684</code>, which can also be written as <code>37° 52' 30.0" N</code> , <code>122° 15' 34.8" W</code>. If you were to draw a line from the center of the Earth to the J-School, and then draw another to the Equator at the same longitude, the angle between them would be 37.8749998 degrees. If you were to take a slice of the Earth at this latitude, parallel to the equator, and draw two lines from the center of this slice, one to the Prime Meridian, the other to the J-School, the angle between them would be -122.2596684 degrees.</p><p>(Various online services support conversion from <a href="http://www.zonums.com/online/coords/cotrans.php?module=11">DMS to digital</a> latitudes and longitudes, and <a href="http://www.zonums.com/online/coords/cotrans.php?module=12">vice versa</a> — the two links given are free to use, and should process many thousands of records at a time.)</p><p>There are 360 degrees in a full circle, which explains why longitude goes from 0 to 180 degrees both East and West. Similarly, moving from the North to the South Pole means travelling half way round the Earth’s circumference, which is why latitude goes from 0 to 90 degrees both North and South.</p><p>Two points separated by one degree of latitude, lying at the same longitude, will always be separated by about 69 miles, because meridians are always the same size, representing half the circumference of the Earth. However, parallels decrease in size as we move nearer to the poles. At the Equator, one degree of longitude again corresponds to a linear distance across the Earth’s surface of about 69 miles. But at 45 degrees latitude North or South, you would need to travel just 49 miles to cover one degree of longitude.</p><h3 id="geocoding"><a name="geocoding" href="#geocoding"></a>Geocoding</h3><p>Often when starting a mapping project, you may need to convert a series of addresses into latitudes and longitudes so they can be placed on your map. This is called geocoding.</p><p>There are several geocoding APIs, which can be accessed in various ways. The number of requests allowed per day and the terms of use vary from service to service: <a href="https://developers.google.com/maps/documentation/geocoding/">Google’s</a> free service, for instance, specifies that the resulting coordinates may only be used <a href="https://developers.google.com/maps/documentation/geocoding/policies">to make a Google Map</a>.</p><p>We will instead use the services offered by Microsoft’s <a href="http://msdn.microsoft.com/en-us/library/ff701714.aspx">Bing Maps</a>, and <a href="http://open.mapquestapi.com/nominatim/">MapQuest Open</a> (which is based on OpenStreetMap’s <a href="http://nominatim.openstreetmap.org/">Nominatim</a> service), to geocode sample addresses in San Francisco.</p><p>These geocoding APIs can both be accessed from Open Refine. The file <code>refine_geocoder.json</code> will geocode a sample of addresses using both the Bing and MapQuest Open APIs. You will need to replace <code>BingMapsKey</code> in this file with your own Bing API key, and <code>MapQuestKey</code> with your MapQuest API key. In class we will use this code to geocode the <code>sf_test_addresses.tsv</code> dataset.</p><p>For the MapQuest Open results, the <code>mapquest_class</code> column provides information on the accuracy of geocoding: <code>place</code>, <code>amenity</code> or <code>shop</code> indicate geocoding to a precise address; <code>highway</code> indicates geocoding to a street only. The <code>mapquest_type</code> column provides further information about the address or street concerned.</p><p><strong>Here is a step-by-step description of how the geocoder works using the Bing API:</strong></p><p>Create a new Open Refine project by importing a text file containing complete addresses in one column, with the heading <code>address</code>. Our test data is already in this format; use <code>sf_test_addresses_short.tsv</code> for this initial exercise.</p><p>From the <code>address</code> column, select <code>Edit column&gt;Add column by fetching URLs...</code>, call the column <code>bing_json</code> and use the following expression:</p><pre class="javascript hljs"><code class="JavaScript" data-origin="<pre><code class=&quot;JavaScript&quot;>&quot;http://dev.virtualearth.net/REST/v1/Locations?q=&quot; + escape(value, &quot;url&quot;) + &quot;&amp;amp;key=BingMapsKey&quot;
</code></pre>"><span class="hljs-string">"http://dev.virtualearth.net/REST/v1/Locations?q="</span> + <span class="hljs-built_in">escape</span>(value, <span class="hljs-string">"url"</span>) + <span class="hljs-string">"&amp;key=BingMapsKey"</span>
</code></pre><p>Note that you will have to enter your own Bing API key in place of <code>BingMapsKey</code>. Also, set the <code>Throttle delay</code> to 500 milliseconds for faster processing. This expression constructs a URL that will query the Bing geocoding API and return data for the address in question in JSON format.</p><p>From the <code>bing_json</code> column, select <code>Edit column&gt;Add column based on this column...</code>, call the column <code>bing_lat_lon</code> and use this expression to extract the latitude and longitude from the JSON returned by the API:</p><pre class="javascript hljs"><code class="JavaScript" data-origin="<pre><code class=&quot;JavaScript&quot;>with(value.parseJson().resourceSets[0].resources[0].point.coordinates, pair, pair[0] +&quot;, &quot; + pair[1])
</code></pre>"><span class="hljs-keyword">with</span>(value.parseJson().resourceSets[<span class="hljs-number">0</span>].resources[<span class="hljs-number">0</span>].point.coordinates, pair, pair[<span class="hljs-number">0</span>] +<span class="hljs-string">", "</span> + pair[<span class="hljs-number">1</span>])
</code></pre><p>Split the <code>bing_lat_lon</code> column into to two columns by selecting <code>Edit column&gt;Split into several columns</code>, then rename these columns <code>bing_latitude</code> and <code>bing_longitude</code>.</p><p>From the <code>bing_json</code> column, select <code>Edit column&gt;Add column based on this column...</code>, call the column <code>bing_confidence</code> and use this expression to extract the Bing API’s confidence in the accuracy of its geocoding:</p><pre class="javascript hljs"><code class="JavaScript" data-origin="<pre><code class=&quot;JavaScript&quot;>with(value.parseJson().resourceSets[0].resources[0].confidence, v, v)
</code></pre>"><span class="hljs-keyword">with</span>(value.parseJson().resourceSets[<span class="hljs-number">0</span>].resources[<span class="hljs-number">0</span>].confidence, v, v)
</code></pre><p>From the <code>bing_json</code> column, select <code>Edit column&gt;Add column based on this column...</code>, call the column <code>bing_type</code> and use this expression to extract the type of place that the Bing API has geocoded:</p><pre class="javascript hljs"><code class="JavaScript" data-origin="<pre><code class=&quot;JavaScript&quot;>with(value.parseJson().resourceSets[0].resources[0].entityType, v, v)
</code></pre>"><span class="hljs-keyword">with</span>(value.parseJson().resourceSets[<span class="hljs-number">0</span>].resources[<span class="hljs-number">0</span>].entityType, v, v)
</code></pre><p>For a full address, this should return <code>Address</code> when the geocoding has been successful.</p><p>Finally, delete the <code>bing_json</code> column by selecting <code>Edit column&gt;Remove column</code>.</p><p>Other geocoding options include the <a href="http://www.gpsvisualizer.com/geocoder/">GPS Visualizer geocoder</a>. Again, you will need API keys for the geocoding services it uses.</p><p><img src="img/class9_2.jpg" alt=""></p><p>GPS Visualizer’s geocoder will work from a simple list of addresses, or from tabular data, with different aspects of the address (street address, city, state, zipcode and so on) in separate fields. Set the <code>Type of data</code> control as appropriate. If you are working with tabular data, with the address divided into several fields, adjust the <code>Field separator in output</code> control to reflect the separator in your data. I strongly recommend using the <code>raw list, 1 address per line</code> option, which in my experience gives much more reliable results.</p><p>Checking <code>Include source+precision info in output</code> will ensure that the output includes notification of the accuracy of the geocoding for each record: <code>address</code> indicates precise geocoding to a particular address.</p><p>Select <code>Bing Maps</code> as the source and paste your Bing Maps API key into the box. Then paste the address data, minus the header row, from the <code>sf_test_addresses.tsv</code> file into the <code>Input:</code> box, click <code>Start geocoding</code> and the results will appear in the <code>Results as text:</code> box. When all the addresses have been processed, copy and paste the results into a text file and save. If you have a large number of addresses to geocode, I recommend breaking them down into batches of 1,000 or fewer.</p><p>Whichever service you use to geocode addresses, provide appropriate acknowledgement. MapQuest’s terms and conditions require that you include this acknowledgement on any website or app using data geocoded through its service:</p><pre class="json hljs"><code class="JSON" data-origin="<pre><code class=&quot;JSON&quot;>&amp;lt;p&amp;gt;Geocoding Courtesy of &amp;lt;a href=&quot;https://www.mapquest.com/&quot; target=&quot;_blank&quot;&amp;gt;MapQuest&amp;lt;/a&amp;gt; &amp;lt;img src=&quot;https://developer.mapquest.com/content/osm/mq_logo.png&quot;&amp;gt;&amp;lt;/p&amp;gt;
</code></pre>">&lt;p&gt;Geocoding Courtesy of &lt;a href="https://www.mapquest.com/" target="_blank"&gt;MapQuest&lt;/a&gt; &lt;img src="https://developer.mapquest.com/content/osm/mq_logo.png"&gt;&lt;/p&gt;
</code></pre><p>Data should also be sourced to OpenStreetMap, <a href="https://wiki.openstreetmap.org/wiki/Legal_FAQ#3a._I_would_like_to_use_OpenStreetMap_maps._How_should_I_credit_you.3F">see here</a> for instructions on how to credit appropriately.</p><p>Here is an HTML acknowledgment to Bing in the same style as above:</p><pre class="json hljs"><code class="JSON" data-origin="<pre><code class=&quot;JSON&quot;>&amp;lt;p&amp;gt;Geocoding Courtesy of &amp;lt;a href=&quot;https://www.microsoft.com/maps/product/terms.html&quot; target=&quot;_blank&quot;&amp;gt;Bing&amp;lt;/a&amp;gt;&amp;lt;/p&amp;gt;
</code></pre>">&lt;p&gt;Geocoding Courtesy of &lt;a href="https://www.microsoft.com/maps/product/terms.html" target="_blank"&gt;Bing&lt;/a&gt;&lt;/p&gt;
</code></pre><p>Be aware that different geocoders will give slightly different results. In my experience, MapQuest Open tends to locate addresses to sidewalks or building fronts, while Bing tends to locate to the middle of the building concerned. Bing’s failure rate also appears to be lower. You may need to manually record the coordinates of addresses that fail, or which do not geocode to a precise address. In these cases, try searching for the address on Bing Maps or Google Maps. For the latter, note the latitude and longitude for the placemarker than appears, shown here after the <code>@</code> symbol:</p><pre class="json hljs"><code class="JSON" data-origin="<pre><code class=&quot;JSON&quot;>https://www.google.com/maps/place/1875+Cesar+Chavez,+San+Francisco,+CA+94107/@37.7497825,-122.395751,17z/data=!4m5!3m4!1s0x808f7fae0a545527:0x564005c073e75262!8m2!3d37.7497705!4d-122.3957525
</code></pre>">https://www.google.com/maps/place/1875+Cesar+Chavez,+San+Francisco,+CA+94107/@37.7497825,-122.395751,17z/data=!4m5!3m4!1s0x808f7fae0a545527:0x564005c073e75262!8m2!3d37.7497705!4d-122.3957525
</code></pre><p>You may also wish to experiment with <a href="https://geoservices.tamu.edu/">Texas A&amp;M University’s GeoServices</a>, which will geocode from an uploaded text file, emailing you when the results are ready for download. First <a href="https://geoservices.tamu.edu/Signup/">sign up for a free account</a>, then <a href="https://geoservices.tamu.edu/Services/Geocode/BatchProcess/">upload your data</a>.</p><h3 id="map-projections"><a name="map-projections" href="#map-projections"></a>Map projections</h3><p>Because the Earth is roughly spherical, any map other than a globe is a distortion of reality. Just as you can’t peel an orange and arrange the skin as a perfect rectangle, circle, or ellipse, it is impossible to plot the Earth’s surface in two dimensions and accurately represent distances, areas, shapes and directions.</p><p>Maps can be made simply by plotting latitude on the X axis and longitude on the Y axis on the same scale, sometimes called an Equirectangular projection:</p><p><img src="img/class9_3.jpg" alt=""></p><p>(Source: <a href="https://commons.wikimedia.org/wiki/File:Equirectangular_projection_SW.jpg">Wikimedia Commons</a>)</p><p>Most maps are drawn according to a more sophisticated projection system, however. There are many different systems, each of which has advantages and drawbacks. Some projections are optimized to minimize the distortion of area; others aim to preserve shape or distance; yet others keep directions constant.</p><p><a href="https://www.openstreetmap.org/#map=2/28.3/-106.5">OpenStreetMap</a> and most other online maps use a Mercator projection, which was originally designed for navigation at sea. (But note Google Maps in 2018 switched to <a href="https://www.theverge.com/2018/8/5/17653122/google-maps-update-mercator-projection-earth-isnt-flat">representing the Earth as a sphere</a> on Desktop when zoomed of.) The main strength of the Mercator projection is that it preserves direction, so that any straight line drawn on the map is a line of constant compass bearing. Parallels are all horizontal and meridians vertical. This preservation of direction is also a good choice for zoomable maps used primarily for local orientation. The big drawback of this projection is that it distorts area and shape, especially at high latitudes, which makes it a poor choice for representing the entire world. Notice how the distances between parallels increase with latitude:</p><p><img src="img/class9_4.jpg" alt=""></p><p>(Source: <a href="https://en.wikipedia.org/wiki/File:Mercator_projection_SW.jpg">Wikimedia Commons</a>)</p><p>When mapping the continental United States, particularly when coloring or shading different areas according to the values of data, it is common to use the Albers Equal Area Conic projection, as seen in this map of drought conditions across the nation:</p><p><img src="img/class9_5.jpg" alt=""></p><p>(Source: <a href="https://www.nytimes.com/interactive/2014/upshot/mapping-the-spread-of-drought-across-the-us.html"><em>The New York Times</em></a>)</p><p>As the name suggests, this projection minimizes distortions of area. It does not preserve compass bearing: Notice that the border with Canada, which runs along a parallel at a latitude of 45 degrees N, is a curve, rather that a straight line.</p><p>The Albers Equal Area Conic projection is rarely used to show the entire Earth, for obvious reasons when you see the projection in global view:</p><p><img src="img/class9_6.jpg" alt=""></p><p>(Source: <a href="https://en.wikipedia.org/wiki/File:Albers_projection_SW.jpg">Wikimedia Commons</a>)</p><p>To minimize the distortion of area on a global map, a better choice is the Mollweide projection:</p><p><img src="img/class9_7.jpg" alt=""></p><p>(Source: <a href="https://en.wikipedia.org/wiki/File:Mollweide_projection_SW.jpg">Wikimedia Commons</a>)</p><p>The Mollweide projection is also often used for maps of the entire sky (which can be thought of as the inside of a sphere). I used it <a href="http://paldhous.github.io/CMB/">here</a> to compare the resolution of maps of the cosmic microwave background radiation, which reveal ripples in space-time that are the remnants of conditions in the early Universe, with views of the Earth:</p><p><img src="img/class9_8.jpg" alt=""></p><p>(Source: <a href="https://paldhous.github.io/CMB/"><em>New Scientist</em></a>)</p><p>The Mollweide projection’s main disadvantage is the distortion of shape at high latitudes and longitudes — look, for example, at Alaska on the above Mollweide maps.</p><p>Under certain circumstances, preserving distance may by the most important goal. Here, an Azimuthal Equidistant Projection is the best approach:</p><p><img src="img/class9_9.jpg" alt=""></p><p>(Source: <a href="https://commons.wikimedia.org/wiki/File:Azimuthal_equidistant_projection_SW.jpg">Wikimedia Commons</a>)</p><p>Below, an Azimuthal Equidistant projection, centered on North Korea, is used to illustrate the locations that might lie within the range of that country’s ballistic missiles:</p><p><img src="img/class9_10.png" alt=""></p><p>(Source: <a href="https://www.buzzfeed.com/peteraldhous/north-korea-missiles-and-nukes">BuzzFeed News</a>)</p><p>Here, for comparison, is a map that highlights the zone within 10,000 km of North Korea using Google Maps’ Mercator projection:</p><p><img src="img/class9_11.jpg" alt=""></p><p>(Source: <a href="http://darrenwiens.net/pyongyang.html">Darren Wiens</a>)</p><p>As the North Korean Azimuthal Equidistant and US drought Albers Equal Area Conic maps show, projections can be centered on any point on the Earth — they do not have to be centered on the intersection between the Equator and the Prime Meridian, which is the most common view for a global map.</p><p>Distortions of shape, area, distance and direction are most obvious when representing the entire globe. Under these circumstances, mapmakers often adopt a compromise projection in which distance, area, shape, and direction are all distorted, but to a minimal extent. An example is the Robinson projection:</p><p><img src="img/class9_12.jpg" alt=""></p><p>(Source: <a href="https://en.wikipedia.org/wiki/File:Robinson_projection_SW.jpg">Wikimedia Commons</a>)</p><p>This was the projection I used for the global GDP per capita maps we saw in week 1:</p><p><img src="img/class1_18.png" alt=""></p><p>In addition to a projection, a map also has a <a href="https://en.wikipedia.org/wiki/Geodetic_datum">datum</a>, which refers to a mathematical model accounting for the shape of the Earth — which is not a perfect sphere.</p><h3 id="putting-data-onto-maps"><a name="putting-data-onto-maps" href="#putting-data-onto-maps"></a>Putting data onto maps</h3><h4 id="scaled-circles-vs.-choropleth-maps"><a name="scaled-circles-vs.-choropleth-maps" href="#scaled-circles-vs.-choropleth-maps"></a>Scaled circles vs. choropleth maps</h4><p>Data can be put onto maps in various ways. When continuous variables are plotted to points, one common approach is to use circles centered on each point, sized according to the data values. Here is an example of this approach, used to show fatalities caused by tornadoes:</p><p><img src="img/class9_13.jpg" alt=""></p><p>(Source: <a href="https://www.nytimes.com/interactive/2011/04/28/us/tornado-deaths.html"><em>The New York Times</em></a>)</p><p>When plotting data to geographical areas, the most common approach is to fill the areas with color according to the data values, like my maps of GDP per capita, or the US drought map above. These are known as <a href="https://datavizcatalogue.com/methods/choropleth.html">choropleth maps</a>.</p><p>Choropleth maps have an important drawback: Our eyes are drawn to expanses of color, which means that large geographic areas will attract greater attention, whether or not these are actually more important for the story you are trying to tell from the data. This becomes a particular problem with maps illustrating election results, where the significance of small geographical areas with large populations that have a major impact on the overall result gets downplayed, while sparsely populated large areas are overemphasized. Looking at this map of results from the 2012 Presidential election by county, for example, one would think at a glance that Mitt Romney was the winner:</p><p><img src="img/class9_14.jpg" alt=""></p><p>(Source: <a href="https://elections.nytimes.com/2012/results/president?view=county_margin_change_view"><em>The New York Times</em></a>)</p><p>In such cases, scaled circles located to the center of geographic areas can be a better option. Here is another map from the same interactive, using that approach to visualize the size of each candidate’s lead in each county, measured by the absolute number of votes. This shows how Barack Obama won the election through his strong support in densely populated urban areas:</p><p><img src="img/class9_15.jpg" alt=""></p><p>(Source: <a href="https://elections.nytimes.com/2012/results/president?view=county_margin_change_view"><em>The New York Times</em></a>)</p><h4 id="cartograms"><a name="cartograms" href="#cartograms"></a>Cartograms</h4><p>One solution to the main drawback of choropleth maps is to distort the areas plotted on the map to reflect aspects of the data, rather than geographical reality. These maps are called <a href="http://www.ncgia.ucsb.edu/projects/Cartogram_Central/types.html">cartograms</a>.</p><p>There are several algorithms for making cartograms which preserve the boundaries between geographical areas, which result in “organically” distorted maps. Here, for example, is a rendering of the 2012 Presidential Election results by county, distorted using the algorithm described in <a href="http://www.pnas.org/content/101/20/7499.abstract">this scientific paper</a>:</p><p><img src="img/class9_16.jpg" alt=""></p><p>(Source: <a href="http://www-personal.umich.edu/~mejn/election/2012/">Mark Newman</a>)</p><p>A good tool for making maps like this is <a href="https://scapetoad.choros.ch/">Scapetoad</a>. However, bear in mind that the impact of these maps derives from their disconcerting perspective. That can be useful to make your audience think about an issue in a new way, which was the thinking behind these maps of mine, comparing nations measured by GDP, and by a measure called the <a href="https://happyplanetindex.org/">Happy Planet Index</a>:</p><p><img src="img/class9_17.jpg" alt=""></p><p>(Source: <em><a href="https://www.newscientist.com/article/mg21428694.800-us-fails-on-happy-planet-index.html">New Scientist</a></em>)</p><p>The cartograms we have seen so far retain common borders between areas, which constrains the accuracy with which areas can be resized according to values for a continuous variable. By relaxing this constraint, it is possible to resize areas more precisely:</p><p><img src="img/class9_18.jpg" alt=""></p><p>(Source: <a href="http://bl.ocks.org/mbostock/4055908">Mike Bostock</a>)</p><p>However, bear in mind that it is hard to compare the areas of non-regular shapes, so either form of cartogram is not so useful if you want your audience to be able to “read” the data in a precise way.</p><p>It is also possible to make geometric cartograms, which use the area of shapes (generally circles or squares) to make a more abstract “map” in which the relative size of different elements is easier to compare. This graphic from <em>The New York Times</em>, published during the 2012 Presidential election campaign, took this approach:</p><p><img src="img/class9_19.jpg" alt=""></p><p>(Source: <em><a href="https://elections.nytimes.com/2012/ratings/electoral-map">The New York Times</a></em>)</p><p>Along similar lines, for its coverage of the 2010 U.K. General Election, the BBC represented each parliamentary constituency as a hexagon of equal area. The resulting map bore sufficient resemblance to an actual map of the United Kingdom to be meaningful, and users of the website could switch between the proportional and geographical maps to gain a more complete picture of the results by location:</p><p><img src="img/class9_20.jpg" alt=""></p><p>￼(Source: <a href="http://news.bbc.co.uk/2/shared/election2010/results/">BBC</a>)</p><p>Hexagons have advantages for mapping because they tile perfectly in a honeycomb-like grid. Maps of this type, sometimes called “tilegrams” have since become popular for representing election results and forecasts. Here, for example, is a map representing the electoral college for the 2016 presidential election, from <a href="https://projects.fivethirtyeight.com/2016-election-forecast/?ex_cid=rrpromo">FiveThirtyEight</a>:</p><p><img src="img/class9_20a.jpg" alt=""></p><p>(Source: <em><a href="https://projects.fivethirtyeight.com/2016-election-forecast/?ex_cid=rrpromo">FiveThirtyEight</a></em>)</p><p>The data visualization studio <a href="https://www.pitchinteractive.com/">Pitch Interactive</a> has created a <a href="https://pitchinteractiveinc.github.io/tilegrams/">tool</a> for making U.S. tilegrams. To use the resulting map in other mapping tools, click the <code>Export Toposon</code> button. You can then use <a href="https://mapshaper.org/">mapshaper</a> to convert to other geodata types, see below. There is also an R package called <strong><a href="https://github.com/bhaskarvk/tilegramsR">tilegramsR</a></strong>, see <a href="https://rpubs.com/bhaskarvk/tilegramsR">here</a> and <a href="https://rpubs.com/bhaskarvk/electoral-Map-2016">here</a> for examples.</p><h4 id="dot-density-maps:-seeing-the-big-picture-by-showing-all-of-the-data"><a name="dot-density-maps:-seeing-the-big-picture-by-showing-all-of-the-data" href="#dot-density-maps:-seeing-the-big-picture-by-showing-all-of-the-data"></a>Dot density maps: Seeing the big picture by showing all  of the data</h4><p>Sometimes patterns emerge from geographic data when we see the spatial distribution of every single occurrence of a phenomenon. This is the thinking behind dot density maps, like this visualization of the 2010 U.S. Census, which includes a colored point for every single person:</p><p><img src="img/class9_21.jpg" alt=""></p><p>(Source: <a href="https://demographics.coopercenter.org/racial-dot-map/">Dustin Cable, University of Virginia</a>)</p><p>The overall effect is rather like <a href="https://en.wikipedia.org/wiki/Pointillism">pointillist</a> art. These maps work well when zoomed out, but are not so informative at high zoom levels.</p><h4 id="making-sense-of-many-overlapping-points:-heatmaps-vs.-hexagonal-binning"><a name="making-sense-of-many-overlapping-points:-heatmaps-vs.-hexagonal-binning" href="#making-sense-of-many-overlapping-points:-heatmaps-vs.-hexagonal-binning"></a>Making sense of many overlapping points: Heatmaps vs. hexagonal binning</h4><p>While dot density maps can be useful on occasion, sometimes you may need to tell a story based on the distribution of points where they overlap, or sit directly on top of one another. This can present a misleading picture, as much of the data will be obscured.</p><p>Under such circumstances, other approaches are necessary. Heat maps, for example, plot the density of points on a map as a gradient of colors, typically running from cool blues or greens to warm reds. Here, to illustrate, I have used this approach to map violent events in Syria’s civil war from its start to the end of the first quarter of 2013, revealing “hotspots” of violence that were not so obvious from a map of thousands of overlapping points, seen below:</p><p><img src="img/class9_23.jpg" alt=""></p><p><img src="img/class9_24.jpg" alt=""></p><p>(Source: Peter Aldhous, from <a href="https://www.gdeltproject.org/">GDELT</a> data)</p><p>While heatmaps are good for qualitatively identifying hotspots, they are less useful for communicating quantitative information. For this purpose, a better approach is to superimpose a hexagonal grid over the map, count the points in each cell, and use those counts to create a choropleth map, based on the grid. I used that approach on the same data to make this map of Syria’s conflict:</p><p><img src="img/class9_25.jpg" alt=""></p><p>(Source: <em><a href="https://paldhous.github.io/Syria/">New Scientist</a></em>)</p><h3 id="think-before-you-map:-is-this-the-best-representation-of-the-data?"><a name="think-before-you-map:-is-this-the-best-representation-of-the-data?" href="#think-before-you-map:-is-this-the-best-representation-of-the-data?"></a>Think before you map: Is this the best representation of the data?</h3><p>Whenever you come across data that can be put on a map, it’s very tempting to do this. However, always ask yourself: Is this the best way of telling my story? From the examples above, you will see that most maps encode data either using color, or through the area of circles or other symbols. You will remember from week 2 that these two visual encodings fall fairly low down on the perceptual heirarchy of visual cues, making it relatively hard for your audience to make accurate, quantititative comparisons.</p><p><img src="img/class2_2.jpg" alt=""></p><p>Consider these two representations of similar data on rates of overall gun death (the map) and gun homicides (the bar chart) by U.S. state:</p><p><img src="img/class9_26.jpg" alt=""></p><p>(Source: <em><a href="http://feature.rollingstone.com/feature/gun-control/map#deadPer100K">Rolling Stone</a></em>)</p><p><img src="img/class9_27.jpg" alt=""></p><p>(Source: <a href="http://flowingdata.com/2011/01/19/states-with-the-most-and-least-firearms-murders/">Flowing Data</a>)</p><p>The bar chart clearly allows the more detailed comparison between rates for different states. However, the map still has value because it does show that the states with the highest gun death rates occur in particular geographic locations. In cases like this, consider using a map as only one part of your graphic, perhaps as a secondary element.</p><h3 id="other-visual-encodings"><a name="other-visual-encodings" href="#other-visual-encodings"></a>Other visual encodings</h3><p>Although color intensty and the area of scaled circles are the most common cues used for encoding data on maps, sometimes it is possible to use others.</p><p><a href="https://www.nytimes.com/interactive/2018/09/18/us/hurricane-florence-flooding.html">Here</a>, for example, <em>The New York Times</em> used column heights to illustrate river levels rising in the Carolinas after the rain from Hurricane Florence.</p><p><img src="img/class9_28.gif" alt=""></p><p>(Source: <a href="https://www.nytimes.com/interactive/2018/09/18/us/hurricane-florence-flooding.html">The New York Times</a>)</p><p>In <a href="https://www.nytimes.com/elections/results/president">this graphic</a> illustrating the change in voting from the 2012 to the 2016 presidential elections, <em>The New York Times</em> used the slope and length of arrows to illustrate the swing in vote, by county, to the left or right.</p><p><img src="img/class9_29.jpg" alt=""></p><p>(Source: <a href="https://www.nytimes.com/elections/results/president">The New York Times</a>)</p><h3 id="static-vs.-zoomable-tiled-maps"><a name="static-vs.-zoomable-tiled-maps" href="#static-vs.-zoomable-tiled-maps"></a>Static vs. zoomable tiled maps</h3><p>When designing a map-based graphic, one of the first things to decide is whether you want to display a static map view, or whether users should be able to pan and zoom the map in a dynamic way.</p><p>Web maps that can be panned and zoomed generally depend on a series of world maps of different zoom levels, which are each divided into square tiles. The tiles are loaded into the web browser as required as the user pans and zooms the map. This image demonstrates the principle:</p><p><img src="img/class9_30.jpg" alt=""></p><p>(Source: <a href="http://msdn.microsoft.com/en-us/library/bb259689.aspx">Microsoft Developer Network</a>)</p><p>Zoomable data-driven web maps are often displayed over basemaps from Google, OpenStreetMap, or another provider. Because these basemaps mostly use a Mercator projection, that projection needs to be used for the data layers also.</p><h3 id="geographic-data-formats"><a name="geographic-data-formats" href="#geographic-data-formats"></a>Geographic data formats</h3><p>Most commonly you will come across geodata in which values are attached to points, lines or polygons. This is called “vector” geodata, and here are some common formats. (For points, geodata may also be provided in CSV format.)</p><h4 id="kml"><a name="kml" href="#kml"></a>KML</h4><p><a href="https://developers.google.com/kml/documentation/kml_tut">KML</a>, or Keyhole Markup Language, is the format used to display data on Google Earth and Google Maps. As the name suggests, it is based on XML, and has a similar structure of nested tags.</p><p>These tags can define a range of elements including point markers such as the familiar placemarks used on Google Maps, lines, and the boundaries of geographical areas, known as “polygons.” The coordinates of these elements, their color and other aspects of their styling, and the information bubbles that may appear when the elements are clicked, can all be encoded in the KML.</p><p>Here, for example, is a simple KML file coding for an exaggeratedly tall representation of The Pentagon. Notice how the coordinates for the polygon give latitudes and longitudes that define the inner and outer boundaries of the building, and locate the “roof” at a height of 100 meters above ground level. <code>&lt;extrude&gt;1&lt;/extrude&gt;</code> extends the shape to the ground:</p><pre class="xml hljs"><code class="XML" data-origin="<pre><code class=&quot;XML&quot;>&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;
&amp;lt;kml xmlns=&quot;http://www.opengis.net/kml/2.2&quot;&amp;gt;
  &amp;lt;Placemark&amp;gt;
    &amp;lt;name&amp;gt;The Pentagon&amp;lt;/name&amp;gt;
    &amp;lt;Polygon&amp;gt;
      &amp;lt;extrude&amp;gt;1&amp;lt;/extrude&amp;gt;
      &amp;lt;altitudeMode&amp;gt;relativeToGround&amp;lt;/altitudeMode&amp;gt;
      &amp;lt;outerBoundaryIs&amp;gt;
        &amp;lt;LinearRing&amp;gt;
          &amp;lt;coordinates&amp;gt;
            -77.05788457660967,38.87253259892824,100 
            -77.05465973756702,38.87291016281703,100 
            -77.05315536854791,38.87053267794386,100 
            -77.05552622493516,38.868757801256,100 
            -77.05844056290393,38.86996206506943,100 
            -77.05788457660967,38.87253259892824,100
          &amp;lt;/coordinates&amp;gt;
        &amp;lt;/LinearRing&amp;gt;
      &amp;lt;/outerBoundaryIs&amp;gt;
      &amp;lt;innerBoundaryIs&amp;gt;
        &amp;lt;LinearRing&amp;gt;
          &amp;lt;coordinates&amp;gt;
            -77.05668055019126,38.87154239798456,100 
            -77.05542625960818,38.87167890344077,100 
            -77.05485125901024,38.87076535397792,100 
            -77.05577677433152,38.87008686581446,100 
            -77.05691162017543,38.87054446963351,100 
            -77.05668055019126,38.87154239798456,100
          &amp;lt;/coordinates&amp;gt;
        &amp;lt;/LinearRing&amp;gt;
      &amp;lt;/innerBoundaryIs&amp;gt;
    &amp;lt;/Polygon&amp;gt;
  &amp;lt;/Placemark&amp;gt;
&amp;lt;/kml&amp;gt;
</code></pre>"><span class="hljs-pi">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">kml</span> <span class="hljs-attribute">xmlns</span>=<span class="hljs-value">"http://www.opengis.net/kml/2.2"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">Placemark</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">name</span>&gt;</span>The Pentagon<span class="hljs-tag">&lt;/<span class="hljs-title">name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">Polygon</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">extrude</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-title">extrude</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">altitudeMode</span>&gt;</span>relativeToGround<span class="hljs-tag">&lt;/<span class="hljs-title">altitudeMode</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">outerBoundaryIs</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">LinearRing</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">coordinates</span>&gt;</span>
            -77.05788457660967,38.87253259892824,100 
            -77.05465973756702,38.87291016281703,100 
            -77.05315536854791,38.87053267794386,100 
            -77.05552622493516,38.868757801256,100 
            -77.05844056290393,38.86996206506943,100 
            -77.05788457660967,38.87253259892824,100
          <span class="hljs-tag">&lt;/<span class="hljs-title">coordinates</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">LinearRing</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">outerBoundaryIs</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">innerBoundaryIs</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">LinearRing</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">coordinates</span>&gt;</span>
            -77.05668055019126,38.87154239798456,100 
            -77.05542625960818,38.87167890344077,100 
            -77.05485125901024,38.87076535397792,100 
            -77.05577677433152,38.87008686581446,100 
            -77.05691162017543,38.87054446963351,100 
            -77.05668055019126,38.87154239798456,100
          <span class="hljs-tag">&lt;/<span class="hljs-title">coordinates</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">LinearRing</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">innerBoundaryIs</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">Polygon</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">Placemark</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">kml</span>&gt;</span>
</code></pre><p>Here is how this file displays in Google Earth:</p><p><img src="img/class9_31.jpg" alt=""></p><p>(Source: <a href="https://www.google.com/earth/">Google Earth</a>)</p><p>See Google’s <a href="https://developers.google.com/kml/documentation/kml_tut">tutorial</a> and <a href="https://developers.google.com/kml/documentation/kmlreference?csw=1">reference</a> for a guide to the tags that can be used to code KML.</p><p>KML can also be compressed into KMZ files. To create a KMZ file from KML, open the file in Google Earth, right-click on the file in the <code>Places</code> panel, select <code>Save Place As</code>, and then select <code>KMZ</code> under format.</p><p>KML has been adopted as a standard for geographic data, and so can be used by a wide range of mapping applications, including Geographic Information Systems (GIS) software.</p><h4 id="geojson"><a name="geojson" href="#geojson"></a>GeoJSON</h4><p><a href="http://geojson.org/">GeoJSON</a> is a variant of JSON develeoped for encoding geographic data, commonly used for data-driven online maps. Its overall structure is the same as conventional JSON. Each <code>Feature</code> has <code>properties</code>, which can be any data related to the feature, <code>geometry</code>, which includes its <code>type</code> (point, polygon and so on), and latitude and longitude <code>coordinates</code>. Features can be grouped into a <code>FeatureCollection</code>. Here, for example, are the first ten addresses we geocoded earlier using the Bing maps API, encoded as GeoJSON (you may need to scroll to the right to see all of the data):</p><pre class="json hljs"><code class="JSON" data-origin="<pre><code class=&quot;JSON&quot;>{
&quot;type&quot;: &quot;FeatureCollection&quot;,
&quot;crs&quot;: { &quot;type&quot;: &quot;name&quot;, &quot;properties&quot;: { &quot;name&quot;: &quot;urn:ogc:def:crs:OGC:1.3:CRS84&quot; } },

&quot;features&quot;: [
{ &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: { &quot;address&quot;: &quot;1800 25th St, San Francisco, CA, 94107&quot;, &quot;bing_type&quot;: &quot;Address&quot;, &quot;bing_confidence&quot;: &quot;High&quot;, &quot;bing_latitude&quot;: 37.753067, &quot;bing_longitude&quot;: -122.397484 }, &quot;geometry&quot;: { &quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [ -122.397484, 37.753067 ] } },
{ &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: { &quot;address&quot;: &quot;302 Silver Ave, San Francisco, CA, 94112&quot;, &quot;bing_type&quot;: &quot;Address&quot;, &quot;bing_confidence&quot;: &quot;High&quot;, &quot;bing_latitude&quot;: 37.727722, &quot;bing_longitude&quot;: -122.430573 }, &quot;geometry&quot;: { &quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [ -122.430573, 37.727722 ] } },
{ &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: { &quot;address&quot;: &quot;425 7th St, San Francisco, CA, 94103&quot;, &quot;bing_type&quot;: &quot;Address&quot;, &quot;bing_confidence&quot;: &quot;High&quot;, &quot;bing_latitude&quot;: 37.775398, &quot;bing_longitude&quot;: -122.404366 }, &quot;geometry&quot;: { &quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [ -122.404366, 37.775398 ] } },
{ &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: { &quot;address&quot;: &quot;2001 Chestnut St, San Francisco, CA, 94123&quot;, &quot;bing_type&quot;: &quot;Address&quot;, &quot;bing_confidence&quot;: &quot;High&quot;, &quot;bing_latitude&quot;: 37.800575, &quot;bing_longitude&quot;: -122.436508 }, &quot;geometry&quot;: { &quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [ -122.436508, 37.800575 ] } },
{ &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: { &quot;address&quot;: &quot;952 Sutter St, San Francisco, CA, 94109&quot;, &quot;bing_type&quot;: &quot;Address&quot;, &quot;bing_confidence&quot;: &quot;High&quot;, &quot;bing_latitude&quot;: 37.788548, &quot;bing_longitude&quot;: -122.416161 }, &quot;geometry&quot;: { &quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [ -122.416161, 37.788548 ] } },
{ &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: { &quot;address&quot;: &quot;105 Palm Ave, San Francisco, CA, 94118&quot;, &quot;bing_type&quot;: &quot;Address&quot;, &quot;bing_confidence&quot;: &quot;High&quot;, &quot;bing_latitude&quot;: 37.783619, &quot;bing_longitude&quot;: -122.458206 }, &quot;geometry&quot;: { &quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [ -122.458206, 37.783619 ] } },
{ &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: { &quot;address&quot;: &quot;1111 California St, San Francisco, CA, 94108&quot;, &quot;bing_type&quot;: &quot;Address&quot;, &quot;bing_confidence&quot;: &quot;High&quot;, &quot;bing_latitude&quot;: 37.791183, &quot;bing_longitude&quot;: -122.412956 }, &quot;geometry&quot;: { &quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [ -122.412956, 37.791183 ] } },
{ &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: { &quot;address&quot;: &quot;1501 Larkin St, San Francisco, CA, 94109&quot;, &quot;bing_type&quot;: &quot;Address&quot;, &quot;bing_confidence&quot;: &quot;High&quot;, &quot;bing_latitude&quot;: 37.791859, &quot;bing_longitude&quot;: -122.419556 }, &quot;geometry&quot;: { &quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [ -122.419556, 37.791859 ] } },
{ &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: { &quot;address&quot;: &quot;4508 Balboa St, San Francisco, CA, 94121&quot;, &quot;bing_type&quot;: &quot;Address&quot;, &quot;bing_confidence&quot;: &quot;High&quot;, &quot;bing_latitude&quot;: 37.775490, &quot;bing_longitude&quot;: -122.507271 }, &quot;geometry&quot;: { &quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [ -122.507271, 37.77549 ] } },
{ &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: { &quot;address&quot;: &quot;101 Turk St, San Francisco, CA, 94102&quot;, &quot;bing_type&quot;: &quot;Address&quot;, &quot;bing_confidence&quot;: &quot;High&quot;, &quot;bing_latitude&quot;: 37.782890, &quot;bing_longitude&quot;: -122.411064 }, &quot;geometry&quot;: { &quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [ -122.411064, 37.78289 ] } }
]
}
</code></pre>">{
"<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"FeatureCollection"</span></span>,
"<span class="hljs-attribute">crs</span>": <span class="hljs-value">{ "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"name"</span></span>, "<span class="hljs-attribute">properties</span>": <span class="hljs-value">{ "<span class="hljs-attribute">name</span>": <span class="hljs-value"><span class="hljs-string">"urn:ogc:def:crs:OGC:1.3:CRS84"</span> </span>} </span>}</span>,

"<span class="hljs-attribute">features</span>": <span class="hljs-value">[
{ "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"Feature"</span></span>, "<span class="hljs-attribute">properties</span>": <span class="hljs-value">{ "<span class="hljs-attribute">address</span>": <span class="hljs-value"><span class="hljs-string">"1800 25th St, San Francisco, CA, 94107"</span></span>, "<span class="hljs-attribute">bing_type</span>": <span class="hljs-value"><span class="hljs-string">"Address"</span></span>, "<span class="hljs-attribute">bing_confidence</span>": <span class="hljs-value"><span class="hljs-string">"High"</span></span>, "<span class="hljs-attribute">bing_latitude</span>": <span class="hljs-value"><span class="hljs-number">37.753067</span></span>, "<span class="hljs-attribute">bing_longitude</span>": <span class="hljs-value">-<span class="hljs-number">122.397484</span> </span>}</span>, "<span class="hljs-attribute">geometry</span>": <span class="hljs-value">{ "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"Point"</span></span>, "<span class="hljs-attribute">coordinates</span>": <span class="hljs-value">[ -<span class="hljs-number">122.397484</span>, <span class="hljs-number">37.753067</span> ] </span>} </span>},
{ "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"Feature"</span></span>, "<span class="hljs-attribute">properties</span>": <span class="hljs-value">{ "<span class="hljs-attribute">address</span>": <span class="hljs-value"><span class="hljs-string">"302 Silver Ave, San Francisco, CA, 94112"</span></span>, "<span class="hljs-attribute">bing_type</span>": <span class="hljs-value"><span class="hljs-string">"Address"</span></span>, "<span class="hljs-attribute">bing_confidence</span>": <span class="hljs-value"><span class="hljs-string">"High"</span></span>, "<span class="hljs-attribute">bing_latitude</span>": <span class="hljs-value"><span class="hljs-number">37.727722</span></span>, "<span class="hljs-attribute">bing_longitude</span>": <span class="hljs-value">-<span class="hljs-number">122.430573</span> </span>}</span>, "<span class="hljs-attribute">geometry</span>": <span class="hljs-value">{ "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"Point"</span></span>, "<span class="hljs-attribute">coordinates</span>": <span class="hljs-value">[ -<span class="hljs-number">122.430573</span>, <span class="hljs-number">37.727722</span> ] </span>} </span>},
{ "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"Feature"</span></span>, "<span class="hljs-attribute">properties</span>": <span class="hljs-value">{ "<span class="hljs-attribute">address</span>": <span class="hljs-value"><span class="hljs-string">"425 7th St, San Francisco, CA, 94103"</span></span>, "<span class="hljs-attribute">bing_type</span>": <span class="hljs-value"><span class="hljs-string">"Address"</span></span>, "<span class="hljs-attribute">bing_confidence</span>": <span class="hljs-value"><span class="hljs-string">"High"</span></span>, "<span class="hljs-attribute">bing_latitude</span>": <span class="hljs-value"><span class="hljs-number">37.775398</span></span>, "<span class="hljs-attribute">bing_longitude</span>": <span class="hljs-value">-<span class="hljs-number">122.404366</span> </span>}</span>, "<span class="hljs-attribute">geometry</span>": <span class="hljs-value">{ "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"Point"</span></span>, "<span class="hljs-attribute">coordinates</span>": <span class="hljs-value">[ -<span class="hljs-number">122.404366</span>, <span class="hljs-number">37.775398</span> ] </span>} </span>},
{ "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"Feature"</span></span>, "<span class="hljs-attribute">properties</span>": <span class="hljs-value">{ "<span class="hljs-attribute">address</span>": <span class="hljs-value"><span class="hljs-string">"2001 Chestnut St, San Francisco, CA, 94123"</span></span>, "<span class="hljs-attribute">bing_type</span>": <span class="hljs-value"><span class="hljs-string">"Address"</span></span>, "<span class="hljs-attribute">bing_confidence</span>": <span class="hljs-value"><span class="hljs-string">"High"</span></span>, "<span class="hljs-attribute">bing_latitude</span>": <span class="hljs-value"><span class="hljs-number">37.800575</span></span>, "<span class="hljs-attribute">bing_longitude</span>": <span class="hljs-value">-<span class="hljs-number">122.436508</span> </span>}</span>, "<span class="hljs-attribute">geometry</span>": <span class="hljs-value">{ "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"Point"</span></span>, "<span class="hljs-attribute">coordinates</span>": <span class="hljs-value">[ -<span class="hljs-number">122.436508</span>, <span class="hljs-number">37.800575</span> ] </span>} </span>},
{ "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"Feature"</span></span>, "<span class="hljs-attribute">properties</span>": <span class="hljs-value">{ "<span class="hljs-attribute">address</span>": <span class="hljs-value"><span class="hljs-string">"952 Sutter St, San Francisco, CA, 94109"</span></span>, "<span class="hljs-attribute">bing_type</span>": <span class="hljs-value"><span class="hljs-string">"Address"</span></span>, "<span class="hljs-attribute">bing_confidence</span>": <span class="hljs-value"><span class="hljs-string">"High"</span></span>, "<span class="hljs-attribute">bing_latitude</span>": <span class="hljs-value"><span class="hljs-number">37.788548</span></span>, "<span class="hljs-attribute">bing_longitude</span>": <span class="hljs-value">-<span class="hljs-number">122.416161</span> </span>}</span>, "<span class="hljs-attribute">geometry</span>": <span class="hljs-value">{ "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"Point"</span></span>, "<span class="hljs-attribute">coordinates</span>": <span class="hljs-value">[ -<span class="hljs-number">122.416161</span>, <span class="hljs-number">37.788548</span> ] </span>} </span>},
{ "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"Feature"</span></span>, "<span class="hljs-attribute">properties</span>": <span class="hljs-value">{ "<span class="hljs-attribute">address</span>": <span class="hljs-value"><span class="hljs-string">"105 Palm Ave, San Francisco, CA, 94118"</span></span>, "<span class="hljs-attribute">bing_type</span>": <span class="hljs-value"><span class="hljs-string">"Address"</span></span>, "<span class="hljs-attribute">bing_confidence</span>": <span class="hljs-value"><span class="hljs-string">"High"</span></span>, "<span class="hljs-attribute">bing_latitude</span>": <span class="hljs-value"><span class="hljs-number">37.783619</span></span>, "<span class="hljs-attribute">bing_longitude</span>": <span class="hljs-value">-<span class="hljs-number">122.458206</span> </span>}</span>, "<span class="hljs-attribute">geometry</span>": <span class="hljs-value">{ "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"Point"</span></span>, "<span class="hljs-attribute">coordinates</span>": <span class="hljs-value">[ -<span class="hljs-number">122.458206</span>, <span class="hljs-number">37.783619</span> ] </span>} </span>},
{ "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"Feature"</span></span>, "<span class="hljs-attribute">properties</span>": <span class="hljs-value">{ "<span class="hljs-attribute">address</span>": <span class="hljs-value"><span class="hljs-string">"1111 California St, San Francisco, CA, 94108"</span></span>, "<span class="hljs-attribute">bing_type</span>": <span class="hljs-value"><span class="hljs-string">"Address"</span></span>, "<span class="hljs-attribute">bing_confidence</span>": <span class="hljs-value"><span class="hljs-string">"High"</span></span>, "<span class="hljs-attribute">bing_latitude</span>": <span class="hljs-value"><span class="hljs-number">37.791183</span></span>, "<span class="hljs-attribute">bing_longitude</span>": <span class="hljs-value">-<span class="hljs-number">122.412956</span> </span>}</span>, "<span class="hljs-attribute">geometry</span>": <span class="hljs-value">{ "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"Point"</span></span>, "<span class="hljs-attribute">coordinates</span>": <span class="hljs-value">[ -<span class="hljs-number">122.412956</span>, <span class="hljs-number">37.791183</span> ] </span>} </span>},
{ "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"Feature"</span></span>, "<span class="hljs-attribute">properties</span>": <span class="hljs-value">{ "<span class="hljs-attribute">address</span>": <span class="hljs-value"><span class="hljs-string">"1501 Larkin St, San Francisco, CA, 94109"</span></span>, "<span class="hljs-attribute">bing_type</span>": <span class="hljs-value"><span class="hljs-string">"Address"</span></span>, "<span class="hljs-attribute">bing_confidence</span>": <span class="hljs-value"><span class="hljs-string">"High"</span></span>, "<span class="hljs-attribute">bing_latitude</span>": <span class="hljs-value"><span class="hljs-number">37.791859</span></span>, "<span class="hljs-attribute">bing_longitude</span>": <span class="hljs-value">-<span class="hljs-number">122.419556</span> </span>}</span>, "<span class="hljs-attribute">geometry</span>": <span class="hljs-value">{ "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"Point"</span></span>, "<span class="hljs-attribute">coordinates</span>": <span class="hljs-value">[ -<span class="hljs-number">122.419556</span>, <span class="hljs-number">37.791859</span> ] </span>} </span>},
{ "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"Feature"</span></span>, "<span class="hljs-attribute">properties</span>": <span class="hljs-value">{ "<span class="hljs-attribute">address</span>": <span class="hljs-value"><span class="hljs-string">"4508 Balboa St, San Francisco, CA, 94121"</span></span>, "<span class="hljs-attribute">bing_type</span>": <span class="hljs-value"><span class="hljs-string">"Address"</span></span>, "<span class="hljs-attribute">bing_confidence</span>": <span class="hljs-value"><span class="hljs-string">"High"</span></span>, "<span class="hljs-attribute">bing_latitude</span>": <span class="hljs-value"><span class="hljs-number">37.775490</span></span>, "<span class="hljs-attribute">bing_longitude</span>": <span class="hljs-value">-<span class="hljs-number">122.507271</span> </span>}</span>, "<span class="hljs-attribute">geometry</span>": <span class="hljs-value">{ "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"Point"</span></span>, "<span class="hljs-attribute">coordinates</span>": <span class="hljs-value">[ -<span class="hljs-number">122.507271</span>, <span class="hljs-number">37.77549</span> ] </span>} </span>},
{ "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"Feature"</span></span>, "<span class="hljs-attribute">properties</span>": <span class="hljs-value">{ "<span class="hljs-attribute">address</span>": <span class="hljs-value"><span class="hljs-string">"101 Turk St, San Francisco, CA, 94102"</span></span>, "<span class="hljs-attribute">bing_type</span>": <span class="hljs-value"><span class="hljs-string">"Address"</span></span>, "<span class="hljs-attribute">bing_confidence</span>": <span class="hljs-value"><span class="hljs-string">"High"</span></span>, "<span class="hljs-attribute">bing_latitude</span>": <span class="hljs-value"><span class="hljs-number">37.782890</span></span>, "<span class="hljs-attribute">bing_longitude</span>": <span class="hljs-value">-<span class="hljs-number">122.411064</span> </span>}</span>, "<span class="hljs-attribute">geometry</span>": <span class="hljs-value">{ "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"Point"</span></span>, "<span class="hljs-attribute">coordinates</span>": <span class="hljs-value">[ -<span class="hljs-number">122.411064</span>, <span class="hljs-number">37.78289</span> ] </span>} </span>}
]
</span>}
</code></pre><p>See the <a href="https://tools.ietf.org/html/rfc7946">full GeoJSON specification</a> for more details.</p><p><a href="https://github.com/mbostock/topojson/wiki">TopoJSON</a> is an extension of GeoJSON which is more compact, because polygons are described by line segments, rather than their entire boundaries. This means that the boundary between California and Nevada, for instance, is represented only once, rather than twice — once for each state. This keeps file sizes small, which can be advantageous when data must be loaded and rendered in a web browser.</p><h4 id="shapefile"><a name="shapefile" href="#shapefile"></a>Shapefile</h4><p>This is a geodata format developed by <a href="https://www.esri.com/">ESRI</a>, manufacturer of ArcGIS, the leading commercial Geographic Information System (GIS) application. Shapefiles can represent elements including points, lines and polygons, and can also include information on map projection and datums.</p><p>Shapefiles are usually made available for download as zipped folders, and actually consist of a series of files. At a minimum, a shapefile must contain three component files, with the same root name and the following extensions:</p><ul>
<li><code>.shp</code> The main file containing the geometry of the points, lines or polygons mapped in the shapefile.</li><li><code>.dbf</code> A database file in dBASE format containing a table of data relating to the components of the geometry. For example, in a world shapefile giving national boundaries, this table might contain data about the countries including their names, capital cities, population, annual GDP, and so on.</li><li><code>.shx</code> A positional index of the shapefile’s geometry.</li></ul><p>There are several optional file types that may also be included, including a <code>.prj</code> file, which defines the map projection and datum to be used when loading the shapefile into GIS software. Refer to <a href="https://www.esri.com/library/whitepapers/pdfs/shapefile.pdf">ESRI’s technical specification</a> and the <a href="https://en.wikipedia.org/wiki/Shapefile">informative Wikipedia entry</a> for more details.</p><p>Many government agencies, such as the <a href="https://www.census.gov/geo/maps-data/data/tiger-line.html">U.S. Census Bureau</a>, provide data for mapping as shapefiles. You can also download shapefiles from repositories such as <a href="http://www.naturalearthdata.com/downloads/">Natural Earth</a>.</p><h3 id="converting-between-vector-geodata-formats"><a name="converting-between-vector-geodata-formats" href="#converting-between-vector-geodata-formats"></a>Converting between vector geodata formats</h3><p>We will later learn how to use <a href="https://qgis.org/en/site/">QGIS</a> to convert between the main geodata formats. In addition, <a href="https://mapshaper.org/">Mapshaper</a> which is designed to simplify the geometry of geodata, will import and export data as Shapefile, GeoJSON, and TopoJSON, and so can also be used for data conversion.</p><h3 id="mapping-images:-raster-geodata"><a name="mapping-images:-raster-geodata" href="#mapping-images:-raster-geodata"></a>Mapping images: raster geodata</h3><p>Satellite and aerial images can also be placed into maps, which requires the images to be georeferenced, or have location imformation associated with them. Formats for raster geodata include <a href="https://trac.osgeo.org/geotiff/">GeoTIFF</a>. If you need to make maps with raster geodata for your final projects, contact me for help!</p><h3 id="assignment"><a name="assignment" href="#assignment"></a>Assignment</h3><ul>
<li><p>File an update on progress with your final project. Pay particular attention to identifying problems/obstacles.</p>
</li><li><p>File the update as a markdown file in GitHub. Make sure that your GitHub repo is up to date with data, charts etc, so that I can sync with my version of your project and review your progress. The update should be sufficiently detailed that I can look at your repo and understand what you are doing.</p>
</li><li><p>If you are having trouble with GitHub, get in contact for a refresher.</p>
</li></ul><h3 id="further-reading"><a name="further-reading" href="#further-reading"></a>Further reading</h3><p>Mark Monmonier: <em><a href="https://www.amazon.com/How-Lie-Maps-2nd-Edition/dp/0226534219">How to Lie With Maps</a></em><br>This popular exploration of how all maps distort reality, and how some can  seriously deceive, provides a good overview of cartographic principles.</p><p>Antim Harasymiv: <em><a href="https://medium.com/google-design/google-maps-cb0326d165f5">Prototyping a Smoother Map</a></em><br>A good overview of the principles and challenges in designing and implementing Google Maps.</p>

<footer style="position:fixed; font-size:.8em; text-align:right; bottom:0px; margin-left:-25px; height:20px; width:100%;">generated by <a href="http://pad.haroopress.com" target="_blank">haroopad</a></footer>
</body>
</html>
