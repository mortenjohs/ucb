names(food_stamps) <- c("year","participants","costs")
food_stamps <- food_stamps %>%
filter(!is.na(participants)) %>%
mutate(participants = participants * 1000,
year = as.integer(year))
# charts
ggplot(food_stamps, aes(x=year, y=participants/1000000)) +
geom_bar(stat = "identity", fill = "red", color = "white") +
xlab("") +
ylab("Participants (millions)") +
# scale_x_continuous(breaks = c(1970,1980,1990,2000,2010)) +
scale_y_continuous(limits = c(0,50)) +
theme_minimal(base_size = 14, base_family = "Georgia") +
ggtitle("Column chart")
ggplot(food_stamps, aes(x=year, y=participants/1000000)) +
geom_line(color = "red", size=1) +
xlab("") +
ylab("Participants (millions)") +
# scale_x_continuous(breaks = c(1970,1980,1990,2000,2010)) +
scale_y_continuous(limits = c(0,50)) +
theme_minimal(base_size = 14, base_family = "Georgia") +
ggtitle("Line chart")
ggplot(food_stamps, aes(x=year, y=participants/1000000)) +
geom_point(color = "red") +
geom_line(color = "red") +
xlab("") +
ylab("Participants (millions)") +
# scale_x_continuous(breaks = c(1970,1980,1990,2000,2010)) +
scale_y_continuous(limits = c(0,50)) +
theme_minimal(base_size = 14, base_family = "Georgia") +
theme_minimal(base_size = 14, base_family = "Georgia") +
ggtitle("Dot and line chart")
ggplot(food_stamps, aes(x=year, y=participants/1000000)) +
geom_point(color = "red") +
geom_linerange(color = "red", aes(ymin=0, ymax=participants/1000000)) +
xlab("") +
ylab("Participants (millions)") +
# scale_x_continuous(breaks = c(1970,1980,1990,2000,2010)) +
scale_y_continuous(limits = c(0,50)) +
theme_minimal(base_size = 14, base_family = "Georgia") +
theme_minimal(base_size = 14, base_family = "Georgia") +
ggtitle("Dot and column chart")
write_csv(food_stamps,"food_stamps.csv",na="")
# CA immunization
# function to convert any text string into proper case
toproper <- function(x) {
sapply(x, function(strn)
{ s <- strsplit(strn, "\\s")[[1]]
paste0(toupper(substring(s, 1,1)),
tolower(substring(s, 2)),
collapse=" ")}, USE.NAMES=FALSE)
}
# import CA kindergarten immunization data and calculate incomplete rate by county
immun <- read_tsv("kindergarten.tsv") %>%
mutate(county=toproper(county),
district=toproper(district),
school=toproper(school),
pub_priv=toproper(pub_priv),
incomplete_pc=100-complete_pc,
sch_code=as.character(sch_code),
prejan_pbe=as.integer(prejan_pbe),
prejan_pbe_pc=as.numeric(prejan_pbe_pc),
doc_couns_pbe=as.integer(doc_couns_pbe),
doc_couns_pbe_pc=as.numeric(doc_couns_pbe_pc),
relig_pbe=as.integer(relig_pbe),
relig_pbe_pc=as.numeric(relig_pbe_pc))
immun_2015 <- read_csv("kindergarten2015.csv") %>%
mutate(county=toproper(county),
district=toproper(district),
school=toproper(school),
pub_priv=toproper(pub_priv),
incomplete_pc=100-complete_pc,
year="2015-16",
start_year=2015)
immun <- bind_rows(immun,immun_2015)
write_csv(immun, "kindergarten.csv")
# identify counties with the largest enrollment
immun_counties <- immun %>%
group_by(county) %>%
summarize(enrolled=sum(enrollment, na.rm=TRUE)) %>%
arrange(desc(enrolled))
top5 <- head(immun_counties,5) %>%
select(county)
# percent incomplete, entire state, by year
immun_year <- immun %>%
group_by(start_year) %>%
summarize(enrolled=sum(enrollment, na.rm=TRUE),complete=sum(complete, na.rm=TRUE)) %>%
mutate(pc_incomplete=round(((enrolled-complete)/enrolled),4))
# percent incomplete, by county, by year
immun_counties_year <- immun %>%
group_by(county,start_year) %>%
summarize(enrolled=sum(enrollment, na.rm=TRUE),complete=sum(complete, na.rm=TRUE)) %>%
mutate(pc_incomplete=round(((enrolled-complete)/enrolled),4))
# percent incomplete, top 5 counties by enrollment, by year
immun_top5_year <- inner_join(immun_counties_year,top5)
# bar chart by year, entire state
ggplot(immun_year, aes(x=start_year, y=pc_incomplete)) +
geom_bar(stat="identity", fill="red", alpha=0.7) +
theme_minimal(base_size = 14, base_family = "Georgia") +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks = c(2002,2004,2006,2008,2010,2012,2014)) +
xlab("") +
ylab("Incomplete") +
ggtitle("Immunization in California kindergartens",subtitle="Percent of children without complete shots, entire state")
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank())
# dot and line chart by year
ggplot(immun_year, aes(x=start_year, y=pc_incomplete)) +
geom_line(size=1, color="red") +
geom_point(size=3, color="red") +
theme_minimal(base_size = 14, base_family = "Georgia") +
scale_y_continuous(labels = scales::percent, limits=c(0,0.1)) +
scale_x_continuous(breaks = c(2002,2004,2006,2008,2010,2012,2014)) +
xlab("") +
ylab("Incomplete") +
ggtitle("Immunization in California kindergartens",subtitle="Percent of children without complete shots, entire state")
# line chart by year
ggplot(immun_year, aes(x=start_year, y=pc_incomplete)) +
geom_line(size=1.5, color="red") +
theme_minimal(base_size = 14, base_family = "Georgia") +
scale_y_continuous(labels = scales::percent, limits=c(0.06,0.1)) +
scale_x_continuous(breaks = c(2002,2004,2006,2008,2010,2012,2014)) +
xlab("") +
ylab("Incomplete") +
ggtitle("Immunization in California kindergartens",subtitle="Percent of children without complete shots, entire state")
# dot and line chart, top5 counties, by year
ggplot(immun_top5_year, aes(x=start_year, y=pc_incomplete, color=county)) +
scale_color_brewer(palette = "Set1", name = "") +
geom_line(size=1) +
geom_point(size=3) +
theme_minimal(base_size = 14, base_family = "Georgia") +
scale_y_continuous(labels = scales::percent, limits = c(0,0.15)) +
scale_x_continuous(breaks = c(2002,2004,2006,2008,2010,2012,2014)) +
xlab("") +
ylab("Incomplete") +
theme(legend.position="bottom") +
ggtitle("Immunization in California kindergartens",subtitle="Percent of children without complete shots, five largest counties")
# dot and line chart, all counties, by year
ggplot(immun_counties_year, aes(x=start_year, y=pc_incomplete, color=county)) +
geom_line(size=1) +
geom_point(size=3) +
theme_minimal(base_size = 14, base_family = "Georgia") +
theme(legend.position="none") +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks = c(2002,2004,2006,2008,2010,2012,2014)) +
xlab("") +
ylab("Incomplete") +
ggtitle("Immunization in California kindergartens",subtitle="Percent of children without complete shots, by county")
# heat map, all counties, by year
ggplot(immun_counties_year, aes(x=start_year, y=county)) +
geom_tile(aes(fill = pc_incomplete), colour = "white") +
scale_fill_gradient(low = "white",
high = "red", name="",
labels = scales::percent) +
scale_x_continuous(breaks = c(2002,2004,2006,2008,2010,2012,2014)) +
theme_minimal(base_size = 14, base_family = "Georgia") +
xlab("") +
ylab("County") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position="bottom",
legend.key.height = unit(0.4, "cm"),
text=element_text(size=14)) +
ggtitle("Immunization in California kindergartens",subtitle="Percent of children without complete shots, by county")
# show all schools, by year
ggplot(immun, aes(x=start_year, y=incomplete_pc/100)) +
geom_point(position="jitter",
color="red",
alpha=0.1,
aes(size=enrollment)) +
scale_color_gradient(low = "white", high = "red") +
scale_x_continuous(breaks = c(2002,2004,2006,2008,2010,2012,2014)) +
scale_y_continuous(labels = scales::percent) +
theme_minimal(base_size = 14, base_family = "Georgia") +
xlab("") +
ylab("Incomplete") +
guides(size=guide_legend(title="Enrollment")) +
ggtitle("Immunization in California kindergartens",subtitle="Percent of children without complete shots, by school")
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
legend.position="bottom")
# gender pay gap
# load data (scraped in Google Sheets from https://www.bls.gov/cps/cpsaat39.htm, with =importhtml("https://www.bls.gov/cps/cpsaat39.htm", "table", 2
)
gender_pay <- read_csv("gender_pay.csv")
gender_pay_chart <- ggplot(gender_pay, aes(x=men_median_pay, y=women_median_pay)) +
geom_point(size=4,alpha=0.5, color="gray57") +
coord_fixed(ratio = 1, xlim = c(0,3000), ylim = c(0,3000)) +
xlab("Men") +
ylab("Women") +
scale_y_continuous(labels = dollar) +
scale_x_continuous(labels = dollar) +
theme_minimal(base_size = 14, base_family = "Georgia") +
ggtitle("Median weekly earnings, by job type (2017)")
gender_pay_chart_edited <- gender_pay_chart +
geom_abline(intercept = 0, slope = 1, size=0.2) +
geom_abline(intercept = 0, slope = 0.75, linetype = 3)
ggplotly(gender_pay_chart_edited)
ggsave(file="test.svg", plot=gender_pay_chart_edited, width=7.5, height=7.5)
setwd("~/Dropbox/ucb/2018/dataviz/raw-data/week2")
# load required packages
library(dplyr)
library(readr)
library(ggplot2)
library(scales)
library(readxl)
library(plotly)
# food stamps
# import food stamps data
food_stamps <- read_excel("SNAPsummary.xls", sheet=1, skip=5)
names(food_stamps) <- c(1:6)
food_stamps <- food_stamps %>%
select(1,2,6)
names(food_stamps) <- c("year","participants","costs")
food_stamps <- food_stamps %>%
filter(!is.na(participants)) %>%
mutate(participants = participants * 1000,
year = as.integer(year))
# charts
ggplot(food_stamps, aes(x=year, y=participants/1000000)) +
geom_bar(stat = "identity", fill = "red", color = "white") +
xlab("") +
ylab("Participants (millions)") +
# scale_x_continuous(breaks = c(1970,1980,1990,2000,2010)) +
scale_y_continuous(limits = c(0,50)) +
theme_minimal(base_size = 14, base_family = "Georgia") +
ggtitle("Column chart")
ggplot(food_stamps, aes(x=year, y=participants/1000000)) +
geom_line(color = "red", size=1) +
xlab("") +
ylab("Participants (millions)") +
# scale_x_continuous(breaks = c(1970,1980,1990,2000,2010)) +
scale_y_continuous(limits = c(0,50)) +
theme_minimal(base_size = 14, base_family = "Georgia") +
ggtitle("Line chart")
ggplot(food_stamps, aes(x=year, y=participants/1000000)) +
geom_point(color = "red") +
geom_line(color = "red") +
xlab("") +
ylab("Participants (millions)") +
# scale_x_continuous(breaks = c(1970,1980,1990,2000,2010)) +
scale_y_continuous(limits = c(0,50)) +
theme_minimal(base_size = 14, base_family = "Georgia") +
theme_minimal(base_size = 14, base_family = "Georgia") +
ggtitle("Dot and line chart")
ggplot(food_stamps, aes(x=year, y=participants/1000000)) +
geom_point(color = "red") +
geom_linerange(color = "red", aes(ymin=0, ymax=participants/1000000)) +
xlab("") +
ylab("Participants (millions)") +
# scale_x_continuous(breaks = c(1970,1980,1990,2000,2010)) +
scale_y_continuous(limits = c(0,50)) +
theme_minimal(base_size = 14, base_family = "Georgia") +
theme_minimal(base_size = 14, base_family = "Georgia") +
ggtitle("Dot and column chart")
write_csv(food_stamps,"food_stamps.csv",na="")
# CA immunization
# function to convert any text string into proper case
toproper <- function(x) {
sapply(x, function(strn)
{ s <- strsplit(strn, "\\s")[[1]]
paste0(toupper(substring(s, 1,1)),
tolower(substring(s, 2)),
collapse=" ")}, USE.NAMES=FALSE)
}
# import CA kindergarten immunization data and calculate incomplete rate by county
immun <- read_tsv("kindergarten.tsv") %>%
mutate(county=toproper(county),
district=toproper(district),
school=toproper(school),
pub_priv=toproper(pub_priv),
incomplete_pc=100-complete_pc,
sch_code=as.character(sch_code),
prejan_pbe=as.integer(prejan_pbe),
prejan_pbe_pc=as.numeric(prejan_pbe_pc),
doc_couns_pbe=as.integer(doc_couns_pbe),
doc_couns_pbe_pc=as.numeric(doc_couns_pbe_pc),
relig_pbe=as.integer(relig_pbe),
relig_pbe_pc=as.numeric(relig_pbe_pc))
immun_2015 <- read_csv("kindergarten2015.csv") %>%
mutate(county=toproper(county),
district=toproper(district),
school=toproper(school),
pub_priv=toproper(pub_priv),
incomplete_pc=100-complete_pc,
year="2015-16",
start_year=2015)
immun <- bind_rows(immun,immun_2015)
write_csv(immun, "kindergarten.csv")
# identify counties with the largest enrollment
immun_counties <- immun %>%
group_by(county) %>%
summarize(enrolled=sum(enrollment, na.rm=TRUE)) %>%
arrange(desc(enrolled))
top5 <- head(immun_counties,5) %>%
select(county)
# percent incomplete, entire state, by year
immun_year <- immun %>%
group_by(start_year) %>%
summarize(enrolled=sum(enrollment, na.rm=TRUE),complete=sum(complete, na.rm=TRUE)) %>%
mutate(pc_incomplete=round(((enrolled-complete)/enrolled),4))
# percent incomplete, by county, by year
immun_counties_year <- immun %>%
group_by(county,start_year) %>%
summarize(enrolled=sum(enrollment, na.rm=TRUE),complete=sum(complete, na.rm=TRUE)) %>%
mutate(pc_incomplete=round(((enrolled-complete)/enrolled),4))
# percent incomplete, top 5 counties by enrollment, by year
immun_top5_year <- inner_join(immun_counties_year,top5)
# bar chart by year, entire state
ggplot(immun_year, aes(x=start_year, y=pc_incomplete)) +
geom_bar(stat="identity", fill="red", alpha=0.7) +
theme_minimal(base_size = 14, base_family = "Georgia") +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks = c(2002,2004,2006,2008,2010,2012,2014)) +
xlab("") +
ylab("Incomplete") +
ggtitle("Immunization in California kindergartens",subtitle="Percent of children without complete shots, entire state")
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank())
# dot and line chart by year
ggplot(immun_year, aes(x=start_year, y=pc_incomplete)) +
geom_line(size=1, color="red") +
geom_point(size=3, color="red") +
theme_minimal(base_size = 14, base_family = "Georgia") +
scale_y_continuous(labels = scales::percent, limits=c(0,0.1)) +
scale_x_continuous(breaks = c(2002,2004,2006,2008,2010,2012,2014)) +
xlab("") +
ylab("Incomplete") +
ggtitle("Immunization in California kindergartens",subtitle="Percent of children without complete shots, entire state")
# line chart by year
ggplot(immun_year, aes(x=start_year, y=pc_incomplete)) +
geom_line(size=1.5, color="red") +
theme_minimal(base_size = 14, base_family = "Georgia") +
scale_y_continuous(labels = scales::percent, limits=c(0.06,0.1)) +
scale_x_continuous(breaks = c(2002,2004,2006,2008,2010,2012,2014)) +
xlab("") +
ylab("Incomplete") +
ggtitle("Immunization in California kindergartens",subtitle="Percent of children without complete shots, entire state")
# dot and line chart, top5 counties, by year
ggplot(immun_top5_year, aes(x=start_year, y=pc_incomplete, color=county)) +
scale_color_brewer(palette = "Set1", name = "") +
geom_line(size=1) +
geom_point(size=3) +
theme_minimal(base_size = 14, base_family = "Georgia") +
scale_y_continuous(labels = scales::percent, limits = c(0,0.15)) +
scale_x_continuous(breaks = c(2002,2004,2006,2008,2010,2012,2014)) +
xlab("") +
ylab("Incomplete") +
theme(legend.position="bottom") +
ggtitle("Immunization in California kindergartens",subtitle="Percent of children without complete shots, five largest counties")
# dot and line chart, all counties, by year
ggplot(immun_counties_year, aes(x=start_year, y=pc_incomplete, color=county)) +
geom_line(size=1) +
geom_point(size=3) +
theme_minimal(base_size = 14, base_family = "Georgia") +
theme(legend.position="none") +
scale_y_continuous(labels = scales::percent) +
scale_x_continuous(breaks = c(2002,2004,2006,2008,2010,2012,2014)) +
xlab("") +
ylab("Incomplete") +
ggtitle("Immunization in California kindergartens",subtitle="Percent of children without complete shots, by county")
# heat map, all counties, by year
ggplot(immun_counties_year, aes(x=start_year, y=county)) +
geom_tile(aes(fill = pc_incomplete), colour = "white") +
scale_fill_gradient(low = "white",
high = "red", name="",
labels = scales::percent) +
scale_x_continuous(breaks = c(2002,2004,2006,2008,2010,2012,2014)) +
theme_minimal(base_size = 14, base_family = "Georgia") +
xlab("") +
ylab("County") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position="bottom",
legend.key.height = unit(0.4, "cm"),
text=element_text(size=14)) +
ggtitle("Immunization in California kindergartens",subtitle="Percent of children without complete shots, by county")
# show all schools, by year
ggplot(immun, aes(x=start_year, y=incomplete_pc/100)) +
geom_point(position="jitter",
color="red",
alpha=0.1,
aes(size=enrollment)) +
scale_color_gradient(low = "white", high = "red") +
scale_x_continuous(breaks = c(2002,2004,2006,2008,2010,2012,2014)) +
scale_y_continuous(labels = scales::percent) +
theme_minimal(base_size = 14, base_family = "Georgia") +
xlab("") +
ylab("Incomplete") +
guides(size=guide_legend(title="Enrollment")) +
ggtitle("Immunization in California kindergartens",subtitle="Percent of children without complete shots, by school")
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
legend.position="bottom")
# gender pay gap
# load data (scraped in Google Sheets from https://www.bls.gov/cps/cpsaat39.htm, with =importhtml("https://www.bls.gov/cps/cpsaat39.htm", "table", 2
)
gender_pay <- read_csv("gender_pay.csv")
gender_pay_chart <- ggplot(gender_pay, aes(x=men_median_pay, y=women_median_pay)) +
geom_point(size=4,alpha=0.5, color="gray57") +
coord_fixed(ratio = 1, xlim = c(0,3000), ylim = c(0,3000)) +
xlab("Men") +
ylab("Women") +
scale_y_continuous(labels = dollar) +
scale_x_continuous(labels = dollar) +
theme_minimal(base_size = 14, base_family = "Georgia") +
ggtitle("Median weekly earnings, by job type (2017)")
gender_pay_chart_edited <- gender_pay_chart +
geom_abline(intercept = 0, slope = 1, size=0.2) +
geom_abline(intercept = 0, slope = 0.75, linetype = 3)
ggplotly(gender_pay_chart_edited)
ggsave(file="test.svg", plot=gender_pay_chart_edited, width=7.5, height=7.5)
# load data
immun <- read_csv("kindergarten.csv")
immun <- read_csv("kindergarten.csv")
# write.csv(immun, "kindergarten.csv", na="", row.names=F)
# create new column with numbers of children with incomplete immunizations
immun <- immun %>%
mutate(incomplete = enrollment - complete)
# percentage incomplete, entire state, by year
immun_year <- immun %>%
group_by(start_year) %>%
summarize(enrolled = sum(enrollment, na.rm=TRUE),
completed = sum(complete, na.rm=TRUE)) %>%
mutate(pc_incomplete = round(((enrolled-completed)/enrolled*100),2))
# percentage incomplete, by county, by year
immun_counties_year <- immun %>%
group_by(county,start_year) %>%
summarize(enrolled = sum(enrollment, na.rm = TRUE),
completed = sum(complete, na.rm = TRUE)) %>%
mutate(pc_incomplete = round(((enrolled-completed)/enrolled*100),2))
# identify the five counties with the largest enrollment over all years
top5 <- immun %>%
group_by(county) %>%
summarize(enrollment = sum(enrollment, na.rm = TRUE)) %>%
arrange(desc(enrollment)) %>%
head(5) %>%
select(county)
# pc incomplete, top 5 counties for enrollment, by year
immun_top5_year <- semi_join(immun_counties_year, top5)
# bar chart by year, entire state
ggplot(immun_top5_year, aes(x = start_year, y = proport_incomplete, color = county)) +
scale_color_brewer(palette = "Set1", name = "") +
geom_line(size=1) +
geom_point(size=3) +
theme_minimal(base_size = 12, base_family = "Georgia") +
scale_y_continuous(labels = percent, limits = c(0,0.15)) +
scale_x_continuous(breaks = c(2002,2004,2006,2008,2010,2012,2014)) +
xlab("") +
ylab("Incomplete") +
theme(legend.position = "bottom") +
ggtitle("Immunization in California kindergartens\n(five largest counties)")
ggplot(immun_top5_year, aes(x = start_year, y = pc_incomplete, color = county)) +
scale_color_brewer(palette = "Set1", name = "") +
geom_line(size=1) +
geom_point(size=3) +
theme_minimal(base_size = 12, base_family = "Georgia") +
# scale_y_continuous(labels = percent, limits = c(0,0.15)) +
scale_x_continuous(breaks = c(2002,2004,2006,2008,2010,2012,2014)) +
xlab("") +
ylab("Incomplete") +
theme(legend.position = "bottom") +
ggtitle("Immunization in California kindergartens\n(five largest counties)")
ggplot(immun_top5_year, aes(x = start_year, y = pc_incomplete, color = county)) +
scale_color_brewer(palette = "Set1", name = "") +
geom_line(size=1) +
geom_point(size=3) +
theme_minimal(base_size = 12, base_family = "Georgia") +
scale_y_continuous(limits = c(0,15)) +
scale_x_continuous(breaks = c(2002,2004,2006,2008,2010,2012,2014)) +
xlab("") +
ylab("Incomplete") +
theme(legend.position = "bottom") +
ggtitle("Immunization in California kindergartens\n(five largest counties)")
ggplot(immun_year, aes(x=start_year, y=pc_incomplete)) +
geom_bar(stat="identity", fill="red", alpha=0.7) +
theme_minimal(base_size = 14, base_family = "Georgia") +
scale_x_continuous(breaks = c(2002,2004,2006,2008,2010,2012,2014)) +
xlab("") +
ylab("Incomplete") +
ggtitle("Immunization in California kindergartens",subtitle="Percent of children without complete shots, entire state")
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank())
ggplot(immun_year, aes(x=start_year, y=pc_incomplete)) +
geom_bar(stat="identity", fill="red", alpha=0.7) +
theme_minimal(base_size = 14, base_family = "Georgia") +
scale_x_continuous(breaks = c(2002,2004,2006,2008,2010,2012,2014)) +
xlab("") +
ylab("Incomplete") +
ggtitle("Immunization in California kindergartens",subtitle="Percent of children without complete shots, entire state") +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank())
ggplot(immun_top5_year, aes(x = start_year, y = pc_incomplete, color = county)) +
scale_color_brewer(palette = "Set1", name = "") +
geom_line(size=1) +
geom_point(size=3) +
theme_minimal(base_size = 12, base_family = "Georgia") +
scale_y_continuous(limits = c(0,15)) +
scale_x_continuous(breaks = c(2002,2004,2006,2008,2010,2012,2014)) +
xlab("") +
ylab("% incomplete") +
theme(legend.position = "bottom") +
ggtitle("Immunization in California kindergartens\n(five largest counties)")
ggplot(immun_year, aes(x=start_year, y=pc_incomplete)) +
geom_bar(stat="identity", fill="red", alpha=0.7) +
theme_minimal(base_size = 14, base_family = "Georgia") +
scale_x_continuous(breaks = c(2002,2004,2006,2008,2010,2012,2014)) +
xlab("") +
ylab("% incomplete") +
ggtitle("Immunization in California kindergartens",subtitle="Percent of children without complete shots, entire state") +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank())
